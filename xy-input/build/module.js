/* form-elements 
   0.0.4
   By Stephen Band
   Built 2023-03-27 06:04 */

var qe=Object.getOwnPropertySymbols;var Or=Object.prototype.hasOwnProperty,Lr=Object.prototype.propertyIsEnumerable;var Xe=(t,e)=>{var r={};for(var o in t)Or.call(t,o)&&e.indexOf(o)<0&&(r[o]=t[o]);if(t!=null&&qe)for(var o of qe(t))e.indexOf(o)<0&&Lr.call(t,o)&&(r[o]=t[o]);return r};function b(t){return t}function v(t,e){return function(){let o=t.apply(this,arguments),i=e[o]||e.default;if(!i)throw new Error('overload() no handler for "'+o+'"');return i.apply(this,arguments)}}function nt(t){var e=new Map;return function(o){if(e.has(o))return e.get(o);var i=t(o);return e.set(o,i),i}}var Br=Array.prototype;function Cr(t,e){return typeof t=="function"?t.apply(null,e):t}function $e(t,e,r){r=r||t.length;var o=r===1?e?t:nt(t):nt(function(i){return $e(function(){var s=[i];return s.push.apply(s,arguments),t.apply(null,s)},e,r-1)});return function i(s){return arguments.length===0?i:arguments.length===1?o(s):arguments.length>=r?t.apply(null,arguments):Cr(o(s),Br.slice.call(arguments,1))}}var T=$e;function M(){}var Fr=v(b,{is:M,tag:M,data:function(t,e,r){Object.assign(e.dataset,r)},html:function(t,e,r){e.innerHTML=r},text:function(t,e,r){e.textContent=r},children:function(t,e,r){e.innerHTML="",e.append.apply(e,r)},points:J,cx:J,cy:J,r:J,transform:J,preserveAspectRatio:J,viewBox:J,default:function(t,e,r){t in e?e[t]=r:e.setAttribute(t,r)}});function J(t,e,r){e.setAttribute(t,r)}function Dr(t,e){for(var r=Object.keys(e),o=r.length;o--;)Fr(r[o],t,e[r[o]]);return t}var St=T(Dr,!0);var Zt="http://www.w3.org/2000/svg",Ke=document.createElement("template"),te=(t,e)=>e&&typeof e;function Je(t,e){let r=document.createRange();return r.selectNode(t),r.createContextualFragment(e)}var L=v(te,{string:function(t,e){let r=document.createElementNS(Zt,t);return r.innerHTML=e,r},object:function(t,e){let r=document.createElementNS(Zt,t);return typeof e.length=="number"?r.append.apply(r,e):St(r,e),r},default:t=>document.createElementNS(Zt,t)}),Vr=v(te,{string:function(t,e){let r=document.createElement(t);return r.innerHTML=e,r},object:function(t,e){let r=document.createElement(t);return typeof e.length=="number"?r.append.apply(r,e):St(r,e),r},default:t=>document.createElement(t)}),Ir=v(b,{comment:function(t,e){return document.createComment(e||"")},fragment:v(te,{string:function(t,e,r){return r?Je(r,e):(Ke.innerHTML=e,Ke.content.cloneNode(!0))},object:function(t,e,r){let o=r?Je(r):document.createDocumentFragment();return typeof e.length=="number"?o.append.apply(o,e):St(o,e),o},default:()=>document.createDocumentFragment()}),text:function(t,e){return document.createTextNode(e||"")},circle:L,ellipse:L,g:L,glyph:L,image:L,line:L,rect:L,use:L,path:L,pattern:L,polygon:L,polyline:L,svg:L,default:Vr}),F=Ir;function ee(t,e,r){let o;typeof r!="string"&&r.input!==void 0&&r.index!==void 0&&(o=r,r=o.input.slice(r.index+r[0].length+(r.consumed||0)));let i=t.exec(r);if(!i)return;let s=e(i);return o&&(o.consumed=(o.consumed||0)+i.index+i[0].length+(i.consumed||0)),s}var ne=T(ee,!0);function Hr(t,e,r){throw r.input!==void 0&&r.index!==void 0&&(r=r.input),new Error('Cannot parse string "'+(r.length>128?r.length.slice(0,128)+"…":r)+'"')}function jr(t,e,r){let o=-1;for(;++o<r.length;)e=r[o]!==void 0&&t[o]?t[o](e,r):e;return t.done?t.done(e,r):t.close?t.close(e,r):e}function Gr(t,e,r,o){let i=ee(t,s=>jr(e,r,s),o);return i===void 0?e.catch?e.catch(r,o):Hr(t,e,o):i}var Pt=T(Gr,!0);var B=Symbol("internals"),Q=Symbol("shadow"),Qe=Object.defineProperties,Rr={a:HTMLAnchorElement,article:HTMLElement,dl:HTMLDListElement,p:HTMLParagraphElement,br:HTMLBRElement,fieldset:HTMLFieldSetElement,hr:HTMLHRElement,img:HTMLImageElement,li:HTMLLIElement,ol:HTMLOListElement,optgroup:HTMLOptGroupElement,q:HTMLQuoteElement,section:HTMLElement,textarea:HTMLTextAreaElement,td:HTMLTableCellElement,th:HTMLTableCellElement,tr:HTMLTableRowElement,tbody:HTMLTableSectionElement,thead:HTMLTableSectionElement,tfoot:HTMLTableSectionElement,ul:HTMLUListElement},Wr={name:{set:function(t){return this.setAttribute("name",t)},get:function(){return this.getAttribute("name")||""}},form:{get:function(){return this[B].form}},labels:{get:function(){return this[B].labels}},validity:{get:function(){return this[B].validity}},validationMessage:{get:function(){return this[B].validationMessage}},willValidate:{get:function(){return this[B].willValidate}},checkValidity:{value:function(){return this[B].checkValidity()}},reportValidity:{value:function(){return this[B].reportValidity()}}},_r={},Ze={once:!0},tn=0,en=!1;function Ur(t){return Rr[t]||window["HTML"+t[0].toUpperCase()+t.slice(1)+"Element"]||(()=>{throw new Error('Constructor not found for tag "'+t+'"')})()}var zr=Pt(/^\s*<?([a-z][\w]*-[\w-]+)>?\s*$|^\s*<?([a-z][\w]*)\s+is[=\s]*["']?([a-z][\w]*-[\w]+)["']?>?\s*$/,{1:(t,e)=>({name:e[1]}),2:(t,e)=>({name:e[3],tag:e[2]}),catch:function(t,e){throw new SyntaxError(`dom element() – name must be of the form 'element-name' or 'tag is="element-name"' (`+e+")")}},null);function Nr(t,e){if(t.hasOwnProperty(e)){let r=t[e];delete t[e],t[e]=r}return t}function nn(t,e,r){t._initialLoad=!0;let o=t.attachShadow({mode:e.mode||"closed",delegatesFocus:e.focusable||!1});if(r){let i=F("link",{rel:"stylesheet",href:r});o.append(i)}return t[Q]=o,o}function Yr(t){var e;if(t.attachInternals){if(e=t.attachInternals(),e.setFormValue)return e}else e={shadowRoot:t.shadowRoot};return e.input=F("input",{type:"hidden",name:t.name}),t.appendChild(e.input),e.setFormValue=function(r){this.input.value=r},e}function qr(t){return!!t.attribute}function Xr(t){return t.set||t.get||t.hasOwnProperty("value")}function $r(t,e){return qr(e[1])&&(t.attributes[e[0]]=e[1].attribute),Xr(e[1])&&(t.properties[e[0]]=e[1]),t}function re(t,e,r,o,i=""){let{name:s,tag:a}=zr(t),l=typeof a=="string"?Ur(a):HTMLElement,{attributes:c,properties:f}=r?Object.entries(r).reduce($r,{attributes:{},properties:{}}):_r;function h(){let d=Reflect.construct(l,arguments,h),y=e.construct&&e.construct.length>tn?nn(d,e,o||e.stylesheet):void 0,u=h.formAssociated?Yr(d):{};return a&&(en=!0),e.construct&&e.construct.call(d,y,u),f&&Object.keys(f).reduce(Nr,d),d}return h.prototype=Object.create(l.prototype,f),f.value&&(h.formAssociated=!0,Qe(h.prototype,Wr),(e.enable||e.disable)&&(h.prototype.formDisabledCallback=function(d){return d?e.disable&&e.disable.call(this,this[Q],this[B]):e.enable&&e.enable.call(this,this[Q],this[B])}),e.reset&&(h.prototype.formResetCallback=function(){return e.reset.call(this,this[Q],this[B])}),e.restore&&(h.prototype.formStateRestoreCallback=function(){return e.restore.call(this,this[Q],this[B])})),c&&(h.observedAttributes=Object.keys(c),h.prototype.attributeChangedCallback=function(d,y,u){return c[d].call(this,u)}),h.prototype.connectedCallback=function(){let d=this,y=d[Q],u=d[B];if(d._initialLoad){let m=y.querySelectorAll('link[rel="stylesheet"]');if(m.length){let w=0,V=m.length,I=function(Kt){++w>=m.length&&(delete d._initialLoad,e.load&&e.load.call(d,y))},ut=I;for(;V--;)m[V].addEventListener("load",I,Ze),m[V].addEventListener("error",ut,Ze)}else e.load&&Promise.resolve(1).then(()=>e.load.call(this,y,u))}e.connect&&e.connect.call(this,y,u)},e.disconnect&&(h.prototype.disconnectedCallback=function(){return e.disconnect.call(this,this[Q],this[B])}),window.console&&window.console.log("%c<"+(a?a+" is="+s:s)+">%c "+i,"color: #3a8ab0; font-weight: 600;","color: #888888; font-weight: 400;"),window.customElements.define(s,h,a&&{extends:a}),a&&!en&&document.querySelectorAll('[is="'+s+'"]').forEach(d=>{f&&Qe(d,f);let y=e.construct&&e.construct.length>tn?nn(d,e,o||e.stylesheet):void 0;e.construct&&e.construct.call(d,y);let u;for(u in c){let m=d.attributes[u];m&&c[u].call(d,m.value)}e.connect&&e.connect.apply(d)}),h}var oe=Symbol("privates");function k(t){return t[oe]||Object.defineProperty(t,oe,{value:{}})[oe]}function at(t,e,r){return r>e?e:r<t?t:r}var ls=T(at);function ie(t){return function(){return arguments[t]}}function C(){return this}var Kr=Object.create,Jr=Object.freeze;function Qr(){return!0}function rn(){return-1}var z=Jr(Kr({shift:M,push:M,forEach:M,join:function(){return""},every:Qr,filter:C,find:M,findIndex:rn,flat:C,flatMap:C,includes:function(){return!1},indexOf:rn,map:C,reduce:ie(1),sort:C,each:C,pipe:b,start:C,stop:C,done:C,valueOf:function(){return null}},{length:{value:0}}));function ct(t,e){t.remove&&t.remove(e);let r;for(;(r=t.indexOf(e))!==-1;)t.splice(r,1);return t}var Ts=T(ct,!0);function se(t){return t&&t[Symbol.iterator]}var Zr=Object.assign;function to(t){return t.stop?t.stop():t()}function lt(){}Zr(lt.prototype,{stop:function(){let t=this.stopables;return this.stopables=void 0,t&&t.forEach(to),this},done:function(t){return(this.stopables||(this.stopables=[])).push(t),this}});var G=Object.assign,N=Object.create;function pt(t,e){t[0]=e,e.done(t)}function on(t,e){let r=t[e].stopables;r&&ct(r,t),t[e]=void 0}function x(t,e){t&&t.push(e)}function S(t){lt.prototype.stop.apply(t);let e=-1,r;for(;r=t[++e];)t[e]=void 0,r.stop()}function sn(t){return p.prototype.isPrototypeOf(t)}function p(t){this.input=t}G(p.prototype,lt.prototype,{push:function(t){x(this[0],t)},pipe:function(t){if(this[0])throw new Error("Stream: Attempt to .pipe() a unicast stream multiple times. Create a multicast stream with .broadcast().");return this[0]=t,t.done(this),this.input.pipe(this),t},map:function(t){return new un(this,t)},filter:function(t){return new an(this,t)},split:function(t){return new ln(this,t)},flatMap:function(t){return new cn(this,t)},slice:function(t,e){return new ue(this,t,e)},take:function(t){return console.warn(".take(a) superseded by .slice(0, a)"),new ue(this,0,t)},each:function(t){return this.pipe(new hn(t))},reduce:function(t,e){return this.pipe(new pn(t,e)).value},scan:function(t,e){return new fn(this,t,e)},stop:function(){return S(this),this}});function un(t,e){this.input=t,this.fn=e}un.prototype=G(N(p.prototype),{push:function(e){let o=this.fn(e);o!==void 0&&x(this[0],o)}});function an(t,e){this.input=t,this.fn=e}an.prototype=G(N(p.prototype),{push:function(e){this.fn(e)&&x(this[0],e)}});function cn(t,e){this.input=t,this.fn=e}cn.prototype=G(N(p.prototype),{push:function(e){let o=this.fn(e);if(o!==void 0)if(se(o))for(let i of o)x(this[0],i);else o.pipe&&this.done(o.each(i=>x(this[0],i)))}});function ln(t,e){this.input=t,this.chunk=[],typeof n=="number"?this.n=e:this.fn=e}ln.prototype=G(N(p.prototype),{fn:function(){return this.chunk.length===this.n},push:function(e){let r=this.chunk;this.fn(e)?(x(this[0],r),this.chunk=[]):r.push(e)}});function ue(t,e,r=1/0){this.input=t,this.index=-e,this.indexEnd=e+r}ue.prototype=G(N(p.prototype),{push:function(e){++this.index>0&&this[0].push(e),this.index===this.indexEnd&&this.stop()}});function pn(t,e){this.fn=t,this.value=e,this.i=0}pn.prototype=G(N(p.prototype),{push:function(t){let e=this.fn;this.value=e(this.value,t,this.i++,this)}});function fn(t,e,r){this.input=t,this.fn=e,this.value=r}fn.prototype=G(N(p.prototype),{push:function(t){let e=this.fn;this.value=e(this.value,t),this[0].push(this.value)}});function hn(t){this.push=t}hn.prototype=G(N(p.prototype),{each:null,reduce:null,pipe:null});var eo=Object.assign,no=Object.create;function ro(t,e){if(t[1]){let r=-1;for(;t[++r]&&t[r]!==e;);for(;t[r++];)t[r-1]=t[r]}else t.stop()}function ft(t,e){p.apply(this,arguments),this.memory=!!(e&&e.memory),e&&e.hot&&this.pipe(z)}ft.prototype=eo(no(p.prototype),{push:function(t){if(t===void 0)return;this.memory&&(this.value=t);let e=-1;for(;this[++e];)this[e].push(t)},pipe:function(t){let e=-1;for(;this[++e];);return this.memory&&e===0&&this.input.pipe(this),this[e]=t,t.done(()=>ro(this,t)),this.value!==void 0&&t.push(this.value),!this.memory&&e===0&&this.input.pipe(this),t}});var oo=Array.prototype,io=Object.assign,so=Object.create;function uo(t){return t!==void 0}function ht(t){this.buffer=t?t.filter?t.filter(uo):t:[]}ht.prototype=io(so(p.prototype),{push:function(t){t!==void 0&&x(this.buffer,t)},pipe:function(t){for(t.done(this),this[0]=t;this.buffer.length;)x(this[0],oo.shift.apply(this.buffer));return this.buffer=t,t},stop:function(){return this.buffer=void 0,S(this),this}});var dn=Object.assign,ao=Object.create,co=Promise.resolve(),lo={schedule:function(){co.then(this.fire)},unschedule:M},po={schedule:function(){this.timer=requestAnimationFrame(this.fire)},unschedule:function(){cancelAnimationFrame(this.timer),this.timer=void 0}},fo={schedule:function(){this.timer=setTimeout(this.fire,this.duration*1e3)},unschedule:function(){clearTimeout(this.timer),this.timer=void 0}};function rt(t,e){p.apply(this,arguments),this.duration=e,this.timer=void 0,this.fire=()=>{this.timer=void 0,this.output.stop()},dn(this,e==="tick"?lo:e==="frame"?po:fo)}rt.prototype=dn(ao(p.prototype),{push:function(t){this.timer?(this.unschedule(),this.schedule(),this.output.push(t)):(this.output=p.of(t),this[0].push(this.output),this.schedule())},stop:function(){return this.timer&&this.fire(),p.prototype.stop.apply(this,arguments)}});var ae=Object.assign,ho=Object.create;function mo(t){return!!t.active}function go(t){return!!t.stopped}function ce(t,e,r,o,i,s){this.stream=t,this.values=e,this.pipes=r,this.name=o,this.input=i,this.mutable=s,this.active=!1,this.stopped=!1}ae(ce.prototype,{push:function(t){let e=this.stream,r=this.values,o=this.name;if(r[o]=t,this.active=!0,e.active||(e.active=this.pipes.every(mo)))if(this.mutable)x(e[0],r);else{let i=new this.values.constructor;x(e[0],ae(i,r))}},stop:function(){this.stopped=!0,this.pipes.every(go)&&S(this.stream)},done:function(t){this.stream.done(t)}});var wo={};function Mt(t,e=wo){this.inputs=t,this.mutable=!!e.mutable,this.active=!1}Mt.prototype=ae(ho(p.prototype),{push:null,pipe:function(t){let e=this.inputs,r=[];this[0]=t,t.done(this);let o;for(o in e){let i=e[o];if(i.pipe){let s=new ce(this,e,r,o,i,this.mutable);r.push(s),i.pipe(s)}else if(i.then){let s=new ce(this,e,r,o,i,this.mutable);r.push(s),i.then(a=>s.push(a)),i.finally(()=>s.stop())}}return t}});var yo=Object.assign,vo=Object.create;function kt(t){this.fn=t}kt.prototype=yo(vo(p.prototype),{pipe:function(t){return t.done(this),this[0]=t,this.fn(e=>this.push(e),e=>this.stop(e)),t}});var mn=Object.assign,To=Object.create;function gn(t){this.stream=t}mn(gn.prototype,{push:function(t){x(this.stream[0],t)},stop:function(){--this.stream.count===0&&S(this.stream)},done:function(t){this.stream.done(t)}});function At(t){this.inputs=t}At.prototype=mn(To(p.prototype),{push:null,pipe:function(t){let e=this.inputs;this.count=e.length,this[0]=t,t.done(this);let r=new gn(this),o=-1,i;for(;i=e[++o];)if(i.pipe)i.pipe(r);else if(i.then)i.then(s=>r.push(s)),i.finally(()=>r.stop());else{let s=-1;for(;++s<i.length;)r.push(i[s]);r.stop()}return t}});var bo=Object.assign,xo=Object.create;function Ot(t){this.promise=t}Ot.prototype=bo(xo(p.prototype),{push:null,pipe:function(t){let e=this.promise;return this[0]=t,t.done(this),e.then(r=>x(this,r)),e.finally(()=>S(this)),t}});var Eo=Array.prototype,wn=Object.assign;function So(t){throw new TypeError("Stream cannot be created from "+typeof object)}wn(p,{isStream:sn,of:function(){return new ht(Eo.slice.apply(arguments))},from:function(t){return t.pipe?new p(t):t.then?new Ot(t):typeof t.length=="number"?typeof t=="function"?new kt(t):new ht(t):So(t)},batch:t=>new rt(z,t),broadcast:t=>new ft(z,t),combine:(t,e)=>new Mt(t,e),merge:function(){return new At(arguments)},writeable:function(t){let e=new p(z);return t(e),e}});wn(p.prototype,{log:C,batch:function(t){return new rt(this,t)},burst:function(t){return console.warn("stream.burst() is now stream.batch()"),new rt(this,t)},broadcast:function(t){return new ft(this,t)}});function Po(t,e){return e[t]}var R=T(Po,!0);function j(t){if(typeof t.length=="number")return t[t.length-1]}function le(t,e,r){return(r-t)/(e-t)}function D(t,e,r){return r*(e-t)+t}var Mo=Object.assign,ko=Object.defineProperties,Ao=Object.isExtensible,Oo=Object.prototype,Y=Symbol("observe");function Lo(t,e){let r=t.indexOf(e);return r>-1&&t.splice(r,1),t}var yn={[Y]:{}};function Lt(t,e){if(!t||!t.length)return 0;t=t.slice(0);for(var r=-1;t[++r];)t[r].status!=="stopped"&&t[r].push(e);return r}function vn(t){this.observables={},this.gets=[],this.sets=void 0,this.target=t,this.observer=new Proxy(t,this),yn[Y].value=this,ko(t,yn)}Mo(vn.prototype,{notify:function(t){Lt(this.observables[t],this.target[t]),Lt(this.sets,this.target)},listen:function(t,e){(t===null?this.sets||(this.sets=[]):this.observables[t]||(this.observables[t]=[])).push(e)},unlisten:function(t,e){let r=t===null?this.sets:this.observables[t];r&&Lo(r,e)},get:function(e,r,o){let i=e[r];if(typeof r=="symbol"||r==="__proto__")return i;let s=Object.getOwnPropertyDescriptor(e,r);if((s?s.writable||s.set:i===void 0)&&Lt(this.gets,r),!Oo.hasOwnProperty.call(e,r))return i;let l=ot(i);if(!l)return i;for(var c=-1;this.gets[++c];)this.gets[c].listen(r);return l},set:function(e,r,o,i){if(typeof r=="symbol"||r==="__proto__")return e[r]=o,!0;let s=Z(o);if(e[r]===o||e[r]===s)return!0;let a=e.length;for(var l=-1;this.gets[++l];)this.gets[l].unlisten(r);return e[r]=s,r!=="length"&&e.length!==a&&Lt(this.observables.length,e.length),this.notify(r),!0},deleteProperty:function(t,e){return typeof e=="symbol"||e==="__proto__"?(delete t[e],!0):(t.hasOwnProperty(e)&&(delete t[e],this.notify(e)),!0)}});function Bt(t){return t&&Ao(t)&&!Node.prototype.isPrototypeOf(t)&&(typeof BaseAudioContext>"u"||!BaseAudioContext.prototype.isPrototypeOf(t))&&!(t instanceof Date)&&!(t instanceof RegExp)&&!(t instanceof Map)&&!(t instanceof WeakMap)&&!(t instanceof Set)&&!(window.WeakSet&&t instanceof WeakSet)&&!ArrayBuffer.isView(t)}function ot(t,e){return t?t[Y]?t[Y].observer:e||Bt(t)?new vn(t).observer:void 0:void 0}function Z(t){return t&&t[Y]&&t[Y].target||t}function pe(t){return ot(t)&&t[Y]}function Tn(t,e){let r=e[Y];r&&r.notify(t)}var bn=Object.assign,Bo=Object.create,fe=/(^\.?|\.)\s*([\w-]*)\s*/g;function Co(t){this.producer.push(t)}function he(t,e,r,o){fe.lastIndex=e;let i=fe.exec(t);this.path=t,this.object=r,this.producer=o,this.key=i[2]||i[1],this.index=fe.lastIndex,this.isMuteableObserver=this.path.slice(this.index)===".",this.index>=this.path.length&&(this.push=Co),this.listen(),this.push(this.key==="."?this.object:Z(this.object)[this.key])}bn(he.prototype,{push:function(t){Bt(t)?this.child?this.child.relisten(t):this.child=new he(this.path,this.index,t,this.producer):(this.child&&(this.child.stop(),this.child=void 0),this.producer.push(this.isMuteableObserver?t:void 0))},listen:function(){let t=pe(this.object);t&&t.listen(this.key==="."?null:this.key,this)},unlisten:function(){pe(this.object).unlisten(this.key==="."?null:this.key,this)},relisten:function(t){this.unlisten(),this.object=t,this.listen(),this.push(Z(this.object)[this.key])},stop:function(){this.unlisten(),this.child&&this.child.stop(),this.child=void 0,this.status="stopped"}});function xn(t,e,r){this.path=t,this.object=e,this.value=r}xn.prototype=bn(Bo(p.prototype),{push:function(t){this.value===t&&(!this.isMutationProducer||!Bt(t))||(this.value=t,this[0].push(t))},pipe:function(t){return this[0]=t,t.done(this),this.pathObserver=new he(this.path,0,this.object,this),this.isMutationProducer=this.path[this.path.length-1]===".",t},stop:function(){return this.pathObserver.stop(),p.prototype.stop.apply(this,arguments)}});function Ct(t,e,r){return new p(new xn(t,e,r))}function de(t){if(typeof t!="object"||arguments.length>1)throw new Error("delegate() now takes an object of selector:fn pairs.");return function(r){let o=r.target,i;for(i in t){let s=o.closest(i);if(s)return t[i](s,...arguments)}}}var Fo=Object.assign,Do=/\s+/,Ft={fullscreenchange:nt(()=>"fullscreenElement"in document?"fullscreenchange":"webkitFullscreenElement"in document?"webkitfullscreenchange":"mozFullScreenElement"in document?"mozfullscreenchange":"msFullscreenElement"in document?"MSFullscreenChange":"fullscreenchange")},En=0;window.addEventListener("click",t=>En=t.timeStamp);function Vo(t,e){return t.node.addEventListener(Ft[e]?Ft[e]():e,t,t.options),t}function Io(t,e){return t.node.removeEventListener(Ft[e]?Ft[e]():e,t),t}function Sn(t,e,r){this.types=t.split(Do),this.options=e,this.node=r,this.select=e&&e.select}Fo(Sn.prototype,{pipe:function(t){pt(this,t),this.types.reduce(Vo,this)},handleEvent:function(t){if(!(t.type==="click"&&t.timeStamp<=En)){if(this.select){let e=t.target.closest(this.select);if(!e)return;t.selectedTarget=e}x(this[0],t)}},stop:function(){this.types.reduce(Io,this),S(this[0])}});function me(t,e){let r;return typeof t=="object"&&(r=t,t=r.type),new p(new Sn(t,r,e))}var Ho=Object.assign,dt={bubbles:!0,cancelable:!0};function Dt(t,e){var f;let r=dt,o,i,s,a,l,c;return typeof t=="object"?(f=t,{type:t,detail:i,bubbles:s,cancelable:a,composed:l}=f,o=Xe(f,["type","detail","bubbles","cancelable","composed"]),c=Ho(new CustomEvent(t,{detail:i,bubbles:s||dt.bubbles,cancelable:a||dt.cancelable,composed:l||dt.composed}),o)):c=new CustomEvent(t,dt),e.dispatchEvent(c)}var vu=T(Dt,!0);function q(t){return typeof t}var jo=/^\s*([+-]?\d*\.?\d+)([^\s\d]*)\s*$/;function ge(t){return function(r){if(typeof r=="number")return r;var o=jo.exec(r);if(!o||!t[o[2]||""]){if(!t.catch)throw new Error('Cannot parse value "'+r+'" (accepted units '+Object.keys(t).join(", ")+")");return o?t.catch(parseFloat(o[1]),o[2]):t.catch(parseFloat(r))}return t[o[2]||""](parseFloat(o[1]))}}var Go=/px$/,Pn={"transform:translateX":function(t){var e=mt("transform",t);if(!e||e==="none")return 0;var r=Vt(e);return parseFloat(r[4])},"transform:translateY":function(t){var e=mt("transform",t);if(!e||e==="none")return 0;var r=Vt(e);return parseFloat(r[5])},"transform:scale":function(t){var e=mt("transform",t);if(!e||e==="none")return 0;var r=Vt(e),o=parseFloat(r[0]),i=parseFloat(r[1]);return Math.sqrt(o*o+i*i)},"transform:rotate":function(t){var e=mt("transform",t);if(!e||e==="none")return 0;var r=Vt(e),o=parseFloat(r[0]),i=parseFloat(r[1]);return Math.atan2(i,o)}};function Vt(t){return t.split("(")[1].split(")")[0].split(/\s*,\s*/)}function mt(t,e){return window.getComputedStyle?window.getComputedStyle(e,null).getPropertyValue(t):0}function It(t,e){if(Pn[t])return Pn[t](e);var r=mt(t,e);return typeof r=="string"&&Go.test(r)?parseFloat(r):r}var Ht,jt;function Ro(){if(!Ht){let t=document.documentElement.style.fontSize;document.documentElement.style.fontSize="100%",Ht=It("font-size",document.documentElement),document.documentElement.style.fontSize=t||""}return Ht}function Wo(){return jt||(jt=It("font-size",document.documentElement)),jt}window.addEventListener("resize",()=>{Ht=void 0,jt=void 0});var H=v(q,{number:b,string:ge({px:b,em:t=>Ro()*t,rem:t=>Wo()*t,vw:t=>window.innerWidth*t/100,vh:t=>window.innerHeight*t/100,vmin:t=>window.innerWidth<window.innerHeight?window.innerWidth*t/100:window.innerHeight*t/100,vmax:t=>window.innerWidth<window.innerHeight?window.innerHeight*t/100:window.innerWidth*t/100})}),Mn=H;function we(t){t.stopPropagation(),t.preventDefault()}var _o=Array.prototype,ve=Object.assign,ye="webkitUserSelect"in document.body.style?"webkitUserSelect":"userSelect",Gt={},Rt={threshold:4,ignoreTags:{textarea:!0,input:!0,select:!0}};function Uo(t,e,r){return e*e+r*r>=t*t}function kn(t,e,r){if(this.stream=t,this.events=[e],this.options=r,this.pointerId=e.pointerId,typeof r.threshold=="function")this.checkThreshold=r.threshold;else{let o=Mn(r.threshold);this.checkThreshold=(i,s,a)=>Uo(o,i,s,a)}document.addEventListener("pointermove",this),document.addEventListener("pointerup",this),document.addEventListener("pointercancel",this)}ve(kn.prototype,{handleEvent:v(R("type"),{pointermove:function(t){if(this.pointerId===t.pointerId){if(this.pointerId in Gt&&this!==Gt[this.pointerId]){this.stop();return}if(this.events.push(t),!this.isGesture){let e=this.events[0],r=t.clientX-e.clientX,o=t.clientY-e.clientY,i=(t.timeStamp-e.timeStamp)/1e3;this.checkThreshold(r,o,i)&&this.createGesture()}}},pointerup:function(t){this.pointerId===t.pointerId&&(this.events.push(t),this.stop(),this.isGesture&&document.addEventListener("click",we,{capture:!0,once:!0}))},default:function(t){this.pointerId===t.pointerId&&(this.events.push(t),this.stop())}}),createGesture:function(){this.isGesture=!0,this.userSelectState=document.body.style[ye],document.body.style[ye]="none",Gt[this.pointerId]=this,this.stream.push(new p(this))},pipe:function(t){for(pt(this,t);this.events.length;)x(this[0],_o.shift.apply(this.events));this.events=t},stop:function(){if(document.removeEventListener("pointermove",this),document.removeEventListener("pointerup",this),document.removeEventListener("pointercancel",this),this.isGesture&&(document.body.style[ye]=this.userSelectState,delete Gt[this.pointerId]),this[0]){let t=this[0];on(this,0),S(t)}}});function zo(t){var e=t.target.tagName;return e&&(!!Rt.ignoreTags[e.toLowerCase()]||t.target.draggable)}function An(t,e){this.node=t,this.options=e}ve(An.prototype,{pipe:function(t){return this[0]=t,this.node.addEventListener("pointerdown",this),t},handleEvent:function(t){if(t.button===0&&!(this.options.device&&!this.options.device.includes(t.pointerType))&&!zo(t)&&!(this.options.select&&!t.target.closest(this.options.select))){var e={type:t.type,target:t.target,currentTarget:t.currentTarget,clientX:t.clientX,clientY:t.clientY,timeStamp:t.timeStamp,pointerId:t.pointerId};new kn(this[0],e,this.options)}},stop:function(){return this[0]&&(this.node.removeEventListener("pointerdown",this),S(this[0])),this}});function Te(t,e){return t=e&&t?ve({},Rt,t):Rt,e=e||t,new p(new An(e,t))}function No(){return{x:0,y:0,left:0,top:0,right:window.innerWidth,bottom:window.innerHeight,width:window.innerWidth,height:window.innerHeight}}function Wt(t){return t===window?No():t.getClientRects()[0]||t.getBoundingClientRect()}function E(t){return Math.pow(10,t/20)}function A(t){if(!t)return 0;let e=+t;if(e||e===0)return e;let r=/^(?:(-?[\d.]+)|(-?∞))(?:(db|bpm)|(m|k)?(\w+))$/.exec(t.toLowerCase());if(!r)return 0;let o=r[2]?r[2]==="-∞"?-1/0:1/0:parseFloat(r[1]);return r[3]==="db"?E(o):r[3]==="bpm"?o/60:r[4]==="m"?o/1e3:r[4]==="k"?o*1e3:o}var On=Pt(/^([+\-]?(?:0|[1-9]\d*|∞)(?:\.\d+)?(?:[eE][+\-]?\d+)?\w*)\s*(?:\[([^\]]+)\]|([^\d\s-]\S*))?\s*/,{1:(t,e)=>{let r=A(e[1]);return t.push({value:r,label:e[1]}),t},2:(t,e)=>(j(t).label=e[2],t),3:(t,e)=>(j(t).label=e[3],t),done:(t,e)=>On(t,e),catch:b}),tt=v(q,{string:t=>On([],t.trim()),object:b});function Ln(t,e,r){let o=t,i=[{value:o}];for(;(o=o+r)<=e;)i.push({value:o});return i}function O(t,e){return Math.ceil(e/t)*t}var Bn=v(t=>t.toLowerCase(),{db:(t,e,r)=>tt("-∞dB -96dB -90dB -84dB -78dB -72dB -66dB -60dB -54dB -48dB -42dB -36dB -30dB -24dB -18dB -12dB -6dB 0dB 6dB 12dB 18dB 24dB"),default:(t,e,r)=>{let o=r-e,i=o<.8?O(.05,o/10):o<2?O(.2,o/10):o<8?O(.5,o/10):o<20?O(2,o/10):o<80?O(5,o/10):o<200?O(20,o/10):O(200,o),s=[],a=o<.8?O(.05,e):o<2?O(.2,e):o<8?O(.5,e):o<20?O(2,e):o<80?O(5,e):o<200?O(20,e):O(200,e);for(;a<=r;)s.push({label:o<2?a.toFixed(1):a,value:a}),a+=i;return s}});function be(t,e,r,o,i){return t.normal=e.normalise(r,o,i),t}function xe(t,e){let{scale:r,min:o,max:i,step:s,ticks:a,display:l}=e;return t.scale=r,t.min=o,t.max=i,t.ticks=(a?a.length?a:Bn(l,o,i):z).filter(c=>c.value>=t.min&&c.value<=t.max).map(c=>be(c,r,o,i,c.value)),t.step=s==="any"?void 0:s==="ticks"?t.ticks:/\s|,/.test(s)?tt(s).filter(c=>c.value>=t.min&&c.value<=t.max).map(c=>be(c,r,o,i,c.value)):Ln(o,i,A(s)).map(c=>be(c,r,o,i,c.value)),t.display=l,t}function Ee(t){return 20*Math.log10(t)}function X(t,e){var r=e%t;return r<0?r+t:r}var la=T(X);function gt(t){return function(r,...o){var i=t[r]||t.default;return i&&i.apply(this,o)}}var In=9,Yo=/(`[^`]*`)|(ms|[YMwdhms]{1,3}|±)/g;function qo(t){return t*60}function Xo(t){return t*3600}function $o(t){return t*1e3}function Cn(t){return t/60}function Fn(t){return t/3600}function Se(t){return t/86400}function Ko(t){return t/604800}function Dn(t){return t/2629800}function Jo(t){return t/31557600}function $(t){return t>=10?"":"0"}var Qo=/^([+-])?(\d{2,}):([0-5]\d)(?::((?:[0-5]\d|60)(?:.\d+)?))?$/,Zo=/^([+-])?(\d{2,}):(\d{2,})(?::(\d{2,}(?:.\d+)?))?$/,et=v(q,{number:b,string:ne(Qo,jn),default:function(t){throw new Error("parseTime() does not accept objects of type "+typeof t)}}),Hn=v(q,{number:b,string:ne(Zo,jn),default:function(t){throw new Error("parseTime() does not accept objects of type "+typeof t)}});function jn(t){let[e,r,o,i,s]=t;var a=Xo(parseInt(o,10))+(i?qo(parseInt(i,10))+(s?parseFloat(s,10):0):0);return r==="-"?-a:a}function ti(t,e){return t.replace(Yo,(r,o,i)=>o?o.slice(1,-1):Vn[r]?Vn[r](e):r)}function ei(t){var e=t<0?"-":"";t<0&&(t=-t);var r=Math.floor(t/3600),o=$(r)+r;if(t=t%3600,t===0)return e+o+":00";var i=Math.floor(t/60),s=$(i)+i;if(t=t%60,t===0)return e+o+":"+s;var a=$(t)+Gn(In,t);return e+o+":"+s+":"+a}function Gn(t,e){return e.toFixed(t).replace(/\.?0+$/,"")}var Vn={"±":function(e){return e<0?"-":""},Y:function(e){return e=e<0?-e:e,Math.floor(Jo(e))},M:function(e){return e=e<0?-e:e,Math.floor(Dn(e))},MM:function(e){return e=e<0?-e:e,Math.floor(Dn(e%31557600))},w:function(e){return e=e<0?-e:e,Math.floor(Ko(e))},ww:function(e){return e=e<0?-e:e,Math.floor(Se(e%2629800))},d:function(e){return e=e<0?-e:e,Math.floor(Se(e))},dd:function(e){return e=e<0?-e:e,Math.floor(Se(e%604800))},h:function(e){return e=e<0?-e:e,Math.floor(Fn(e))},hh:function(e){e=e<0?-e:e;var r=Math.floor(Fn(e%86400));return $(r)+r},m:function(e){e=e<0?-e:e;var r=Math.floor(Cn(e));return $(r)+r},mm:function(e){e=e<0?-e:e;var r=Math.floor(Cn(e%3600));return $(r)+r},s:function(e){return e=e<0?-e:e,Math.floor(e)},ss:function(e){e=e<0?-e:e;var r=Math.floor(e%60);return $(r)+r},sss:function(e){e=e<0?-e:e;var r=e%60;return $(r)+Gn(In,r)},ms:function(e){e=e<0?-e:e;var r=Math.floor($o(e%1));return r>=100?r:r>=10?"0"+r:"00"+r}},Rn=T(function(t,e){return t==="ISO"?ei(et(e)):ti(t,et(e))});var Ta=T(function(t,e){return et(e)+Hn(t)}),ba=T(function(t,e){return et(e)-Hn(t)}),xa=T(function(t,e){return et(t)-et(e)}),ni=gt({w:function(t){return t-X(604800,t)},d:function(t){return t-X(86400,t)},h:function(t){return t-X(3600,t)},m:function(t){return t-X(60,t)},s:function(t){return t-X(1,t)},ms:function(t){return t-X(.001,t)}}),Ea=T(function(t,e){return ni(t,et(e))});function ri(){return{unit:value<1?"m"+unit:unit,value:value<.001?(value*1e3).toFixed(2):value<1?(value*1e3).toPrecision(3):value.toPrecision(3)}}function oi(t,e){return{unit:e<1?"m"+t:e>=1e3?"k"+t:t,value:e<.001?(e*1e3).toFixed(2):e<1?(e*1e3).toPrecision(3):e>=1e3?(e/1e3).toPrecision(3):e.toPrecision(3)}}function ii(t,e){return{unit:e<.01?"m"+t:e<1?"c"+t:e>=1e3?"k"+t:t,value:e<.001?(e*1e3).toFixed(2):e<.01?(e*1e3).toPrecision(3):e<1?(e*100).toPrecision(3):e>=1e3?(e/1e3).toPrecision(3):e.toPrecision(3)}}var si={pan:(t,e)=>({unit:"",value:e===-1?"-1.00":e===0?"0.00":e===1?"1.00":e.toFixed(2)}),db:(t,e)=>{let r=Ee(e);return{unit:"dB",value:isFinite(r)?r<-1?r.toPrecision(3):r.toFixed(2):r<0?"-∞":"∞"}},hz:(t,e)=>({unit:e>=1e3?"kHz":"Hz",value:e<1?e.toFixed(2):e>=1e3?(e/1e3).toPrecision(3):e.toPrecision(3)}),semitone:(t,e)=>({unit:"",value:e===0?"0":e<0?"♭"+(-e/100).toFixed(2):"♯"+(e/100).toFixed(2)}),s:ri,m:ii,bpm:(t,e)=>{let r=e*60;return{unit:"bpm",value:r<100?r.toFixed(1):r.toFixed(0)}},int:(t,e)=>({unit:"",value:Math.round(e)}),"":(t,e)=>({unit:"",value:e>-1&&e<1?e.toFixed(2):e.toPrecision(3)}),default:v(t=>/[YMWwdhms]/.test(t)?"time":"default",{time:(t,e)=>({unit:"",value:Rn(t,e)}),default:oi})},Aa=v(t=>t.toLowerCase(),si);var Ba=E(-6),Ca=E(-12),Fa=E(-18),Wn=E(-24),_n=E(-30),Un=E(-36),Da=E(-42),zn=E(-48),Va=E(-54),Nn=E(-60),Yn=E(-66),qn=E(-72),Ia=E(-78),Ha=E(-84),ja=E(-90),Xn=E(-96),Pe=.25,$n=.4,Ga=Symbol("state");var Kn=Object.assign,Ut={};function Me(t,e,r){let o=r/(e*t);return(o<=1?o:Math.log(o)+1)/Ut[t]}function ui(t,e,r){let o=r*Ut[t];return e*t*(o<=1?o:Math.pow(Math.E,o-1))}function W(t){this.xover=t,Ut[t]||(Ut[t]=Math.log(1/t)+1)}Kn(W.prototype,{normalise:function(t,e,r){let o=Me(this.xover,e,t);return(Me(this.xover,e,r)-o)/(1-o)},denormalise:function(t,e,r){let o=Me(this.xover,e,t),i=r*(1-o)+o;return ui(this.xover,e,i)}});function _t(t){this.power=t}Kn(_t.prototype,{normalise:function(t,e,r){return Math.pow((r-t)/(e-t),1/this.power)},denormalise:function(t,e,r){return Math.pow(r,this.power)*(e-t)+t}});var ai={linear:{normalise:le,denormalise:D},"pow-2":new _t(2),"pow-3":new _t(3),"pow-4":new _t(4),log:{normalise:function(t,e,r){return Math.log(r/t)/Math.log(e/t)},denormalise:function(t,e,r){return t*Math.pow(e/t,r)}},"log-24db":new W(Wn),"log-30db":new W(_n),"log-36db":new W(Un),"log-48db":new W(zn),"log-60db":new W(Nn),"log-66db":new W(Yn),"log-72db":new W(qn),"log-96db":new W(Xn)};function wt(t){return ai[t&&t.toLowerCase()||"linear"]}var ke=wt("linear"),Ae=0,Oe=1;var Le="any",Be="";function Jn(t,e,r,o){return e.delete(r),o.forEach(i=>e.append(r,i.x+","+i.y)),t.setFormValue(e),e}var Ce=[];function Qn(t,e){t.clearRect(e.x,e.y,e.width,e.height)}function Zn(t,e,r,o){t.beginPath();let i=-1;for(;++i<r.length;)t.moveTo(e.x+r[i]*e.width,e.y),t.lineTo(e.x+r[i]*e.width,e.y+e.height);t.lineWidth="1",t.lineCap="round",t.strokeStyle=o,t.setLineDash(Ce),t.stroke(),t.closePath()}function tr(t,e,r,o){t.beginPath();let i=-1;for(;++i<r.length;)t.moveTo(e.x,e.y+(1-r[i])*e.height),t.lineTo(e.x+e.width,e.y+(1-r[i])*e.height);t.lineWidth="1",t.lineCap="round",t.strokeStyle=o,t.setLineDash(Ce),t.stroke(),t.closePath()}function er(t,e,r,o,i){t.beginPath(),t.moveTo(0,e.y+(1-o.y)*e.height),t.lineTo(e.x+o.x*e.width-r,e.y+(1-o.y)*e.height),t.moveTo(e.x+o.x*e.width+r,e.y+(1-o.y)*e.height),t.lineTo(e.x+e.width+100,e.y+(1-o.y)*e.height),t.moveTo(e.x+o.x*e.width,0),t.lineTo(e.x+o.x*e.width,e.y+(1-o.y)*e.height-r),t.moveTo(e.x+o.x*e.width,e.y+(1-o.y)*e.height+r),t.lineTo(e.x+o.x*e.width,e.y+e.height+100),t.lineWidth="1",t.lineCap="round",t.strokeStyle=i,t.setLineDash(Ce),t.stroke(),t.closePath()}function li(t,e,r){let o=t(e),i=t(r);return i===o?0:o>i?1:-1}var Fe=T(li,!0);var it=function(){};function nr(t,e){return e.length<t?e:e.slice(0,t-3)+"..."}var De=window.console?console.log.bind(console,"%cSoundstage %c%s","color: #e02053; font-weight: 600;","color: #8e9e9d; font-weight: 300;"):it,nc=window.console?console.groupCollapsed.bind(console,"%cSoundstage %c%s","color: #e02053; font-weight: 600;","color: #8e9e9d; font-weight: 300;"):it,rc=window.console?console.groupEnd.bind(console):it,Ve=window.console?function(t,e,r="",...o){typeof r=="string"&&(r=nr(48,r)),console.log("%c"+t+" %c"+(e||""),"color: #b5002f; font-weight: 600;","color: #8e9e9d; font-weight: 300;",r,...o)}:it,yt=window.console?function(t,e,r="",...o){typeof r=="string"&&(r=nr(48,r)),console.groupCollapsed("%c"+t+" %c"+(e||""),"color: #b5002f; font-weight: 600;","color: #8e9e9d; font-weight: 300;",r,...o)}:it,vt=window.console?console.groupEnd.bind(console):it;var Ie="idle",rr="cued",or="playing";var zt=!1,pi=Object.assign,ir=Object.defineProperties,fi={context:{writable:!0},startTime:{writable:!0},stopTime:{writable:!0}};function _(t){zt&&yt("mixin ","Playable"),ir(this,fi),this.context=t,zt&&vt()}_.reset=function(t){return t.startTime=void 0,t.stopTime=void 0,t};pi(_.prototype,{start:function(t=this.context.currentTime){if(zt&&this.startTime!==void 0&&(this.stopTime===void 0||t<this.stopTime))throw new Error("Attempt to start a node that is already playing");return this.startTime=t,this.stopTime=void 0,this},stop:function(t=this.context.currentTime){if(zt&&this.startTime===void 0)throw new Error("Attempt to stop a node that has not been started");return this.stopTime=this.startTime===void 0||t>this.startTime?t:this.startTime,this}});ir(_.prototype,{status:{get:function(){return this.startTime!==void 0?this.startTime<=this.context.currentTime?this.stopTime===void 0||this.stopTime>this.context.currentTime?or:Ie:rr:Ie}}});window.AudioContext=window.AudioContext||window.webkitAudioContext;AudioContext.prototype.getOutputTimestamp||(AudioContext.prototype.getOutputTimestamp=function(){return{contextTime:this.currentTime+this.outputLatency,performanceTime:window.performance.now()}});var K=new window.AudioContext;K.destination.channelInterpretation="discrete";K.destination.channelCount=K.destination.maxChannelCount;K.baseLatency===void 0&&(K.baseLatency=256/K.sampleRate);if(K.state==="suspended"){De("Audio context suspended","User interaction required");let t=["mousedown","keydown","touchstart","contextmenu"],e=(o,i)=>(document.addEventListener(i,o),o),r=(o,i)=>(document.removeEventListener(i,o),o);t.reduce(e,function o(i){K.resume().then(function(){De('Audio context resumed on "'+i.type+'"'),t.reduce(r,o)})})}function hi(t,e){return t.contextTime+(e-t.performanceTime)/1e3}function He(t,e){var r=t.getOutputTimestamp();return hi(r,e)}var P={channelCountLimit:12,basePath:window.soundstageBasePath||"/soundstage/",automationEventsKey:"automationEvents",animationFrameKey:"animationFrame",minExponentialValue:14013e-49,targetDurationFactor:9};var Yt=!1,ur=1e3/60;function di(t){return window.AudioParam&&window.AudioParam.prototype.isPrototypeOf(t)}function Tt(t){if(Yt&&!di(t))throw new Error("Not an AudioParam "+JSON.stringify(t));return t[P.automationEventsKey]||(t[P.automationEventsKey]=[])}var ar=v(R(1),{target:function(t){if(t[3]===void 0)throw new Error('Event "target" must have 2 parameters: [time, "target", value, duration]')},hold:function(t){if(t[2]!==void 0)throw new Error('Event "hold" takes 0 parameters: [time, "hold"]')},default:function(t){if(t[2]===void 0)throw new Error('Event "'+t[1]+'" must have 1 parameter: [time, "'+t[1]+'", value]')}});function sr(t,e){t.cancelScheduledValues(e.time),e.curve==="linear"?t.linearRampToValueAtTime(e.value,e.time):e.curve==="exponential"?t.exponentialRampToValueAtTime(e.value,e.time):e.curve==="step"&&t.setValueAtTime(e.value,e.time)}var mi={step:(t,e)=>t.setValueAtTime(e.value,e.time),linear:(t,e)=>t.linearRampToValueAtTime(e.value,e.time),exponential:(t,e)=>t.exponentialRampToValueAtTime(e.value,e.time),target:(t,e)=>t.setTargetAtTime(e.value,e.time,e.duration),curve:(t,e)=>t.setValueCurveAtTime(e.value,e.time,e.duration),hold:AudioParam.prototype.cancelAndHoldAtTime?function(e,r,o){if(o&&o.curve==="target")return sr(e,r);e.cancelAndHoldAtTime(r.time)}:sr},gi=v(b,{exponential:(t,e,r,o,i,s)=>{let a={time:i,value:Math.fround(s)};return a.value<=P.minExponentialValue?(a.time=r?r.time:0,a.curve="step"):r&&r.value<P.minExponentialValue?a.curve="step":a.curve="exponential",a},hold:function(t,e,r,o,i){return o&&o.curve==="linear"?{time:i,curve:"linear",value:Math.fround(je(r,o,i))}:o&&o.curve==="exponential"?{time:i,curve:"exponential",value:Math.fround(je(r,o,i))}:r&&r.curve==="target"?{time:i,curve:"step",value:bt(e,i)}:{time:i}},target:(t,e,r,o,i,s,a)=>({time:i,curve:"target",value:Math.fround(s),duration:a}),default:(t,e,r,o,i,s,a)=>({time:i,curve:t,value:Math.fround(s)})}),wi=gt({hold:function(t,e,r,o){r.length=o+1,e.curve&&r.push(e)},default:function(t,e,r,o){if(!t){r.push(e);return}if(t.time===e.time){for(;r[++o]&&r[o].time===e.time;)if(r[o].curve===e.curve){r.splice(o,1,e);return}r.splice(o,0,e);return}r.splice(o+1,0,e)}});function cr(t,e,r,o,i,s){for(var a=e.length;e[--a]&&e[a].time>=r;);let l=e[a],c=e[a+1],f=gi(o,t,l,c,r,i,s);mi[o](t,f,c),wi(o,c,f,e,a)}function Ge(t,e,r,o,i,s,a){if(r==="target"&&i===void 0)throw new Error('Automation curve "target" must have a duration');let l=Tt(t);if(cr(t,l,e,r,o,i),!s){Yt&&console.warn("No notify for param change",o,r,t);return}if(!a){Yt&&console.warn("No context for param change",o,r,t);return}if(t[P.animationFrameId])return;var c=-1;function f(h){if(c=(c+1)%3,c===0){t[P.animationFrameId]=requestAnimationFrame(f);return}let d=h+ur,y=He(a,d),u=bt(t,y),m=l[l.length-1];t[P.animationFrameId]=m&&y<=m.time?requestAnimationFrame(f):void 0,s(t,"value",u)}t[P.animationFrameId]=requestAnimationFrame(f)}function lr(t,e,r,o,i,s,a){if(o==="target"&&s===void 0)throw new Error('Automation curve "target" must have a duration');let l=t[e],c=Tt(l);if(cr(l,c,r,o,i,s),!a){Yt&&console.warn("No notify for param change",i,o,l);return}if(l[P.animationFrameId])return;var f=-1;function h(d){if(f=(f+1)%3,f===0){l[P.animationFrameId]=requestAnimationFrame(h);return}let y=d+ur,u=He(t.context,y),m=bt(l,u),w=c[c.length-1];l[P.animationFrameId]=w&&u<=w.time?requestAnimationFrame(h):void 0,a(t,e,m)}l[P.animationFrameId]=requestAnimationFrame(h)}var pr={step:function(e,r,o,i,s){return s<i?e:r},linear:function(e,r,o,i,s){return e+(r-e)*(s-o)/(i-o)},exponential:function(e,r,o,i,s){return e*Math.pow(r/e,(s-o)/(i-o))},target:function(e,r,o,i,s,a){return s<i?e:r+(e-r)*Math.pow(Math.E,(i-s)/a)},curve:function(t,e,r,o,i,s){}};function je(t,e,r){return pr[e.curve](t.value,e.value,t.time,e.time,r,t.duration)}function Nt(t,e,r){var o=t[e];return o.curve==="target"?pr.target(Nt(t,e-1,o.time),o.value,0,o.time,r,o.duration):o.value}function yi(t,e){for(var r=t.length;t[--r]&&t[r].time>=e;);var o=t[r],i=t[r+1];if(!o)return 0;if(!i)return Nt(t,r,e);if(i.time===e){for(;t[++r]&&t[r].time===e;);return Nt(t,r-1,e)}if(e<i.time)return i.curve==="linear"||i.curve==="exponential"?je(o,i,e):Nt(t,r,e)}function bt(t,e){var r=Tt(t);return!r||r.length===0?t.value:Math.fround(yi(r,e))}var st=!1;function Re(t,e,r,o){r&&r.setValueAtTime||(t[e]&&t[e].setValueAtTime?(st&&Ve("param",e+":",r),Tt(t[e]).length=0,lr(t,e,t.context.currentTime,"step",r,null,o)):t[e]&&t[e].connect?vi(t[e],r):(st&&Ve("prop",e+" =",r),t[e]=r))}function vi(t,e,r,o){st&&yt("assign",t.constructor.name,r?Object.keys(r).join(", "):"");let i={};if(r)for(let s in r)o&&o.indexOf(s)>-1||r[s]&&r[s].setValueAtTime||t.hasOwnProperty(s)&&r[s]!==void 0&&(Re(t,s,r[s]),i[s]=!0);for(let s in e)o&&o.indexOf(s)>-1||i[s]||Re(t,s,e[s]);st&&vt()}function fr(t,e,r){st&&yt("assign",t.constructor.name,e?Object.keys(e).join(", "):"");var o;for(o in e)r&&r.indexOf(o)>-1||e[o]&&e[o].setValueAtTime||(t[o]||t.hasOwnProperty(o))&&e[o]!==void 0&&Re(t,o,e[o]);return st&&vt(),t}var Ti=Object.assign,mr=Object.defineProperties,bi=Object.getOwnPropertyDescriptor,hr=P.targetDurationFactor,xi={attack:{writable:!0,enumerable:!0},release:{writable:!0,enumerable:!0},gain:{writable:!0,enumerable:!0},rate:{writable:!0,enumerable:!0}},Ei={attack:[[.008,"linear",1]],release:[[.008,"linear",0]],offset:0,gain:1,rate:1};function dr(t,e,r,o,i){var s;Ge(t,r,"hold");for(s of e)ar(s),Ge(t,r+s[0]/i,s[1],s[2]*o,s[3])}var xt=class extends ConstantSourceNode{constructor(e,r){super(e);super.start.call(this,e.currentTime),_.call(this,e),mr(this,xi),fr(this,Ti({},Ei,r))}start(e){if(!this.attack||this.attack.length===0)return this;_.prototype.start.apply(this,arguments),dr(this.offset,this.attack,this.startTime,this.gain,this.rate,"ConstantSource.offset");let r=j(this.attack);return r[2]===0&&(this.stopTime=e+(r[1]==="target"?r[0]+r[3]*hr:r[0])),this}stop(e){if(!this.release||this.release.length===0)return this;_.prototype.stop.apply(this,arguments);let r=bt(this.offset,this.stopTime);dr(this.offset,this.release,this.stopTime,r,this.rate,"ConstantSource.offset");let o=j(this.release);return o[2]!==0?(console.warn("Envelope.release does not end with value 0. Envelope will never stop.",this),this.stopTime=1/0):this.stopTime+=o[1]==="target"?o[0]+o[3]*hr:o[0],this}};mr(xt.prototype,{playing:bi(_.prototype,"status")});var qt=4,Si=[],Pi=[2,6];function gr(t,e,r,o,i){let s=0;for(t.beginPath(),t.moveTo(e.x+s/r,e.y+(1-o[0])*e.height);++s<o.length;)t.lineTo(e.x+s/r,e.y+(1-o[s])*e.height);t.strokeStyle=i,t.lineWidth="2",t.lineCap="round",t.setLineDash(Si),t.stroke(),t.lineTo(e.x+e.width,e.y+e.height),t.lineTo(e.x,e.y+e.height),t.fillStyle=i+"2b",t.fill(),t.closePath()}function wr(t,e,r,o){let i=-1,s=18;for(t.beginPath();++i<r.length;)r[i].type==="target"&&(t.moveTo(e.x+r[i].x*e.width,e.y+(1-(r[i-1]?r[i-1].y:0))*e.height),t.lineTo(e.x+r[i].x*e.width,e.y+(1-r[i].y)*e.height+((r[i-1]?r[i-1].y:0)>r[i].y?-s:s)),t.moveTo(e.x+r[i].x*e.width+s,e.y+(1-r[i].y)*e.height),t.lineTo(e.x+(r[i+1]?r[i+1].x:1)*e.width,e.y+(1-r[i].y)*e.height));t.lineWidth="2",t.lineCap="round",t.strokeStyle=o,t.setLineDash(Pi),t.stroke(),t.closePath()}function yr(t,e,r,o,i,s,a,l,c,f,h,d){let y=qt*e.width/r.width,u=new OfflineAudioContext(1,qt*e.width,22050),m=new xt(u,{attack:f.map(w=>w.type==="target"?[w.x*y/22050,w.type,w.y,w.duration*y/22050]:w.type?[w.x*y/22050,w.type,w.y]:[w.x*y/22050,"step",w.y])});return m.connect(u.destination),m.start(r.x,"attack"),m.stop(r.width),t.activeRenders=t.activeRenders?t.activeRenders+1:1,t.cacheddata&&gr(t,e,qt,t.cacheddata,h),t.cacheddata&&wr(t,e,f.map(w=>({x:o.normalise(i,s,w.x),y:a.normalise(l,c,w.y),type:w.type,duration:w.duration})).sort(Fe(R("x"))),h),u.startRendering().then(w=>{if(--t.activeRenders)return;d();let V=w.getChannelData(0).map(I=>a.normalise(l,c,I));gr(t,e,qt,V,h),wr(t,e,f.map(I=>({x:o.normalise(i,s,I.x),y:a.normalise(l,c,I.y),type:I.type,duration:I.duration})).sort(Fe(R("x"))),h),t.cacheddata=V})}function Mi(t){t.stop()}function ki(t,e){return t&&t.stop(),Ct(".",e)}function Tr(t,e,r,o,i,s){let a=Wt(t),l=H(e["font-size"]),c=H(e.borderLeftWidth)||0,f=H(e.borderTopWidth)||0,h=H(e.borderRightWidth)||0,d=H(e.borderBottomWidth)||0,y=H(e.paddingLeft)||0,u=H(e.paddingTop)||0,m=H(e.paddingRight)||0,w=H(e.paddingBottom)||0;return r.x=a.x+c+y,r.y=a.y+f+u,r.width=a.width-c-y-h-m,r.height=a.height-f-u-d-w,o.x=0,o.y=0,o.width=a.width-c-h,o.height=a.height-f-d,i.x=y,i.y=u,i.width=a.width-c-y-h-m,i.height=a.height-f-u-d-w,s.x=0,s.width=i.width/l,s.y=0,s.height=-i.height/l,a}function Ai(t,e,r,o,i,s){s.box=Tr(t,r,s.pxbox,s.paddingbox,s.contentbox,s.rangebox),o.width=s.paddingbox.width*2,o.height=s.paddingbox.height*2,e.setProperty("--range-x",s.rangebox.x),e.setProperty("--range-y",s.rangebox.y),e.setProperty("--range-width",s.rangebox.width),e.setProperty("--range-height",s.rangebox.height),i.setAttribute("viewBox",s.rangebox.x+" "+(s.rangebox.y+s.rangebox.height)+" "+s.rangebox.width+" "+-s.rangebox.height)}function Oi(t,e){let r=e.pxbox,o=e.valuebox,i=t.clientX-r.x-e.offset.x,s=r.height-(t.clientY-r.y-e.offset.y);e.x=at(o.x,o.x+o.width,D(o.x,o.x+o.width,i/r.width)),e.y=at(o.y,o.y+o.height,D(o.y,o.y+o.height,s/r.height))}var Li=v((t,e)=>e.type,{pointerdown:(t,e)=>{t.target=e.target,t.time=e.timeStamp/1e3,t.previous&&t.previous.type==="tap"&&t.time-t.previous.time<$n&&(t.type="double-tap",t.target=t.previous.target);let r=Wt(e.target);return t.offset=e.target===e.currentTarget?{x:0,y:0}:{x:e.clientX-(r.x+r.width/2),y:e.clientY-(r.y+r.height/2)},t.events.length=0,t.events.push(e),t},pointermove:(t,e)=>{t.events.push(e);let r=t.events[0];return e.timeStamp-r.timeStamp<Pe&&e.clientX-r.clientX<4&&e.clientY-r.clientY<4||(t.type="move",Oi(e,t)),t},default:(t,e)=>(t.events.push(e),t.duration=e.timeStamp/1e3-t.time,!t.type&&t.duration<Pe&&(t.type="tap"),t)}),Bi=de({".duration-handle":v((t,e)=>e.type,{pointermove:function(t,e){let r=D[e.yTransform](e.yMin,e.yMax,-e.y);return scope[3]=e.x<=scope[0]?minExponential:e.x-scope[0],scope[2]=r,e},default:M}),".control-handle":v((t,e)=>e.type,{tap:function(t,e){return e.scope=scope,e},"double-tap":function(t,e){let r=e.previous.scope;return ct(e.collection,r),e},move:function(t,e){let{internals:r,formdata:o,events:i,host:s,value:a,x:l,y:c}=e,f=t.dataset.index,h=ot(a[f]);return h.x=l,h.y=c,j(i).type!=="pointermove"?(Jn(r,o,s.name,a),Dt("change",s)):Dt("input",s),e},default:function(t){console.log("Untyped gesture",t)}}),"*":v((t,e)=>e.type,{"double-tap":function(t){let e=t.x,r=D[t.yTransform](t.yMin,t.yMax,-t.y);return insert(getTime,t.collection,[e,"step",r]),Tn(t.collection,".",t.collection),t},default:M})});function Xt(t,e){let r=t.getPropertyValue(e).trim();return r==="none"?void 0:r}function We(t,e,r,o,i,s,a,l,c=!0){let f={x:o.x*2,y:o.y*2,width:o.width*2,height:o.height*2},h=Xt(r,"--line-color-x"),d=Xt(r,"--line-color-y"),y=Xt(r,"--crosshair-color"),u=Xt(r,"--envelope-color");Qn(e,{x:0,y:0,width:t.width,height:t.height}),h&&Zn(e,f,s.ticks.filter(m=>i.x+i.width>=m.value&&m.value>=i.x).map(m=>m.normal),h),d&&tr(e,f,a.ticks.filter(m=>i.y+i.height>=m.value&&m.value>=i.y).map(m=>m.normal),d),y&&l&&l.length&&l.forEach(m=>er(e,f,28,{x:s.scale.normalise(s.min,s.max,m.x),y:a.scale.normalise(a.min,a.max,m.y)},y)),u&&c&&l&&l.length&&yr(e,f,i,s.scale,s.min,s.max,a.scale,a.min,a.max,l,u,()=>We(t,e,r,o,i,s,a,l,!1))}function Ci(t,e,r){return t.push(F("label",{part:r+"-tick tick",style:"--normal-"+r+": "+e.normal+";",html:"<span>"+e.label+"</span>"})),t}function br(t,e,r,o,i,s,a,l,c,f){t.setAttribute("transform","translate("+D(e.x,e.x+e.width,r.normalise(o,i,c.x))+" "+D(e.y,e.y+e.height,s.normalise(a,l,c.y))+")"),t.firstElementChild.innerHTML=(c.label?c.label+" ":"")+c.x+", "+c.y,t.dataset.index=f}function Fi(t,e,r,o,i,s,a,l,c){return F("path",{part:"handle",class:"control control-handle control-point",d:"M 0 0 m -0.5 0 a 0.5 0.5 0 1 0 1 0 a 0.5 0.5 0 1 0 -1 0",transform:"translate("+D(t.x,t.x+t.width,e.normalise(r,o,l.x))+" "+D(t.y,t.y+t.height,i.normalise(s,a,l.y))+")",html:"<title>"+(l.label?l.label+" ":"")+l.x+", "+l.y+"</title>",data:{index:c}})}function Di(t,e,r,o,i,s){let a=-1,l,c;for(;l=s[++a];)t[a]?(c=t[a],br(c,r,o.scale,o.min,o.max,i.scale,i.min,i.max,l,a)):(c=Fi(r,o.scale,o.min,o.max,i.scale,i.min,i.max,l,a),t.push(c),e.append(c));for(--a;c=t[++a];)c.remove()}function vr(t,e,r,o,i,s,a,l,c){e.setProperty("--"+t+"-normal-zero",r.normalise(o,i,0)),l.forEach(f=>f.remove()),l.length=0,l=s.reduce((f,h)=>Ci(f,h,t),l),c.after.apply(c,l)}var xr={construct:function(t,e){let r=F("style",":host {} :host > * { visibility: hidden; }"),o=F("label",{for:"input",html:"<slot></slot>",part:"label"}),i=F("canvas"),s=F("svg"),a=F("text",""),l=F("text",""),c=[],f=[],h=[],d=[],y=[];t.append(r,o,i,s,a,l);let u=k(this),m={value:[]},w=getComputedStyle(this),V=r.sheet.cssRules[0].style,I=r.sheet.cssRules[1].style,ut=i.getContext("2d"),$t=new FormData;u.host=this,u.hostStyle=V,u.childStyle=I,u.internals=e,u.data=m,u.ctx=ut,u.formdata=$t,u.shadow=new Promise(g=>u.load=g),u.pxbox={},u.paddingbox={},u.contentbox={},u.rangebox={x:0,y:6.75,width:6.75,height:-6.75},u.valuebox={x:0,y:0,width:1,height:1},u.xscale=p.of(ke),u.xmin=p.of(Ae),u.xmax=p.of(Oe),u.xstep=p.of(Le),u.xticks=p.of(null),u.xdisplay=p.of(Be),u.yscale=p.of(ke),u.ymin=p.of(Ae),u.ymax=p.of(Oe),u.ystep=p.of(Le),u.yticks=p.of(null),u.ydisplay=p.of(Be),u.value=p.of([{x:0,y:0,type:"step"}]);let Kt=p.merge(u.shadow,me("resize",window)).broadcast();Kt.each(()=>Ai(this,V,w,i,s,u));let Jt=p.combine({shadow:u.shadow,scale:u.xscale,min:u.xmin,max:u.xmax,ticks:u.xticks,step:u.xstep,display:u.xdisplay}).scan(xe,{}).broadcast(),Qt=p.combine({shadow:u.shadow,scale:u.yscale,min:u.ymin,max:u.ymax,ticks:u.yticks,step:u.ystep,display:u.ydisplay}).scan(xe,{}).broadcast();Jt.each(g=>{u.valuebox.x=g.min,u.valuebox.width=g.max-g.min}),Qt.each(g=>{u.valuebox.y=g.min,u.valuebox.height=g.max-g.min}),Jt.each(g=>vr("x",V,g.scale,g.min,g.max,g.ticks,c,h,a)),Qt.each(g=>vr("y",V,g.scale,g.min,g.max,g.ticks,f,d,l));let ze=u.value.scan(ki,null).flatMap(b).broadcast();p.combine({xaxis:Jt,yaxis:Qt,resizes:Kt,value:ze}).each(g=>{u.state=g,We(i,ut,w,u.contentbox,u.valuebox,g.xaxis,g.yaxis,g.value),Di(y,s,u.rangebox,g.xaxis,g.yaxis,g.value)}),u.valueObservers=ze.reduce((g,Pr)=>(g.forEach(Mi),g.push.apply(g,Pr.map((Ne,Ye,Mr)=>Ct(".",Ne,Ne).each(kr=>{let Ar=s.querySelectorAll("[part=handle]")[Ye];We(i,ut,w,u.contentbox,u.valuebox,u.state.xaxis,u.state.yaxis,Mr),br(Ar,u.rangebox,u.state.xaxis.scale,u.state.xaxis.min,u.state.xaxis.max,u.state.yaxis.scale,u.state.yaxis.min,u.state.yaxis.max,kr,Ye)}))),g),[]),Te({select:"[part=handle]",threshold:1},t).each(g=>{Tr(this,w,u.pxbox,u.paddingbox,u.contentbox,u.rangebox),g.scan(Li,{handles:y,internals:e,host:this,pxbox:u.pxbox,valuebox:u.valuebox,formdata:u.formdata,value:u.state.value,events:[]}).filter(R("type")).each(Bi)})},load:function(t){let e=k(this);e.childStyle.visibility="",e.load(t)}};function U(t,e,r=b){return{attribute:function(o){let i=k(this),s=r(o===null?e:o.trim());i[t].push(s)}}}function Et(t,e,r=b){return{attribute:function(o){this[t]=o===null?void 0:o},set:function(o){let i=k(this),s=r(typeof o=="string"?o.trim():o===void 0?e:o);i[t].push(s)},get:function(){return k(this).data[t]},enumerable:!0}}function Er(t){return{attribute:function(e){k(this)[t].push(e!==null)}}}function Vi(t,e){let r=t[t.length-1];return r&&r.y===void 0?r.y=A(e):r&&r.type==="target"&&r.duration===void 0?r.duration=A(e):r&&!/^-?\d/.test(e)?r.type=e:t.push({x:A(e)}),t}function _e(t){return t.split(/\s*,\s*|\s+/).reduce(Vi,[])}function Ii(t){return t.x+" "+t.y+(t.label?" "+t.label:"")}function Ue(t){return t.map(Ii).join(", ")}var Sr={xmin:Et("xmin",0,A),xmax:Et("xmax",1,A),ymin:Et("ymin",0,A),ymax:Et("ymax",1,A),xscale:U("xscale","linear",wt),yscale:U("yscale","linear",wt),xstep:U("xstep"),ystep:U("ystep"),xticks:U("xticks","",tt),yticks:U("yticks","",tt),xdisplay:U("xdisplay"),ydisplay:U("ydisplay"),ordered:Er("ordered"),value:{attribute:function(t){this.value=t},get:function(){let t=k(this);return Ue(t.state.value)},set:function(t){k(this).value.push(typeof t=="string"?_e(t):Z(t))},enumerable:!0},data:{get:function(){let t=k(this);return ot(t.data)},set:function(t){k(this).values.push(Z(t))},enumerable:!0}};var Hi=window.xyInputStylesheet||import.meta.url.replace(/\/[^\/]*([?#].*)?$/,"/")+"shadow.css",Ol=re("<xy-input>",xr,Sr,Hi);export{Ol as default};
