/* form-elements 
   0.0.4
   By Stephen Band
   Built 2023-03-28 02:37 */

var Xe=Object.getOwnPropertySymbols;var Lr=Object.prototype.hasOwnProperty,Cr=Object.prototype.propertyIsEnumerable;var $e=(t,e)=>{var r={};for(var o in t)Lr.call(t,o)&&e.indexOf(o)<0&&(r[o]=t[o]);if(t!=null&&Xe)for(var o of Xe(t))e.indexOf(o)<0&&Cr.call(t,o)&&(r[o]=t[o]);return r};function x(t){return t}function v(t,e){return function(){let o=t.apply(this,arguments),i=e[o]||e.default;if(!i)throw new Error('overload() no handler for "'+o+'"');return i.apply(this,arguments)}}function nt(t){var e=new Map;return function(o){if(e.has(o))return e.get(o);var i=t(o);return e.set(o,i),i}}var Br=Array.prototype;function Fr(t,e){return typeof t=="function"?t.apply(null,e):t}function Ke(t,e,r){r=r||t.length;var o=r===1?e?t:nt(t):nt(function(i){return Ke(function(){var s=[i];return s.push.apply(s,arguments),t.apply(null,s)},e,r-1)});return function i(s){return arguments.length===0?i:arguments.length===1?o(s):arguments.length>=r?t.apply(null,arguments):Fr(o(s),Br.slice.call(arguments,1))}}var b=Ke;function k(){}var Dr=v(x,{is:k,tag:k,data:function(t,e,r){Object.assign(e.dataset,r)},html:function(t,e,r){e.innerHTML=r},text:function(t,e,r){e.textContent=r},children:function(t,e,r){e.innerHTML="",e.append.apply(e,r)},points:J,cx:J,cy:J,r:J,transform:J,preserveAspectRatio:J,viewBox:J,default:function(t,e,r){t in e?e[t]=r:e.setAttribute(t,r)}});function J(t,e,r){e.setAttribute(t,r)}function Vr(t,e){for(var r=Object.keys(e),o=r.length;o--;)Dr(r[o],t,e[r[o]]);return t}var St=b(Vr,!0);var te="http://www.w3.org/2000/svg",Je=document.createElement("template"),ee=(t,e)=>e&&typeof e;function Qe(t,e){let r=document.createRange();return r.selectNode(t),r.createContextualFragment(e)}var L=v(ee,{string:function(t,e){let r=document.createElementNS(te,t);return r.innerHTML=e,r},object:function(t,e){let r=document.createElementNS(te,t);return typeof e.length=="number"?r.append.apply(r,e):St(r,e),r},default:t=>document.createElementNS(te,t)}),Ir=v(ee,{string:function(t,e){let r=document.createElement(t);return r.innerHTML=e,r},object:function(t,e){let r=document.createElement(t);return typeof e.length=="number"?r.append.apply(r,e):St(r,e),r},default:t=>document.createElement(t)}),Hr=v(x,{comment:function(t,e){return document.createComment(e||"")},fragment:v(ee,{string:function(t,e,r){return r?Qe(r,e):(Je.innerHTML=e,Je.content.cloneNode(!0))},object:function(t,e,r){let o=r?Qe(r):document.createDocumentFragment();return typeof e.length=="number"?o.append.apply(o,e):St(o,e),o},default:()=>document.createDocumentFragment()}),text:function(t,e){return document.createTextNode(e||"")},circle:L,ellipse:L,g:L,glyph:L,image:L,line:L,rect:L,use:L,path:L,pattern:L,polygon:L,polyline:L,svg:L,default:Ir}),F=Hr;function ne(t,e,r){let o;typeof r!="string"&&r.input!==void 0&&r.index!==void 0&&(o=r,r=o.input.slice(r.index+r[0].length+(r.consumed||0)));let i=t.exec(r);if(!i)return;let s=e(i);return o&&(o.consumed=(o.consumed||0)+i.index+i[0].length+(i.consumed||0)),s}var re=b(ne,!0);function jr(t,e,r){throw r.input!==void 0&&r.index!==void 0&&(r=r.input),new Error('Cannot parse string "'+(r.length>128?r.length.slice(0,128)+"…":r)+'"')}function Gr(t,e,r){let o=-1;for(;++o<r.length;)e=r[o]!==void 0&&t[o]?t[o](e,r):e;return t.done?t.done(e,r):t.close?t.close(e,r):e}function Rr(t,e,r,o){let i=ne(t,s=>Gr(e,r,s),o);return i===void 0?e.catch?e.catch(r,o):jr(t,e,o):i}var Pt=b(Rr,!0);var C=Symbol("internals"),Q=Symbol("shadow"),Ze=Object.defineProperties,Wr={a:HTMLAnchorElement,article:HTMLElement,dl:HTMLDListElement,p:HTMLParagraphElement,br:HTMLBRElement,fieldset:HTMLFieldSetElement,hr:HTMLHRElement,img:HTMLImageElement,li:HTMLLIElement,ol:HTMLOListElement,optgroup:HTMLOptGroupElement,q:HTMLQuoteElement,section:HTMLElement,textarea:HTMLTextAreaElement,td:HTMLTableCellElement,th:HTMLTableCellElement,tr:HTMLTableRowElement,tbody:HTMLTableSectionElement,thead:HTMLTableSectionElement,tfoot:HTMLTableSectionElement,ul:HTMLUListElement},_r={name:{set:function(t){return this.setAttribute("name",t)},get:function(){return this.getAttribute("name")||""}},form:{get:function(){return this[C].form}},labels:{get:function(){return this[C].labels}},validity:{get:function(){return this[C].validity}},validationMessage:{get:function(){return this[C].validationMessage}},willValidate:{get:function(){return this[C].willValidate}},checkValidity:{value:function(){return this[C].checkValidity()}},reportValidity:{value:function(){return this[C].reportValidity()}}},Ur={},tn={once:!0},en=0,nn=!1;function zr(t){return Wr[t]||window["HTML"+t[0].toUpperCase()+t.slice(1)+"Element"]||(()=>{throw new Error('Constructor not found for tag "'+t+'"')})()}var Nr=Pt(/^\s*<?([a-z][\w]*-[\w-]+)>?\s*$|^\s*<?([a-z][\w]*)\s+is[=\s]*["']?([a-z][\w]*-[\w]+)["']?>?\s*$/,{1:(t,e)=>({name:e[1]}),2:(t,e)=>({name:e[3],tag:e[2]}),catch:function(t,e){throw new SyntaxError(`dom element() – name must be of the form 'element-name' or 'tag is="element-name"' (`+e+")")}},null);function Yr(t,e){if(t.hasOwnProperty(e)){let r=t[e];delete t[e],t[e]=r}return t}function rn(t,e,r){t._initialLoad=!0;let o=t.attachShadow({mode:e.mode||"closed",delegatesFocus:e.focusable||!1});if(r){let i=F("link",{rel:"stylesheet",href:r});o.append(i)}return t[Q]=o,o}function qr(t){var e;if(t.attachInternals){if(e=t.attachInternals(),e.setFormValue)return e}else e={shadowRoot:t.shadowRoot};return e.input=F("input",{type:"hidden",name:t.name}),t.appendChild(e.input),e.setFormValue=function(r){this.input.value=r},e}function Xr(t){return!!t.attribute}function $r(t){return t.set||t.get||t.hasOwnProperty("value")}function Kr(t,e){return Xr(e[1])&&(t.attributes[e[0]]=e[1].attribute),$r(e[1])&&(t.properties[e[0]]=e[1]),t}function oe(t,e,r,o,i=""){let{name:s,tag:a}=Nr(t),l=typeof a=="string"?zr(a):HTMLElement,{attributes:c,properties:f}=r?Object.entries(r).reduce(Kr,{attributes:{},properties:{}}):Ur;function h(){let m=Reflect.construct(l,arguments,h),y=e.construct&&e.construct.length>en?rn(m,e,o||e.stylesheet):void 0,u=h.formAssociated?qr(m):{};return a&&(nn=!0),e.construct&&e.construct.call(m,y,u),f&&Object.keys(f).reduce(Yr,m),m}return h.prototype=Object.create(l.prototype,f),f.value&&(h.formAssociated=!0,Ze(h.prototype,_r),(e.enable||e.disable)&&(h.prototype.formDisabledCallback=function(m){return m?e.disable&&e.disable.call(this,this[Q],this[C]):e.enable&&e.enable.call(this,this[Q],this[C])}),e.reset&&(h.prototype.formResetCallback=function(){return e.reset.call(this,this[Q],this[C])}),e.restore&&(h.prototype.formStateRestoreCallback=function(){return e.restore.call(this,this[Q],this[C])})),c&&(h.observedAttributes=Object.keys(c),h.prototype.attributeChangedCallback=function(m,y,u){return c[m].call(this,u)}),h.prototype.connectedCallback=function(){let m=this,y=m[Q],u=m[C];if(m._initialLoad){let d=y.querySelectorAll('link[rel="stylesheet"]');if(d.length){let w=0,V=d.length,I=function(Jt){++w>=d.length&&(delete m._initialLoad,e.load&&e.load.call(m,y))},st=I;for(;V--;)d[V].addEventListener("load",I,tn),d[V].addEventListener("error",st,tn)}else e.load&&Promise.resolve(1).then(()=>e.load.call(this,y,u))}e.connect&&e.connect.call(this,y,u)},e.disconnect&&(h.prototype.disconnectedCallback=function(){return e.disconnect.call(this,this[Q],this[C])}),window.console&&window.console.log("%c<"+(a?a+" is="+s:s)+">%c "+i,"color: #3a8ab0; font-weight: 600;","color: #888888; font-weight: 400;"),window.customElements.define(s,h,a&&{extends:a}),a&&!nn&&document.querySelectorAll('[is="'+s+'"]').forEach(m=>{f&&Ze(m,f);let y=e.construct&&e.construct.length>en?rn(m,e,o||e.stylesheet):void 0;e.construct&&e.construct.call(m,y);let u;for(u in c){let d=m.attributes[u];d&&c[u].call(m,d.value)}e.connect&&e.connect.apply(m)}),h}var ie=Symbol("privates");function M(t){return t[ie]||Object.defineProperty(t,ie,{value:{}})[ie]}function ut(t,e,r){return r>e?e:r<t?t:r}var hs=b(ut);function se(t){return function(){return arguments[t]}}function B(){return this}var Jr=Object.create,Qr=Object.freeze;function Zr(){return!0}function on(){return-1}var z=Qr(Jr({shift:k,push:k,forEach:k,join:function(){return""},every:Zr,filter:B,find:k,findIndex:on,flat:B,flatMap:B,includes:function(){return!1},indexOf:on,map:B,reduce:se(1),sort:B,each:B,pipe:x,start:B,stop:B,done:B,valueOf:function(){return null}},{length:{value:0}}));function at(t,e){t.remove&&t.remove(e);let r;for(;(r=t.indexOf(e))!==-1;)t.splice(r,1);return t}var Es=b(at,!0);function ue(t){return t&&t[Symbol.iterator]}var to=Object.assign;function eo(t){return t.stop?t.stop():t()}function ct(){}to(ct.prototype,{stop:function(){let t=this.stopables;return this.stopables=void 0,t&&t.forEach(eo),this},done:function(t){return(this.stopables||(this.stopables=[])).push(t),this}});var G=Object.assign,N=Object.create;function lt(t,e){t[0]=e,e.done(t)}function sn(t,e){let r=t[e].stopables;r&&at(r,t),t[e]=void 0}function T(t,e){t&&t.push(e)}function S(t){ct.prototype.stop.apply(t);let e=-1,r;for(;r=t[++e];)t[e]=void 0,r.stop()}function un(t){return p.prototype.isPrototypeOf(t)}function p(t){this.input=t}G(p.prototype,ct.prototype,{push:function(t){T(this[0],t)},pipe:function(t){if(this[0])throw new Error("Stream: Attempt to .pipe() a unicast stream multiple times. Create a multicast stream with .broadcast().");return this[0]=t,t.done(this),this.input.pipe(this),t},map:function(t){return new an(this,t)},filter:function(t){return new cn(this,t)},split:function(t){return new pn(this,t)},flatMap:function(t){return new ln(this,t)},slice:function(t,e){return new ae(this,t,e)},take:function(t){return console.warn(".take(a) superseded by .slice(0, a)"),new ae(this,0,t)},each:function(t){return this.pipe(new mn(t))},reduce:function(t,e){return this.pipe(new fn(t,e)).value},scan:function(t,e){return new hn(this,t,e)},stop:function(){return S(this),this}});function an(t,e){this.input=t,this.fn=e}an.prototype=G(N(p.prototype),{push:function(e){let o=this.fn(e);o!==void 0&&T(this[0],o)}});function cn(t,e){this.input=t,this.fn=e}cn.prototype=G(N(p.prototype),{push:function(e){this.fn(e)&&T(this[0],e)}});function ln(t,e){this.input=t,this.fn=e}ln.prototype=G(N(p.prototype),{push:function(e){let o=this.fn(e);if(o!==void 0)if(ue(o))for(let i of o)T(this[0],i);else o.pipe&&this.done(o.each(i=>T(this[0],i)))}});function pn(t,e){this.input=t,this.chunk=[],typeof n=="number"?this.n=e:this.fn=e}pn.prototype=G(N(p.prototype),{fn:function(){return this.chunk.length===this.n},push:function(e){let r=this.chunk;this.fn(e)?(T(this[0],r),this.chunk=[]):r.push(e)}});function ae(t,e,r=1/0){this.input=t,this.index=-e,this.indexEnd=e+r}ae.prototype=G(N(p.prototype),{push:function(e){++this.index>0&&this[0].push(e),this.index===this.indexEnd&&this.stop()}});function fn(t,e){this.fn=t,this.value=e,this.i=0}fn.prototype=G(N(p.prototype),{push:function(t){let e=this.fn;this.value=e(this.value,t,this.i++,this)}});function hn(t,e,r){this.input=t,this.fn=e,this.value=r}hn.prototype=G(N(p.prototype),{push:function(t){let e=this.fn;this.value=e(this.value,t),this[0].push(this.value)}});function mn(t){this.push=t}mn.prototype=G(N(p.prototype),{each:null,reduce:null,pipe:null});var no=Object.assign,ro=Object.create;function oo(t,e){if(t[1]){let r=-1;for(;t[++r]&&t[r]!==e;);for(;t[r++];)t[r-1]=t[r]}else t.stop()}function pt(t,e){p.apply(this,arguments),this.memory=!!(e&&e.memory),e&&e.hot&&this.pipe(z)}pt.prototype=no(ro(p.prototype),{push:function(t){if(t===void 0)return;this.memory&&(this.value=t);let e=-1;for(;this[++e];)this[e].push(t)},pipe:function(t){let e=-1;for(;this[++e];);return this.memory&&e===0&&this.input.pipe(this),this[e]=t,t.done(()=>oo(this,t)),this.value!==void 0&&t.push(this.value),!this.memory&&e===0&&this.input.pipe(this),t}});var io=Array.prototype,so=Object.assign,uo=Object.create;function ao(t){return t!==void 0}function ft(t){this.buffer=t?t.filter?t.filter(ao):t:[]}ft.prototype=so(uo(p.prototype),{push:function(t){t!==void 0&&T(this.buffer,t)},pipe:function(t){for(t.done(this),this[0]=t;this.buffer.length;)T(this[0],io.shift.apply(this.buffer));return this.buffer=t,t},stop:function(){return this.buffer=void 0,S(this),this}});var dn=Object.assign,co=Object.create,lo=Promise.resolve(),po={schedule:function(){lo.then(this.fire)},unschedule:k},fo={schedule:function(){this.timer=requestAnimationFrame(this.fire)},unschedule:function(){cancelAnimationFrame(this.timer),this.timer=void 0}},ho={schedule:function(){this.timer=setTimeout(this.fire,this.duration*1e3)},unschedule:function(){clearTimeout(this.timer),this.timer=void 0}};function ht(t,e){p.apply(this,arguments),this.duration=e,this.timer=void 0,this.fire=()=>{this.timer=void 0,this.output.stop()},dn(this,e==="tick"?po:e==="frame"?fo:ho)}ht.prototype=dn(co(p.prototype),{push:function(t){this.timer?(this.unschedule(),this.schedule(),this.output.push(t)):(this.output=p.of(t),this[0].push(this.output),this.schedule())},stop:function(){return this.timer&&this.fire(),p.prototype.stop.apply(this,arguments)}});var mo=Object.assign,go=Object.create;function kt(t){this.duration=t}kt.prototype=mo(go(p.prototype),{push:null,pipe:function(t){this[0]=t;let e=this.duration==="frame"?r=>{this.frame=requestAnimationFrame(e),T(this[0],r/1e3)}:r=>{this.frame=setInterval(()=>T(this[0],performance.now()/1e3),this.duration*1e3),T(this[0],r/1e3)};return e(performance.now()),t},stop:function(){return this.duration==="frame"?cancelAnimationFrame(this.frame):clearInterval(this.frame),this.frame=void 0,S(this[0]),this}});var ce=Object.assign,wo=Object.create;function yo(t){return!!t.active}function vo(t){return!!t.stopped}function le(t,e,r,o,i,s){this.stream=t,this.values=e,this.pipes=r,this.name=o,this.input=i,this.mutable=s,this.active=!1,this.stopped=!1}ce(le.prototype,{push:function(t){let e=this.stream,r=this.values,o=this.name;if(r[o]=t,this.active=!0,e.active||(e.active=this.pipes.every(yo)))if(this.mutable)T(e[0],r);else{let i=new this.values.constructor;T(e[0],ce(i,r))}},stop:function(){this.stopped=!0,this.pipes.every(vo)&&S(this.stream)},done:function(t){this.stream.done(t)}});var To={};function Mt(t,e=To){this.inputs=t,this.mutable=!!e.mutable,this.active=!1}Mt.prototype=ce(wo(p.prototype),{push:null,pipe:function(t){let e=this.inputs,r=[];this[0]=t,t.done(this);let o;for(o in e){let i=e[o];if(i.pipe){let s=new le(this,e,r,o,i,this.mutable);r.push(s),i.pipe(s)}else if(i.then){let s=new le(this,e,r,o,i,this.mutable);r.push(s),i.then(a=>s.push(a)),i.finally(()=>s.stop())}}return t}});var bo=Object.assign,xo=Object.create;function At(t){this.fn=t}At.prototype=bo(xo(p.prototype),{pipe:function(t){return t.done(this),this[0]=t,this.fn(e=>this.push(e),e=>this.stop(e)),t}});var gn=Object.assign,Eo=Object.create;function wn(t){this.stream=t}gn(wn.prototype,{push:function(t){T(this.stream[0],t)},stop:function(){--this.stream.count===0&&S(this.stream)},done:function(t){this.stream.done(t)}});function Ot(t){this.inputs=t}Ot.prototype=gn(Eo(p.prototype),{push:null,pipe:function(t){let e=this.inputs;this.count=e.length,this[0]=t,t.done(this);let r=new wn(this),o=-1,i;for(;i=e[++o];)if(i.pipe)i.pipe(r);else if(i.then)i.then(s=>r.push(s)),i.finally(()=>r.stop());else{let s=-1;for(;++s<i.length;)r.push(i[s]);r.stop()}return t}});var So=Object.assign,Po=Object.create;function Lt(t){this.promise=t}Lt.prototype=So(Po(p.prototype),{push:null,pipe:function(t){let e=this.promise;return this[0]=t,t.done(this),e.then(r=>T(this,r)),e.finally(()=>S(this)),t}});var ko=Array.prototype,yn=Object.assign;function Mo(t){throw new TypeError("Stream cannot be created from "+typeof object)}yn(p,{isStream:un,of:function(){return new ft(ko.slice.apply(arguments))},from:function(t){return t.pipe?new p(t):t.then?new Lt(t):typeof t.length=="number"?typeof t=="function"?new At(t):new ft(t):Mo(t)},batch:t=>new ht(z,t),broadcast:t=>new pt(z,t),clock:t=>new kt(t),combine:(t,e)=>new Mt(t,e),merge:function(){return new Ot(arguments)},writeable:function(t){let e=new p(z);return t(e),e}});yn(p.prototype,{log:B,batch:function(t){return new ht(this,t)},broadcast:function(t){return new pt(this,t)}});function Ao(t,e){return e[t]}var R=b(Ao,!0);function j(t){if(typeof t.length=="number")return t[t.length-1]}function pe(t,e,r){return(r-t)/(e-t)}function D(t,e,r){return r*(e-t)+t}var Oo=Object.assign,Lo=Object.defineProperties,Co=Object.isExtensible,Bo=Object.prototype,Y=Symbol("observe");function Fo(t,e){let r=t.indexOf(e);return r>-1&&t.splice(r,1),t}var vn={[Y]:{}};function Ct(t,e){if(!t||!t.length)return 0;t=t.slice(0);for(var r=-1;t[++r];)t[r].status!=="stopped"&&t[r].push(e);return r}function Tn(t){this.observables={},this.gets=[],this.sets=void 0,this.target=t,this.observer=new Proxy(t,this),vn[Y].value=this,Lo(t,vn)}Oo(Tn.prototype,{notify:function(t){Ct(this.observables[t],this.target[t]),Ct(this.sets,this.target)},listen:function(t,e){(t===null?this.sets||(this.sets=[]):this.observables[t]||(this.observables[t]=[])).push(e)},unlisten:function(t,e){let r=t===null?this.sets:this.observables[t];r&&Fo(r,e)},get:function(e,r,o){let i=e[r];if(typeof r=="symbol"||r==="__proto__")return i;let s=Object.getOwnPropertyDescriptor(e,r);if((s?s.writable||s.set:i===void 0)&&Ct(this.gets,r),!Bo.hasOwnProperty.call(e,r))return i;let l=rt(i);if(!l)return i;for(var c=-1;this.gets[++c];)this.gets[c].listen(r);return l},set:function(e,r,o,i){if(typeof r=="symbol"||r==="__proto__")return e[r]=o,!0;let s=Z(o);if(e[r]===o||e[r]===s)return!0;let a=e.length;for(var l=-1;this.gets[++l];)this.gets[l].unlisten(r);return e[r]=s,r!=="length"&&e.length!==a&&Ct(this.observables.length,e.length),this.notify(r),!0},deleteProperty:function(t,e){return typeof e=="symbol"||e==="__proto__"?(delete t[e],!0):(t.hasOwnProperty(e)&&(delete t[e],this.notify(e)),!0)}});function Bt(t){return t&&Co(t)&&!Node.prototype.isPrototypeOf(t)&&(typeof BaseAudioContext>"u"||!BaseAudioContext.prototype.isPrototypeOf(t))&&!(t instanceof Date)&&!(t instanceof RegExp)&&!(t instanceof Map)&&!(t instanceof WeakMap)&&!(t instanceof Set)&&!(window.WeakSet&&t instanceof WeakSet)&&!ArrayBuffer.isView(t)}function rt(t,e){return t?t[Y]?t[Y].observer:e||Bt(t)?new Tn(t).observer:void 0:void 0}function Z(t){return t&&t[Y]&&t[Y].target||t}function fe(t){return rt(t)&&t[Y]}function bn(t,e){let r=e[Y];r&&r.notify(t)}var xn=Object.assign,Do=Object.create,he=/(^\.?|\.)\s*([\w-]*)\s*/g;function Vo(t){this.producer.push(t)}function me(t,e,r,o){he.lastIndex=e;let i=he.exec(t);this.path=t,this.object=r,this.producer=o,this.key=i[2]||i[1],this.index=he.lastIndex,this.isMuteableObserver=this.path.slice(this.index)===".",this.index>=this.path.length&&(this.push=Vo),this.listen(),this.push(this.key==="."?this.object:Z(this.object)[this.key])}xn(me.prototype,{push:function(t){Bt(t)?this.child?this.child.relisten(t):this.child=new me(this.path,this.index,t,this.producer):(this.child&&(this.child.stop(),this.child=void 0),this.producer.push(this.isMuteableObserver?t:void 0))},listen:function(){let t=fe(this.object);t&&t.listen(this.key==="."?null:this.key,this)},unlisten:function(){fe(this.object).unlisten(this.key==="."?null:this.key,this)},relisten:function(t){this.unlisten(),this.object=t,this.listen(),this.push(Z(this.object)[this.key])},stop:function(){this.unlisten(),this.child&&this.child.stop(),this.child=void 0,this.status="stopped"}});function En(t,e,r){this.path=t,this.object=e,this.value=r}En.prototype=xn(Do(p.prototype),{push:function(t){this.value===t&&(!this.isMutationProducer||!Bt(t))||(this.value=t,this[0].push(t))},pipe:function(t){return this[0]=t,t.done(this),this.pathObserver=new me(this.path,0,this.object,this),this.isMutationProducer=this.path[this.path.length-1]===".",t},stop:function(){return this.pathObserver.stop(),p.prototype.stop.apply(this,arguments)}});function Ft(t,e,r){return new p(new En(t,e,r))}function de(t){if(typeof t!="object"||arguments.length>1)throw new Error("delegate() now takes an object of selector:fn pairs.");return function(r){let o=r.target,i;for(i in t){let s=o.closest(i);if(s)return t[i](s,...arguments)}}}var Io=Object.assign,Ho=/\s+/,Dt={fullscreenchange:nt(()=>"fullscreenElement"in document?"fullscreenchange":"webkitFullscreenElement"in document?"webkitfullscreenchange":"mozFullScreenElement"in document?"mozfullscreenchange":"msFullscreenElement"in document?"MSFullscreenChange":"fullscreenchange")},Sn=0;window.addEventListener("click",t=>Sn=t.timeStamp);function jo(t,e){return t.node.addEventListener(Dt[e]?Dt[e]():e,t,t.options),t}function Go(t,e){return t.node.removeEventListener(Dt[e]?Dt[e]():e,t),t}function Pn(t,e,r){this.types=t.split(Ho),this.options=e,this.node=r,this.select=e&&e.select}Io(Pn.prototype,{pipe:function(t){lt(this,t),this.types.reduce(jo,this)},handleEvent:function(t){if(!(t.type==="click"&&t.timeStamp<=Sn)){if(this.select){let e=t.target.closest(this.select);if(!e)return;t.selectedTarget=e}T(this[0],t)}},stop:function(){this.types.reduce(Go,this),S(this[0])}});function ge(t,e){let r;return typeof t=="object"&&(r=t,t=r.type),new p(new Pn(t,r,e))}var Ro=Object.assign,mt={bubbles:!0,cancelable:!0};function Vt(t,e){var f;let r=mt,o,i,s,a,l,c;return typeof t=="object"?(f=t,{type:t,detail:i,bubbles:s,cancelable:a,composed:l}=f,o=$e(f,["type","detail","bubbles","cancelable","composed"]),c=Ro(new CustomEvent(t,{detail:i,bubbles:s||mt.bubbles,cancelable:a||mt.cancelable,composed:l||mt.composed}),o)):c=new CustomEvent(t,mt),e.dispatchEvent(c)}var Pu=b(Vt,!0);function q(t){return typeof t}var Wo=/^\s*([+-]?\d*\.?\d+)([^\s\d]*)\s*$/;function we(t){return function(r){if(typeof r=="number")return r;var o=Wo.exec(r);if(!o||!t[o[2]||""]){if(!t.catch)throw new Error('Cannot parse value "'+r+'" (accepted units '+Object.keys(t).join(", ")+")");return o?t.catch(parseFloat(o[1]),o[2]):t.catch(parseFloat(r))}return t[o[2]||""](parseFloat(o[1]))}}var _o=/px$/,kn={"transform:translateX":function(t){var e=dt("transform",t);if(!e||e==="none")return 0;var r=It(e);return parseFloat(r[4])},"transform:translateY":function(t){var e=dt("transform",t);if(!e||e==="none")return 0;var r=It(e);return parseFloat(r[5])},"transform:scale":function(t){var e=dt("transform",t);if(!e||e==="none")return 0;var r=It(e),o=parseFloat(r[0]),i=parseFloat(r[1]);return Math.sqrt(o*o+i*i)},"transform:rotate":function(t){var e=dt("transform",t);if(!e||e==="none")return 0;var r=It(e),o=parseFloat(r[0]),i=parseFloat(r[1]);return Math.atan2(i,o)}};function It(t){return t.split("(")[1].split(")")[0].split(/\s*,\s*/)}function dt(t,e){return window.getComputedStyle?window.getComputedStyle(e,null).getPropertyValue(t):0}function Ht(t,e){if(kn[t])return kn[t](e);var r=dt(t,e);return typeof r=="string"&&_o.test(r)?parseFloat(r):r}var jt,Gt;function Uo(){if(!jt){let t=document.documentElement.style.fontSize;document.documentElement.style.fontSize="100%",jt=Ht("font-size",document.documentElement),document.documentElement.style.fontSize=t||""}return jt}function zo(){return Gt||(Gt=Ht("font-size",document.documentElement)),Gt}window.addEventListener("resize",()=>{jt=void 0,Gt=void 0});var H=v(q,{number:x,string:we({px:x,em:t=>Uo()*t,rem:t=>zo()*t,vw:t=>window.innerWidth*t/100,vh:t=>window.innerHeight*t/100,vmin:t=>window.innerWidth<window.innerHeight?window.innerWidth*t/100:window.innerHeight*t/100,vmax:t=>window.innerWidth<window.innerHeight?window.innerHeight*t/100:window.innerWidth*t/100})}),Mn=H;function ye(t){t.stopPropagation(),t.preventDefault()}var No=Array.prototype,Te=Object.assign,ve="webkitUserSelect"in document.body.style?"webkitUserSelect":"userSelect",Rt={},Wt={threshold:4,ignoreTags:{textarea:!0,input:!0,select:!0}};function Yo(t,e,r){return e*e+r*r>=t*t}function An(t,e,r){if(this.stream=t,this.events=[e],this.options=r,this.pointerId=e.pointerId,typeof r.threshold=="function")this.checkThreshold=r.threshold;else{let o=Mn(r.threshold);this.checkThreshold=(i,s,a)=>Yo(o,i,s,a)}document.addEventListener("pointermove",this),document.addEventListener("pointerup",this),document.addEventListener("pointercancel",this)}Te(An.prototype,{handleEvent:v(R("type"),{pointermove:function(t){if(this.pointerId===t.pointerId){if(this.pointerId in Rt&&this!==Rt[this.pointerId]){this.stop();return}if(this.events.push(t),!this.isGesture){let e=this.events[0],r=t.clientX-e.clientX,o=t.clientY-e.clientY,i=(t.timeStamp-e.timeStamp)/1e3;this.checkThreshold(r,o,i)&&this.createGesture()}}},pointerup:function(t){this.pointerId===t.pointerId&&(this.events.push(t),this.stop(),this.isGesture&&document.addEventListener("click",ye,{capture:!0,once:!0}))},default:function(t){this.pointerId===t.pointerId&&(this.events.push(t),this.stop())}}),createGesture:function(){this.isGesture=!0,this.userSelectState=document.body.style[ve],document.body.style[ve]="none",Rt[this.pointerId]=this,this.stream.push(new p(this))},pipe:function(t){for(lt(this,t);this.events.length;)T(this[0],No.shift.apply(this.events));this.events=t},stop:function(){if(document.removeEventListener("pointermove",this),document.removeEventListener("pointerup",this),document.removeEventListener("pointercancel",this),this.isGesture&&(document.body.style[ve]=this.userSelectState,delete Rt[this.pointerId]),this[0]){let t=this[0];sn(this,0),S(t)}}});function qo(t){var e=t.target.tagName;return e&&(!!Wt.ignoreTags[e.toLowerCase()]||t.target.draggable)}function On(t,e){this.node=t,this.options=e}Te(On.prototype,{pipe:function(t){return this[0]=t,this.node.addEventListener("pointerdown",this),t},handleEvent:function(t){if(t.button===0&&!(this.options.device&&!this.options.device.includes(t.pointerType))&&!qo(t)&&!(this.options.select&&!t.target.closest(this.options.select))){var e={type:t.type,target:t.target,currentTarget:t.currentTarget,clientX:t.clientX,clientY:t.clientY,timeStamp:t.timeStamp,pointerId:t.pointerId};new An(this[0],e,this.options)}},stop:function(){return this[0]&&(this.node.removeEventListener("pointerdown",this),S(this[0])),this}});function be(t,e){return t=e&&t?Te({},Wt,t):Wt,e=e||t,new p(new On(e,t))}function Xo(){return{x:0,y:0,left:0,top:0,right:window.innerWidth,bottom:window.innerHeight,width:window.innerWidth,height:window.innerHeight}}function _t(t){return t===window?Xo():t.getClientRects()[0]||t.getBoundingClientRect()}function E(t){return Math.pow(10,t/20)}function A(t){if(!t)return 0;let e=+t;if(e||e===0)return e;let r=/^(?:(-?[\d.]+)|(-?∞))(?:(db|bpm)|(m|k)?(\w+))$/.exec(t.toLowerCase());if(!r)return 0;let o=r[2]?r[2]==="-∞"?-1/0:1/0:parseFloat(r[1]);return r[3]==="db"?E(o):r[3]==="bpm"?o/60:r[4]==="m"?o/1e3:r[4]==="k"?o*1e3:o}var Ln=Pt(/^([+\-]?(?:0|[1-9]\d*|∞)(?:\.\d+)?(?:[eE][+\-]?\d+)?\w*)\s*(?:\[([^\]]+)\]|([^\d\s-]\S*))?\s*/,{1:(t,e)=>{let r=A(e[1]);return t.push({value:r,label:e[1]}),t},2:(t,e)=>(j(t).label=e[2],t),3:(t,e)=>(j(t).label=e[3],t),done:(t,e)=>Ln(t,e),catch:x}),tt=v(q,{string:t=>Ln([],t.trim()),object:x});function Cn(t,e,r){let o=t,i=[{value:o}];for(;(o=o+r)<=e;)i.push({value:o});return i}function O(t,e){return Math.ceil(e/t)*t}var Bn=v(t=>t.toLowerCase(),{db:(t,e,r)=>tt("-∞dB -96dB -90dB -84dB -78dB -72dB -66dB -60dB -54dB -48dB -42dB -36dB -30dB -24dB -18dB -12dB -6dB 0dB 6dB 12dB 18dB 24dB"),default:(t,e,r)=>{let o=r-e,i=o<.8?O(.05,o/10):o<2?O(.2,o/10):o<8?O(.5,o/10):o<20?O(2,o/10):o<80?O(5,o/10):o<200?O(20,o/10):O(200,o),s=[],a=o<.8?O(.05,e):o<2?O(.2,e):o<8?O(.5,e):o<20?O(2,e):o<80?O(5,e):o<200?O(20,e):O(200,e);for(;a<=r;)s.push({label:o<2?a.toFixed(1):a,value:a}),a+=i;return s}});function xe(t,e,r,o,i){return t.normal=e.normalise(r,o,i),t}function Ee(t,e){let{scale:r,min:o,max:i,step:s,ticks:a,display:l}=e;return t.scale=r,t.min=o,t.max=i,t.ticks=(a?a.length?a:Bn(l,o,i):z).filter(c=>c.value>=t.min&&c.value<=t.max).map(c=>xe(c,r,o,i,c.value)),t.step=s==="any"?void 0:s==="ticks"?t.ticks:/\s|,/.test(s)?tt(s).filter(c=>c.value>=t.min&&c.value<=t.max).map(c=>xe(c,r,o,i,c.value)):Cn(o,i,A(s)).map(c=>xe(c,r,o,i,c.value)),t.display=l,t}function Se(t){return 20*Math.log10(t)}function X(t,e){var r=e%t;return r<0?r+t:r}var ga=b(X);function gt(t){return function(r,...o){var i=t[r]||t.default;return i&&i.apply(this,o)}}var Hn=9,$o=/(`[^`]*`)|(ms|[YMwdhms]{1,3}|±)/g;function Ko(t){return t*60}function Jo(t){return t*3600}function Qo(t){return t*1e3}function Fn(t){return t/60}function Dn(t){return t/3600}function Pe(t){return t/86400}function Zo(t){return t/604800}function Vn(t){return t/2629800}function ti(t){return t/31557600}function $(t){return t>=10?"":"0"}var ei=/^([+-])?(\d{2,}):([0-5]\d)(?::((?:[0-5]\d|60)(?:.\d+)?))?$/,ni=/^([+-])?(\d{2,}):(\d{2,})(?::(\d{2,}(?:.\d+)?))?$/,et=v(q,{number:x,string:re(ei,Gn),default:function(t){throw new Error("parseTime() does not accept objects of type "+typeof t)}}),jn=v(q,{number:x,string:re(ni,Gn),default:function(t){throw new Error("parseTime() does not accept objects of type "+typeof t)}});function Gn(t){let[e,r,o,i,s]=t;var a=Jo(parseInt(o,10))+(i?Ko(parseInt(i,10))+(s?parseFloat(s,10):0):0);return r==="-"?-a:a}function ri(t,e){return t.replace($o,(r,o,i)=>o?o.slice(1,-1):In[r]?In[r](e):r)}function oi(t){var e=t<0?"-":"";t<0&&(t=-t);var r=Math.floor(t/3600),o=$(r)+r;if(t=t%3600,t===0)return e+o+":00";var i=Math.floor(t/60),s=$(i)+i;if(t=t%60,t===0)return e+o+":"+s;var a=$(t)+Rn(Hn,t);return e+o+":"+s+":"+a}function Rn(t,e){return e.toFixed(t).replace(/\.?0+$/,"")}var In={"±":function(e){return e<0?"-":""},Y:function(e){return e=e<0?-e:e,Math.floor(ti(e))},M:function(e){return e=e<0?-e:e,Math.floor(Vn(e))},MM:function(e){return e=e<0?-e:e,Math.floor(Vn(e%31557600))},w:function(e){return e=e<0?-e:e,Math.floor(Zo(e))},ww:function(e){return e=e<0?-e:e,Math.floor(Pe(e%2629800))},d:function(e){return e=e<0?-e:e,Math.floor(Pe(e))},dd:function(e){return e=e<0?-e:e,Math.floor(Pe(e%604800))},h:function(e){return e=e<0?-e:e,Math.floor(Dn(e))},hh:function(e){e=e<0?-e:e;var r=Math.floor(Dn(e%86400));return $(r)+r},m:function(e){e=e<0?-e:e;var r=Math.floor(Fn(e));return $(r)+r},mm:function(e){e=e<0?-e:e;var r=Math.floor(Fn(e%3600));return $(r)+r},s:function(e){return e=e<0?-e:e,Math.floor(e)},ss:function(e){e=e<0?-e:e;var r=Math.floor(e%60);return $(r)+r},sss:function(e){e=e<0?-e:e;var r=e%60;return $(r)+Rn(Hn,r)},ms:function(e){e=e<0?-e:e;var r=Math.floor(Qo(e%1));return r>=100?r:r>=10?"0"+r:"00"+r}},Wn=b(function(t,e){return t==="ISO"?oi(et(e)):ri(t,et(e))});var ka=b(function(t,e){return et(e)+jn(t)}),Ma=b(function(t,e){return et(e)-jn(t)}),Aa=b(function(t,e){return et(t)-et(e)}),ii=gt({w:function(t){return t-X(604800,t)},d:function(t){return t-X(86400,t)},h:function(t){return t-X(3600,t)},m:function(t){return t-X(60,t)},s:function(t){return t-X(1,t)},ms:function(t){return t-X(.001,t)}}),Oa=b(function(t,e){return ii(t,et(e))});function si(){return{unit:value<1?"m"+unit:unit,value:value<.001?(value*1e3).toFixed(2):value<1?(value*1e3).toPrecision(3):value.toPrecision(3)}}function ui(t,e){return{unit:e<1?"m"+t:e>=1e3?"k"+t:t,value:e<.001?(e*1e3).toFixed(2):e<1?(e*1e3).toPrecision(3):e>=1e3?(e/1e3).toPrecision(3):e.toPrecision(3)}}function ai(t,e){return{unit:e<.01?"m"+t:e<1?"c"+t:e>=1e3?"k"+t:t,value:e<.001?(e*1e3).toFixed(2):e<.01?(e*1e3).toPrecision(3):e<1?(e*100).toPrecision(3):e>=1e3?(e/1e3).toPrecision(3):e.toPrecision(3)}}var ci={pan:(t,e)=>({unit:"",value:e===-1?"-1.00":e===0?"0.00":e===1?"1.00":e.toFixed(2)}),db:(t,e)=>{let r=Se(e);return{unit:"dB",value:isFinite(r)?r<-1?r.toPrecision(3):r.toFixed(2):r<0?"-∞":"∞"}},hz:(t,e)=>({unit:e>=1e3?"kHz":"Hz",value:e<1?e.toFixed(2):e>=1e3?(e/1e3).toPrecision(3):e.toPrecision(3)}),semitone:(t,e)=>({unit:"",value:e===0?"0":e<0?"♭"+(-e/100).toFixed(2):"♯"+(e/100).toFixed(2)}),s:si,m:ai,bpm:(t,e)=>{let r=e*60;return{unit:"bpm",value:r<100?r.toFixed(1):r.toFixed(0)}},int:(t,e)=>({unit:"",value:Math.round(e)}),"":(t,e)=>({unit:"",value:e>-1&&e<1?e.toFixed(2):e.toPrecision(3)}),default:v(t=>/[YMWwdhms]/.test(t)?"time":"default",{time:(t,e)=>({unit:"",value:Wn(t,e)}),default:ui})},Da=v(t=>t.toLowerCase(),ci);var Ha=E(-6),ja=E(-12),Ga=E(-18),_n=E(-24),Un=E(-30),zn=E(-36),Ra=E(-42),Nn=E(-48),Wa=E(-54),Yn=E(-60),qn=E(-66),Xn=E(-72),_a=E(-78),Ua=E(-84),za=E(-90),$n=E(-96),ke=.25,Kn=.4,Na=Symbol("state");var Jn=Object.assign,zt={};function Me(t,e,r){let o=r/(e*t);return(o<=1?o:Math.log(o)+1)/zt[t]}function li(t,e,r){let o=r*zt[t];return e*t*(o<=1?o:Math.pow(Math.E,o-1))}function W(t){this.xover=t,zt[t]||(zt[t]=Math.log(1/t)+1)}Jn(W.prototype,{normalise:function(t,e,r){let o=Me(this.xover,e,t);return(Me(this.xover,e,r)-o)/(1-o)},denormalise:function(t,e,r){let o=Me(this.xover,e,t),i=r*(1-o)+o;return li(this.xover,e,i)}});function Ut(t){this.power=t}Jn(Ut.prototype,{normalise:function(t,e,r){return Math.pow((r-t)/(e-t),1/this.power)},denormalise:function(t,e,r){return Math.pow(r,this.power)*(e-t)+t}});var pi={linear:{normalise:pe,denormalise:D},"pow-2":new Ut(2),"pow-3":new Ut(3),"pow-4":new Ut(4),log:{normalise:function(t,e,r){return Math.log(r/t)/Math.log(e/t)},denormalise:function(t,e,r){return t*Math.pow(e/t,r)}},"log-24db":new W(_n),"log-30db":new W(Un),"log-36db":new W(zn),"log-48db":new W(Nn),"log-60db":new W(Yn),"log-66db":new W(qn),"log-72db":new W(Xn),"log-96db":new W($n)};function wt(t){return pi[t&&t.toLowerCase()||"linear"]}var Ae=wt("linear"),Oe=0,Le=1;var Ce="any",Be="";function Qn(t,e,r,o){return e.delete(r),o.forEach(i=>e.append(r,i.x+","+i.y)),t.setFormValue(e),e}var Fe=[];function Zn(t,e){t.clearRect(e.x,e.y,e.width,e.height)}function tr(t,e,r,o){t.beginPath();let i=-1;for(;++i<r.length;)t.moveTo(e.x+r[i]*e.width,e.y),t.lineTo(e.x+r[i]*e.width,e.y+e.height);t.lineWidth="1",t.lineCap="round",t.strokeStyle=o,t.setLineDash(Fe),t.stroke(),t.closePath()}function er(t,e,r,o){t.beginPath();let i=-1;for(;++i<r.length;)t.moveTo(e.x,e.y+(1-r[i])*e.height),t.lineTo(e.x+e.width,e.y+(1-r[i])*e.height);t.lineWidth="1",t.lineCap="round",t.strokeStyle=o,t.setLineDash(Fe),t.stroke(),t.closePath()}function nr(t,e,r,o,i){t.beginPath(),t.moveTo(0,e.y+(1-o.y)*e.height),t.lineTo(e.x+o.x*e.width-r,e.y+(1-o.y)*e.height),t.moveTo(e.x+o.x*e.width+r,e.y+(1-o.y)*e.height),t.lineTo(e.x+e.width+100,e.y+(1-o.y)*e.height),t.moveTo(e.x+o.x*e.width,0),t.lineTo(e.x+o.x*e.width,e.y+(1-o.y)*e.height-r),t.moveTo(e.x+o.x*e.width,e.y+(1-o.y)*e.height+r),t.lineTo(e.x+o.x*e.width,e.y+e.height+100),t.lineWidth="1",t.lineCap="round",t.strokeStyle=i,t.setLineDash(Fe),t.stroke(),t.closePath()}function hi(t,e,r){let o=t(e),i=t(r);return i===o?0:o>i?1:-1}var De=b(hi,!0);var ot=function(){};function rr(t,e){return e.length<t?e:e.slice(0,t-3)+"..."}var Ve=window.console?console.log.bind(console,"%cSoundstage %c%s","color: #e02053; font-weight: 600;","color: #8e9e9d; font-weight: 300;"):ot,ac=window.console?console.groupCollapsed.bind(console,"%cSoundstage %c%s","color: #e02053; font-weight: 600;","color: #8e9e9d; font-weight: 300;"):ot,cc=window.console?console.groupEnd.bind(console):ot,Ie=window.console?function(t,e,r="",...o){typeof r=="string"&&(r=rr(48,r)),console.log("%c"+t+" %c"+(e||""),"color: #b5002f; font-weight: 600;","color: #8e9e9d; font-weight: 300;",r,...o)}:ot,yt=window.console?function(t,e,r="",...o){typeof r=="string"&&(r=rr(48,r)),console.groupCollapsed("%c"+t+" %c"+(e||""),"color: #b5002f; font-weight: 600;","color: #8e9e9d; font-weight: 300;",r,...o)}:ot,vt=window.console?console.groupEnd.bind(console):ot;var He="idle",or="cued",ir="playing";var Nt=!1,mi=Object.assign,sr=Object.defineProperties,di={context:{writable:!0},startTime:{writable:!0},stopTime:{writable:!0}};function _(t){Nt&&yt("mixin ","Playable"),sr(this,di),this.context=t,Nt&&vt()}_.reset=function(t){return t.startTime=void 0,t.stopTime=void 0,t};mi(_.prototype,{start:function(t=this.context.currentTime){if(Nt&&this.startTime!==void 0&&(this.stopTime===void 0||t<this.stopTime))throw new Error("Attempt to start a node that is already playing");return this.startTime=t,this.stopTime=void 0,this},stop:function(t=this.context.currentTime){if(Nt&&this.startTime===void 0)throw new Error("Attempt to stop a node that has not been started");return this.stopTime=this.startTime===void 0||t>this.startTime?t:this.startTime,this}});sr(_.prototype,{status:{get:function(){return this.startTime!==void 0?this.startTime<=this.context.currentTime?this.stopTime===void 0||this.stopTime>this.context.currentTime?ir:He:or:He}}});window.AudioContext=window.AudioContext||window.webkitAudioContext;AudioContext.prototype.getOutputTimestamp||(AudioContext.prototype.getOutputTimestamp=function(){return{contextTime:this.currentTime+this.outputLatency,performanceTime:window.performance.now()}});var K=new window.AudioContext;K.destination.channelInterpretation="discrete";K.destination.channelCount=K.destination.maxChannelCount;K.baseLatency===void 0&&(K.baseLatency=256/K.sampleRate);if(K.state==="suspended"){Ve("Audio context suspended","User interaction required");let t=["mousedown","keydown","touchstart","contextmenu"],e=(o,i)=>(document.addEventListener(i,o),o),r=(o,i)=>(document.removeEventListener(i,o),o);t.reduce(e,function o(i){K.resume().then(function(){Ve('Audio context resumed on "'+i.type+'"'),t.reduce(r,o)})})}function gi(t,e){return t.contextTime+(e-t.performanceTime)/1e3}function je(t,e){var r=t.getOutputTimestamp();return gi(r,e)}var P={channelCountLimit:12,basePath:window.soundstageBasePath||"/soundstage/",automationEventsKey:"automationEvents",animationFrameKey:"animationFrame",minExponentialValue:14013e-49,targetDurationFactor:9};var qt=!1,ar=1e3/60;function wi(t){return window.AudioParam&&window.AudioParam.prototype.isPrototypeOf(t)}function Tt(t){if(qt&&!wi(t))throw new Error("Not an AudioParam "+JSON.stringify(t));return t[P.automationEventsKey]||(t[P.automationEventsKey]=[])}var cr=v(R(1),{target:function(t){if(t[3]===void 0)throw new Error('Event "target" must have 2 parameters: [time, "target", value, duration]')},hold:function(t){if(t[2]!==void 0)throw new Error('Event "hold" takes 0 parameters: [time, "hold"]')},default:function(t){if(t[2]===void 0)throw new Error('Event "'+t[1]+'" must have 1 parameter: [time, "'+t[1]+'", value]')}});function ur(t,e){t.cancelScheduledValues(e.time),e.curve==="linear"?t.linearRampToValueAtTime(e.value,e.time):e.curve==="exponential"?t.exponentialRampToValueAtTime(e.value,e.time):e.curve==="step"&&t.setValueAtTime(e.value,e.time)}var yi={step:(t,e)=>t.setValueAtTime(e.value,e.time),linear:(t,e)=>t.linearRampToValueAtTime(e.value,e.time),exponential:(t,e)=>t.exponentialRampToValueAtTime(e.value,e.time),target:(t,e)=>t.setTargetAtTime(e.value,e.time,e.duration),curve:(t,e)=>t.setValueCurveAtTime(e.value,e.time,e.duration),hold:AudioParam.prototype.cancelAndHoldAtTime?function(e,r,o){if(o&&o.curve==="target")return ur(e,r);e.cancelAndHoldAtTime(r.time)}:ur},vi=v(x,{exponential:(t,e,r,o,i,s)=>{let a={time:i,value:Math.fround(s)};return a.value<=P.minExponentialValue?(a.time=r?r.time:0,a.curve="step"):r&&r.value<P.minExponentialValue?a.curve="step":a.curve="exponential",a},hold:function(t,e,r,o,i){return o&&o.curve==="linear"?{time:i,curve:"linear",value:Math.fround(Ge(r,o,i))}:o&&o.curve==="exponential"?{time:i,curve:"exponential",value:Math.fround(Ge(r,o,i))}:r&&r.curve==="target"?{time:i,curve:"step",value:bt(e,i)}:{time:i}},target:(t,e,r,o,i,s,a)=>({time:i,curve:"target",value:Math.fround(s),duration:a}),default:(t,e,r,o,i,s,a)=>({time:i,curve:t,value:Math.fround(s)})}),Ti=gt({hold:function(t,e,r,o){r.length=o+1,e.curve&&r.push(e)},default:function(t,e,r,o){if(!t){r.push(e);return}if(t.time===e.time){for(;r[++o]&&r[o].time===e.time;)if(r[o].curve===e.curve){r.splice(o,1,e);return}r.splice(o,0,e);return}r.splice(o+1,0,e)}});function lr(t,e,r,o,i,s){for(var a=e.length;e[--a]&&e[a].time>=r;);let l=e[a],c=e[a+1],f=vi(o,t,l,c,r,i,s);yi[o](t,f,c),Ti(o,c,f,e,a)}function Re(t,e,r,o,i,s,a){if(r==="target"&&i===void 0)throw new Error('Automation curve "target" must have a duration');let l=Tt(t);if(lr(t,l,e,r,o,i),!s){qt&&console.warn("No notify for param change",o,r,t);return}if(!a){qt&&console.warn("No context for param change",o,r,t);return}if(t[P.animationFrameId])return;var c=-1;function f(h){if(c=(c+1)%3,c===0){t[P.animationFrameId]=requestAnimationFrame(f);return}let m=h+ar,y=je(a,m),u=bt(t,y),d=l[l.length-1];t[P.animationFrameId]=d&&y<=d.time?requestAnimationFrame(f):void 0,s(t,"value",u)}t[P.animationFrameId]=requestAnimationFrame(f)}function pr(t,e,r,o,i,s,a){if(o==="target"&&s===void 0)throw new Error('Automation curve "target" must have a duration');let l=t[e],c=Tt(l);if(lr(l,c,r,o,i,s),!a){qt&&console.warn("No notify for param change",i,o,l);return}if(l[P.animationFrameId])return;var f=-1;function h(m){if(f=(f+1)%3,f===0){l[P.animationFrameId]=requestAnimationFrame(h);return}let y=m+ar,u=je(t.context,y),d=bt(l,u),w=c[c.length-1];l[P.animationFrameId]=w&&u<=w.time?requestAnimationFrame(h):void 0,a(t,e,d)}l[P.animationFrameId]=requestAnimationFrame(h)}var fr={step:function(e,r,o,i,s){return s<i?e:r},linear:function(e,r,o,i,s){return e+(r-e)*(s-o)/(i-o)},exponential:function(e,r,o,i,s){return e*Math.pow(r/e,(s-o)/(i-o))},target:function(e,r,o,i,s,a){return s<i?e:r+(e-r)*Math.pow(Math.E,(i-s)/a)},curve:function(t,e,r,o,i,s){}};function Ge(t,e,r){return fr[e.curve](t.value,e.value,t.time,e.time,r,t.duration)}function Yt(t,e,r){var o=t[e];return o.curve==="target"?fr.target(Yt(t,e-1,o.time),o.value,0,o.time,r,o.duration):o.value}function bi(t,e){for(var r=t.length;t[--r]&&t[r].time>=e;);var o=t[r],i=t[r+1];if(!o)return 0;if(!i)return Yt(t,r,e);if(i.time===e){for(;t[++r]&&t[r].time===e;);return Yt(t,r-1,e)}if(e<i.time)return i.curve==="linear"||i.curve==="exponential"?Ge(o,i,e):Yt(t,r,e)}function bt(t,e){var r=Tt(t);return!r||r.length===0?t.value:Math.fround(bi(r,e))}var it=!1;function We(t,e,r,o){r&&r.setValueAtTime||(t[e]&&t[e].setValueAtTime?(it&&Ie("param",e+":",r),Tt(t[e]).length=0,pr(t,e,t.context.currentTime,"step",r,null,o)):t[e]&&t[e].connect?xi(t[e],r):(it&&Ie("prop",e+" =",r),t[e]=r))}function xi(t,e,r,o){it&&yt("assign",t.constructor.name,r?Object.keys(r).join(", "):"");let i={};if(r)for(let s in r)o&&o.indexOf(s)>-1||r[s]&&r[s].setValueAtTime||t.hasOwnProperty(s)&&r[s]!==void 0&&(We(t,s,r[s]),i[s]=!0);for(let s in e)o&&o.indexOf(s)>-1||i[s]||We(t,s,e[s]);it&&vt()}function hr(t,e,r){it&&yt("assign",t.constructor.name,e?Object.keys(e).join(", "):"");var o;for(o in e)r&&r.indexOf(o)>-1||e[o]&&e[o].setValueAtTime||(t[o]||t.hasOwnProperty(o))&&e[o]!==void 0&&We(t,o,e[o]);return it&&vt(),t}var Ei=Object.assign,gr=Object.defineProperties,Si=Object.getOwnPropertyDescriptor,mr=P.targetDurationFactor,Pi={attack:{writable:!0,enumerable:!0},release:{writable:!0,enumerable:!0},gain:{writable:!0,enumerable:!0},rate:{writable:!0,enumerable:!0}},ki={attack:[[.008,"linear",1]],release:[[.008,"linear",0]],offset:0,gain:1,rate:1};function dr(t,e,r,o,i){var s;Re(t,r,"hold");for(s of e)cr(s),Re(t,r+s[0]/i,s[1],s[2]*o,s[3])}var xt=class extends ConstantSourceNode{constructor(e,r){super(e);super.start.call(this,e.currentTime),_.call(this,e),gr(this,Pi),hr(this,Ei({},ki,r))}start(e){if(!this.attack||this.attack.length===0)return this;_.prototype.start.apply(this,arguments),dr(this.offset,this.attack,this.startTime,this.gain,this.rate,"ConstantSource.offset");let r=j(this.attack);return r[2]===0&&(this.stopTime=e+(r[1]==="target"?r[0]+r[3]*mr:r[0])),this}stop(e){if(!this.release||this.release.length===0)return this;_.prototype.stop.apply(this,arguments);let r=bt(this.offset,this.stopTime);dr(this.offset,this.release,this.stopTime,r,this.rate,"ConstantSource.offset");let o=j(this.release);return o[2]!==0?(console.warn("Envelope.release does not end with value 0. Envelope will never stop.",this),this.stopTime=1/0):this.stopTime+=o[1]==="target"?o[0]+o[3]*mr:o[0],this}};gr(xt.prototype,{playing:Si(_.prototype,"status")});var Xt=4,Mi=[],Ai=[2,6];function wr(t,e,r,o,i){let s=0;for(t.beginPath(),t.moveTo(e.x+s/r,e.y+(1-o[0])*e.height);++s<o.length;)t.lineTo(e.x+s/r,e.y+(1-o[s])*e.height);t.strokeStyle=i,t.lineWidth="2",t.lineCap="round",t.setLineDash(Mi),t.stroke(),t.lineTo(e.x+e.width,e.y+e.height),t.lineTo(e.x,e.y+e.height),t.fillStyle=i+"2b",t.fill(),t.closePath()}function yr(t,e,r,o){let i=-1,s=18;for(t.beginPath();++i<r.length;)r[i].type==="target"&&(t.moveTo(e.x+r[i].x*e.width,e.y+(1-(r[i-1]?r[i-1].y:0))*e.height),t.lineTo(e.x+r[i].x*e.width,e.y+(1-r[i].y)*e.height+((r[i-1]?r[i-1].y:0)>r[i].y?-s:s)),t.moveTo(e.x+r[i].x*e.width+s,e.y+(1-r[i].y)*e.height),t.lineTo(e.x+(r[i+1]?r[i+1].x:1)*e.width,e.y+(1-r[i].y)*e.height));t.lineWidth="2",t.lineCap="round",t.strokeStyle=o,t.setLineDash(Ai),t.stroke(),t.closePath()}function vr(t,e,r,o,i,s,a,l,c,f,h,m){let y=Xt*e.width/r.width,u=new OfflineAudioContext(1,Xt*e.width,22050),d=new xt(u,{attack:f.map(w=>w.type==="target"?[w.x*y/22050,w.type,w.y,w.duration*y/22050]:w.type?[w.x*y/22050,w.type,w.y]:[w.x*y/22050,"step",w.y])});return d.connect(u.destination),d.start(r.x,"attack"),d.stop(r.width),t.activeRenders=t.activeRenders?t.activeRenders+1:1,t.cacheddata&&wr(t,e,Xt,t.cacheddata,h),t.cacheddata&&yr(t,e,f.map(w=>({x:o.normalise(i,s,w.x),y:a.normalise(l,c,w.y),type:w.type,duration:w.duration})).sort(De(R("x"))),h),u.startRendering().then(w=>{if(--t.activeRenders)return;m();let V=w.getChannelData(0).map(I=>a.normalise(l,c,I));wr(t,e,Xt,V,h),yr(t,e,f.map(I=>({x:o.normalise(i,s,I.x),y:a.normalise(l,c,I.y),type:I.type,duration:I.duration})).sort(De(R("x"))),h),t.cacheddata=V})}function Oi(t){t.stop()}function Li(t,e){return t&&t.stop(),Ft(".",e)}function br(t,e,r,o,i,s){let a=_t(t),l=H(e["font-size"]),c=H(e.borderLeftWidth)||0,f=H(e.borderTopWidth)||0,h=H(e.borderRightWidth)||0,m=H(e.borderBottomWidth)||0,y=H(e.paddingLeft)||0,u=H(e.paddingTop)||0,d=H(e.paddingRight)||0,w=H(e.paddingBottom)||0;return r.x=a.x+c+y,r.y=a.y+f+u,r.width=a.width-c-y-h-d,r.height=a.height-f-u-m-w,o.x=0,o.y=0,o.width=a.width-c-h,o.height=a.height-f-m,i.x=y,i.y=u,i.width=a.width-c-y-h-d,i.height=a.height-f-u-m-w,s.x=0,s.width=i.width/l,s.y=0,s.height=-i.height/l,a}function Ci(t,e,r,o,i,s){s.box=br(t,r,s.pxbox,s.paddingbox,s.contentbox,s.rangebox),o.width=s.paddingbox.width*2,o.height=s.paddingbox.height*2,e.setProperty("--range-x",s.rangebox.x),e.setProperty("--range-y",s.rangebox.y),e.setProperty("--range-width",s.rangebox.width),e.setProperty("--range-height",s.rangebox.height),i.setAttribute("viewBox",s.rangebox.x+" "+(s.rangebox.y+s.rangebox.height)+" "+s.rangebox.width+" "+-s.rangebox.height)}function Bi(t,e){let r=e.pxbox,o=e.valuebox,i=t.clientX-r.x-e.offset.x,s=r.height-(t.clientY-r.y-e.offset.y);e.x=ut(o.x,o.x+o.width,D(o.x,o.x+o.width,i/r.width)),e.y=ut(o.y,o.y+o.height,D(o.y,o.y+o.height,s/r.height))}var Fi=v((t,e)=>e.type,{pointerdown:(t,e)=>{t.target=e.target,t.time=e.timeStamp/1e3,t.previous&&t.previous.type==="tap"&&t.time-t.previous.time<Kn&&(t.type="double-tap",t.target=t.previous.target);let r=_t(e.target);return t.offset=e.target===e.currentTarget?{x:0,y:0}:{x:e.clientX-(r.x+r.width/2),y:e.clientY-(r.y+r.height/2)},t.events.length=0,t.events.push(e),t},pointermove:(t,e)=>{t.events.push(e);let r=t.events[0];return e.timeStamp-r.timeStamp<ke&&e.clientX-r.clientX<4&&e.clientY-r.clientY<4||(t.type="move",Bi(e,t)),t},default:(t,e)=>(t.events.push(e),t.duration=e.timeStamp/1e3-t.time,!t.type&&t.duration<ke&&(t.type="tap"),t)}),Di=de({".duration-handle":v((t,e)=>e.type,{pointermove:function(t,e){let r=D[e.yTransform](e.yMin,e.yMax,-e.y);return scope[3]=e.x<=scope[0]?minExponential:e.x-scope[0],scope[2]=r,e},default:k}),".control-handle":v((t,e)=>e.type,{tap:function(t,e){return e.scope=scope,e},"double-tap":function(t,e){let r=e.previous.scope;return at(e.collection,r),e},move:function(t,e){let{internals:r,formdata:o,events:i,host:s,value:a,x:l,y:c}=e,f=t.dataset.index,h=rt(a[f]);return h.x=l,h.y=c,j(i).type!=="pointermove"?(Qn(r,o,s.name,a),Vt("change",s)):Vt("input",s),e},default:function(t){console.log("Untyped gesture",t)}}),"*":v((t,e)=>e.type,{"double-tap":function(t){let e=t.x,r=D[t.yTransform](t.yMin,t.yMax,-t.y);return insert(getTime,t.collection,[e,"step",r]),bn(t.collection,".",t.collection),t},default:k})});function $t(t,e){let r=t.getPropertyValue(e).trim();return r==="none"?void 0:r}function _e(t,e,r,o,i,s,a,l,c=!0){let f={x:o.x*2,y:o.y*2,width:o.width*2,height:o.height*2},h=$t(r,"--line-color-x"),m=$t(r,"--line-color-y"),y=$t(r,"--crosshair-color"),u=$t(r,"--envelope-color");Zn(e,{x:0,y:0,width:t.width,height:t.height}),h&&tr(e,f,s.ticks.filter(d=>i.x+i.width>=d.value&&d.value>=i.x).map(d=>d.normal),h),m&&er(e,f,a.ticks.filter(d=>i.y+i.height>=d.value&&d.value>=i.y).map(d=>d.normal),m),y&&l&&l.length&&l.forEach(d=>nr(e,f,28,{x:s.scale.normalise(s.min,s.max,d.x),y:a.scale.normalise(a.min,a.max,d.y)},y)),u&&c&&l&&l.length&&vr(e,f,i,s.scale,s.min,s.max,a.scale,a.min,a.max,l,u,()=>_e(t,e,r,o,i,s,a,l,!1))}function Vi(t,e,r){return t.push(F("label",{part:r+"-tick tick",style:"--normal-"+r+": "+e.normal+";",html:"<span>"+e.label+"</span>"})),t}function xr(t,e,r,o,i,s,a,l,c,f){t.setAttribute("transform","translate("+D(e.x,e.x+e.width,r.normalise(o,i,c.x))+" "+D(e.y,e.y+e.height,s.normalise(a,l,c.y))+")"),t.firstElementChild.innerHTML=(c.label?c.label+" ":"")+c.x+", "+c.y,t.dataset.index=f}function Ii(t,e,r,o,i,s,a,l,c){return F("path",{part:"handle",class:"control control-handle control-point",d:"M 0 0 m -0.5 0 a 0.5 0.5 0 1 0 1 0 a 0.5 0.5 0 1 0 -1 0",transform:"translate("+D(t.x,t.x+t.width,e.normalise(r,o,l.x))+" "+D(t.y,t.y+t.height,i.normalise(s,a,l.y))+")",html:"<title>"+(l.label?l.label+" ":"")+l.x+", "+l.y+"</title>",data:{index:c}})}function Hi(t,e,r,o,i,s){let a=-1,l,c;for(;l=s[++a];)t[a]?(c=t[a],xr(c,r,o.scale,o.min,o.max,i.scale,i.min,i.max,l,a)):(c=Ii(r,o.scale,o.min,o.max,i.scale,i.min,i.max,l,a),t.push(c),e.append(c));for(--a;c=t[++a];)c.remove()}function Tr(t,e,r,o,i,s,a,l,c){e.setProperty("--"+t+"-normal-zero",r.normalise(o,i,0)),l.forEach(f=>f.remove()),l.length=0,l=s.reduce((f,h)=>Vi(f,h,t),l),c.after.apply(c,l)}var Er={construct:function(t,e){let r=F("style",":host {} :host > * { visibility: hidden; }"),o=F("label",{for:"input",html:"<slot></slot>",part:"label"}),i=F("canvas"),s=F("svg"),a=F("text",""),l=F("text",""),c=[],f=[],h=[],m=[],y=[];t.append(r,o,i,s,a,l);let u=M(this),d={value:[]},w=getComputedStyle(this),V=r.sheet.cssRules[0].style,I=r.sheet.cssRules[1].style,st=i.getContext("2d"),Kt=new FormData;u.host=this,u.hostStyle=V,u.childStyle=I,u.internals=e,u.data=d,u.ctx=st,u.formdata=Kt,u.shadow=new Promise(g=>u.load=g),u.pxbox={},u.paddingbox={},u.contentbox={},u.rangebox={x:0,y:6.75,width:6.75,height:-6.75},u.valuebox={x:0,y:0,width:1,height:1},u.xscale=p.of(Ae),u.xmin=p.of(Oe),u.xmax=p.of(Le),u.xstep=p.of(Ce),u.xticks=p.of(null),u.xdisplay=p.of(Be),u.yscale=p.of(Ae),u.ymin=p.of(Oe),u.ymax=p.of(Le),u.ystep=p.of(Ce),u.yticks=p.of(null),u.ydisplay=p.of(Be),u.value=p.of([{x:0,y:0,type:"step"}]);let Jt=p.merge(u.shadow,ge("resize",window)).broadcast();Jt.each(()=>Ci(this,V,w,i,s,u));let Qt=p.combine({shadow:u.shadow,scale:u.xscale,min:u.xmin,max:u.xmax,ticks:u.xticks,step:u.xstep,display:u.xdisplay}).scan(Ee,{}).broadcast(),Zt=p.combine({shadow:u.shadow,scale:u.yscale,min:u.ymin,max:u.ymax,ticks:u.yticks,step:u.ystep,display:u.ydisplay}).scan(Ee,{}).broadcast();Qt.each(g=>{u.valuebox.x=g.min,u.valuebox.width=g.max-g.min}),Zt.each(g=>{u.valuebox.y=g.min,u.valuebox.height=g.max-g.min}),Qt.each(g=>Tr("x",V,g.scale,g.min,g.max,g.ticks,c,h,a)),Zt.each(g=>Tr("y",V,g.scale,g.min,g.max,g.ticks,f,m,l));let Ne=u.value.scan(Li,null).flatMap(x).broadcast();p.combine({xaxis:Qt,yaxis:Zt,resizes:Jt,value:Ne}).each(g=>{u.state=g,_e(i,st,w,u.contentbox,u.valuebox,g.xaxis,g.yaxis,g.value),Hi(y,s,u.rangebox,g.xaxis,g.yaxis,g.value)}),u.valueObservers=Ne.reduce((g,kr)=>(g.forEach(Oi),g.push.apply(g,kr.map((Ye,qe,Mr)=>Ft(".",Ye,Ye).each(Ar=>{let Or=s.querySelectorAll("[part=handle]")[qe];_e(i,st,w,u.contentbox,u.valuebox,u.state.xaxis,u.state.yaxis,Mr),xr(Or,u.rangebox,u.state.xaxis.scale,u.state.xaxis.min,u.state.xaxis.max,u.state.yaxis.scale,u.state.yaxis.min,u.state.yaxis.max,Ar,qe)}))),g),[]),be({select:"[part=handle]",threshold:1},t).each(g=>{br(this,w,u.pxbox,u.paddingbox,u.contentbox,u.rangebox),g.scan(Fi,{handles:y,internals:e,host:this,pxbox:u.pxbox,valuebox:u.valuebox,formdata:u.formdata,value:u.state.value,events:[]}).filter(R("type")).each(Di)})},load:function(t){let e=M(this);e.childStyle.visibility="",e.load(t)}};function U(t,e,r=x){return{attribute:function(o){let i=M(this),s=r(o===null?e:o.trim());i[t].push(s)}}}function Et(t,e,r=x){return{attribute:function(o){this[t]=o===null?void 0:o},set:function(o){let i=M(this),s=r(typeof o=="string"?o.trim():o===void 0?e:o);i[t].push(s)},get:function(){return M(this).data[t]},enumerable:!0}}function Sr(t){return{attribute:function(e){M(this)[t].push(e!==null)}}}function ji(t,e){let r=t[t.length-1];return r&&r.y===void 0?r.y=A(e):r&&r.type==="target"&&r.duration===void 0?r.duration=A(e):r&&!/^-?\d/.test(e)?r.type=e:t.push({x:A(e)}),t}function Ue(t){return t.split(/\s*,\s*|\s+/).reduce(ji,[])}function Gi(t){return t.x+" "+t.y+(t.label?" "+t.label:"")}function ze(t){return t.map(Gi).join(", ")}var Pr={xmin:Et("xmin",0,A),xmax:Et("xmax",1,A),ymin:Et("ymin",0,A),ymax:Et("ymax",1,A),xscale:U("xscale","linear",wt),yscale:U("yscale","linear",wt),xstep:U("xstep"),ystep:U("ystep"),xticks:U("xticks","",tt),yticks:U("yticks","",tt),xdisplay:U("xdisplay"),ydisplay:U("ydisplay"),ordered:Sr("ordered"),value:{attribute:function(t){this.value=t},get:function(){let t=M(this);return ze(t.state.value)},set:function(t){M(this).value.push(typeof t=="string"?Ue(t):Z(t))},enumerable:!0},data:{get:function(){let t=M(this);return rt(t.data)},set:function(t){M(this).values.push(Z(t))},enumerable:!0}};var Ri=window.xyInputStylesheet||import.meta.url.replace(/\/[^\/]*([?#].*)?$/,"/")+"shadow.css",Vl=oe("<xy-input>",Er,Pr,Ri);export{Vl as default};
