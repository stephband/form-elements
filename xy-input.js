/* form-elements 
   0.0.4
   By Stephen Band
   Built 2022-08-02 15:38 */

var ge=Object.getOwnPropertySymbols;var Hn=Object.prototype.hasOwnProperty,Gn=Object.prototype.propertyIsEnumerable;var ye=(t,e)=>{var i={};for(var o in t)Hn.call(t,o)&&e.indexOf(o)<0&&(i[o]=t[o]);if(t!=null&&ge)for(var o of ge(t))e.indexOf(o)<0&&Gn.call(t,o)&&(i[o]=t[o]);return i};function x(t){return t}function w(t,e){return function(){let o=t.apply(this,arguments),r=e[o]||e.default;if(!r)throw new Error('overload() no handler for "'+o+'"');return r.apply(this,arguments)}}function ft(t){var e=new Map;return function(o){if(e.has(o))return e.get(o);var r=t(o);return e.set(o,r),r}}var In=Array.prototype;function jn(t,e){return typeof t=="function"?t.apply(null,e):t}function ve(t,e,i){i=i||t.length;var o=i===1?e?t:ft(t):ft(function(r){return ve(function(){var s=[r];return s.push.apply(s,arguments),t.apply(null,s)},e,i-1)});return function r(s){return arguments.length===0?r:arguments.length===1?o(s):arguments.length>=i?t.apply(null,arguments):jn(o(s),In.slice.call(arguments,1))}}var T=ve;function g(){}var Wn=w(x,{is:g,tag:g,html:function(t,e,i){e.innerHTML=i},text:function(t,e,i){e.textContent=i},children:function(t,e,i){e.innerHTML="",e.append.apply(e,i)},points:N,cx:N,cy:N,r:N,preserveAspectRatio:N,viewBox:N,default:function(t,e,i){t in e?e[t]=i:e.setAttribute(t,i)}});function N(t,e,i){e.setAttribute(t,i)}function zn(t,e){for(var i=Object.keys(e),o=i.length;o--;)Wn(i[o],t,e[i[o]]);return t}var ht=T(zn,!0);var Ft="http://www.w3.org/2000/svg",Te=document.createElement("div"),Vt=(t,e)=>e&&typeof e;function be(t,e){let i=document.createRange();return i.selectNode(t),i.createContextualFragment(e)}var P=w(Vt,{string:function(t,e){let i=document.createElementNS(Ft,t);return i.innerHTML=e,i},object:function(t,e){let i=document.createElementNS(Ft,t);return typeof e.length=="number"?i.append.apply(i,e):ht(i,e),i},default:t=>document.createElementNS(Ft,t)}),Un=w(Vt,{string:function(t,e){let i=document.createElement(t);return i.innerHTML=e,i},object:function(t,e){let i=document.createElement(t);return typeof e.length=="number"?i.append.apply(i,e):ht(i,e),i},default:t=>document.createElement(t)}),Nn=w(x,{comment:function(t,e){return document.createComment(e||"")},fragment:w(Vt,{string:function(t,e,i){if(i)return be(i,e);let o=document.createDocumentFragment();Te.innerHTML=e;let r=Te.childNodes;for(;r[0];)o.appendChild(r[0]);return o},object:function(t,e,i){let o=i?be(i):document.createDocumentFragment();return typeof e.length=="number"?o.append.apply(o,e):ht(o,e),o},default:()=>document.createDocumentFragment()}),text:function(t,e){return document.createTextNode(e||"")},circle:P,ellipse:P,g:P,glyph:P,image:P,line:P,rect:P,use:P,path:P,pattern:P,polygon:P,polyline:P,svg:P,default:Un}),B=Nn;function Dt(t,e,i){let o;typeof i!="string"&&i.input!==void 0&&i.index!==void 0&&(o=i,i=o.input.slice(i.index+i[0].length+(i.consumed||0)));let r=t.exec(i);if(!r)return;let s=e(r);return o&&(o.consumed=(o.consumed||0)+r.index+r[0].length+(r.consumed||0)),s}var No=T(Dt,!0);function Yn(t,e,i){throw i.input!==void 0&&i.index!==void 0&&(i=i.input),new Error('Cannot parse string "'+(i.length>128?i.length.slice(0,128)+"…":i)+'"')}function Xn(t,e,i){let o=-1;for(;++o<i.length;)e=i[o]!==void 0&&t[o]?t[o](e,i):e;return t.done?t.done(e,i):t.close?t.close(e,i):e}function qn(t,e,i,o){let r=Dt(t,s=>Xn(e,i,s),o);return r===void 0?e.catch?e.catch(i,o):Yn(t,e,o):r}var Ee=T(qn,!0);var _t=g;var k=Symbol("internals"),j=Symbol("shadow"),Se=Object.defineProperties,$n={a:HTMLAnchorElement,dl:HTMLDListElement,p:HTMLParagraphElement,br:HTMLBRElement,fieldset:HTMLFieldSetElement,hr:HTMLHRElement,img:HTMLImageElement,li:HTMLLIElement,ol:HTMLOListElement,optgroup:HTMLOptGroupElement,q:HTMLQuoteElement,textarea:HTMLTextAreaElement,td:HTMLTableCellElement,th:HTMLTableCellElement,tr:HTMLTableRowElement,tbody:HTMLTableSectionElement,thead:HTMLTableSectionElement,tfoot:HTMLTableSectionElement,ul:HTMLUListElement},Kn={name:{set:function(t){return this.setAttribute("name",t)},get:function(){return this.getAttribute("name")||""}},form:{get:function(){return this[k].form}},labels:{get:function(){return this[k].labels}},validity:{get:function(){return this[k].validity}},validationMessage:{get:function(){return this[k].validationMessage}},willValidate:{get:function(){return this[k].willValidate}},checkValidity:{value:function(){return this[k].checkValidity()}},reportValidity:{value:function(){return this[k].reportValidity()}}},Jn={},Ae={once:!0},Qn=0,Pe=!1;function Zn(t){return $n[t]||window["HTML"+t[0].toUpperCase()+t.slice(1)+"Element"]||(()=>{throw new Error('Constructor not found for tag "'+t+'"')})()}var ti=Ee(/^\s*<?([a-z][\w]*-[\w]+)>?\s*$|^\s*<?([a-z][\w]*)\s+is=["']?([a-z][\w]*-[\w]+)["']?>?\s*$/,{1:(t,e)=>({name:e[1]}),2:(t,e)=>({name:e[3],tag:e[2]}),catch:function(t,e){throw new SyntaxError(`dom element() – name must be of the form 'element-name' or 'tag is="element-name"' (`+e+")")}},null);function ei(t,e){if(t.hasOwnProperty(e)){let i=t[e];delete t[e],t[e]=i}return t}function ni(t,e,i){t._initialLoad=!0;let o=t.attachShadow({mode:e.mode||"closed",delegatesFocus:e.focusable||!1});if(i){let r=B("link",{rel:"stylesheet",href:i});o.append(r)}return t[j]=o,o}function ii(t){var e;if(t.attachInternals){if(e=t.attachInternals(),e.setFormValue)return e}else e={shadowRoot:t.shadowRoot};return e.input=B("input",{type:"hidden",name:t.name}),t.appendChild(e.input),e.setFormValue=function(i){this.input.value=i},e}function oi(t){t._initialAttributes={},t._n=0}function ri(t,e,i){let o=t._initialAttributes;for(;t._n<e.length&&o[e[t._n]]!==void 0;)i[e[t._n]].call(t,o[e[t._n]]),++t._n}function ke(t,e,i){if(!t._initialAttributes)return;let o=t._initialAttributes;for(;t._n<e.length;)o[e[t._n]]!==void 0&&i[e[t._n]]&&i[e[t._n]].call(t,o[e[t._n]]),++t._n;delete t._initialAttributes,delete t._n}function si(t){return!!t.attribute}function ui(t){return t.set||t.get||t.hasOwnProperty("value")}function xe(t,e){return si(e[1])&&(t.attributes[e[0]]=e[1].attribute),ui(e[1])&&(t.properties[e[0]]=e[1]),t}function Rt(t,e,i,o){let{name:r,tag:s}=ti(t),a=typeof s=="string"?Zn(s):HTMLElement,{attributes:p,properties:l}=i?Object.entries(i).reduce(xe,{attributes:{},properties:{}}):e.properties?Object.entries(e.properties).reduce(xe,{attributes:{},properties:{}}):Jn;function h(){let f=Reflect.construct(a,arguments,h),m=e.construct&&e.construct.length>Qn?ni(f,e,o||e.stylesheet):void 0,u=h.formAssociated&&ii(f);return s&&(Pe=!0),e.construct&&e.construct.call(f,m,u),p&&(oi(f),Promise.resolve(1).then(function(){ke(f,h.observedAttributes,p)})),l&&Object.keys(l).reduce(ei,f),f}return h.prototype=Object.create(a.prototype,l),l&&l.value&&(h.formAssociated=!0,Se(h.prototype,Kn),(e.enable||e.disable)&&(h.prototype.formDisabledCallback=function(f){return f?e.disable&&e.disable.call(this,this[j],this[k]):e.enable&&e.enable.call(this,this[j],this[k])}),e.reset&&(h.prototype.formResetCallback=function(){return e.reset.call(this,this[j],this[k])}),e.restore&&(h.prototype.formStateRestoreCallback=function(){return e.restore.call(this,this[j],this[k])})),p&&(h.observedAttributes=Object.keys(p),h.prototype.attributeChangedCallback=function(f,m,u){if(!this._initialAttributes)return p[f].call(this,u);this._initialAttributes[f]=u,ri(this,h.observedAttributes,p)}),h.prototype.connectedCallback=function(){let f=this,m=f[j],u=f[k];if(f._initialAttributes&&ke(f,h.observedAttributes,p),f._initialLoad){let d=m.querySelectorAll('link[rel="stylesheet"]');if(d.length){let A=0,b=d.length,at=function(pt){++A>=d.length&&(delete f._initialLoad,e.load&&(_t("element()","loaded",Array.from(d).map(ct=>ct.href).join(`
`)),e.load.call(f,m)))},lt=at;for(;b--;)d[b].addEventListener("load",at,Ae),d[b].addEventListener("error",lt,Ae);e.connect&&e.connect.call(this,m,u)}else e.connect&&e.connect.call(this,m,u),e.load&&e.load.call(this,m,u)}else e.connect&&e.connect.call(this,m,u)},e.disconnect&&(h.prototype.disconnectedCallback=function(){return e.disconnect.call(this,this[j],this[k])}),_t("element()","<"+(s?s+" is="+r:r)+">"),window.customElements.define(r,h,s&&{extends:s}),s&&!Pe&&document.querySelectorAll('[is="'+r+'"]').forEach(f=>{i&&Se(f,i),e.construct&&e.construct.apply(f);let m;for(m in p){let u=f.attributes[m];u&&p[m].call(f,u.value)}e.connect&&e.connect.apply(f)}),h}var Ht=Symbol("privates");function L(t){return t[Ht]||Object.defineProperty(t,Ht,{value:{}})[Ht]}function q(t,e,i){return i>e?e:i<t?t:i}var or=T(q);var ai=Object.freeze;function Be(){return this}var _=ai({shift:g,push:g,forEach:g,join:function(){return""},map:Be,filter:Be,includes:function(){return!1},reduce:function(t,e){return e},length:0,each:g,pipe:x,start:g,stop:g,done:g,valueOf:function(){return null}});function Gt(){return this}function $(t,e){t.remove&&t.remove(e);let i;for(;(i=t.indexOf(e))!==-1;)t.splice(i,1);return e}var cr=T($,!0);function It(t){return t&&t[Symbol.iterator]}var li=Object.assign;function pi(t){return t.stop?t.stop():t()}function K(){}li(K.prototype,{stop:function(){let t=this.stopables;return this.stopables=void 0,t&&t.forEach(pi),this},done:function(t){return(this.stopables||(this.stopables=[])).push(t),this}});var M=Object.assign,R=Object.create;function J(t,e){t[0]=e,e.done(t)}function Le(t,e){let i=t[e].stopables;i&&$(i,t),t[e]=void 0}function y(t,e){t&&t.push(e)}function E(t){K.prototype.stop.apply(t);let e=-1,i;for(;i=t[++e];)t[e]=void 0,i.stop()}function c(t){this.input=t}M(c.prototype,K.prototype,{push:function(t){y(this[0],t)},pipe:function(t){if(this[0])throw new Error("Stream: Attempt to .pipe() a unicast stream multiple times. Create a multicast stream with stream.broadcast().");return this[0]=t,t.done(this),this.input.pipe(this),t},map:function(t){return new Ce(this,t)},filter:function(t){return new Oe(this,t)},split:function(t){return new Fe(this,t)},flatMap:function(t){return new Me(this,t)},take:function(t){return new Ve(this,t)},each:function(t){return this.pipe(new Re(t))},reduce:function(t,e){return this.pipe(new De(t,e)).value},scan:function(t,e){return new _e(this,t,e)},stop:function(){return E(this),this}});function Ce(t,e){this.input=t,this.fn=e}Ce.prototype=M(R(c.prototype),{push:function(e){let o=this.fn(e);o!==void 0&&y(this[0],o)}});function Oe(t,e){this.input=t,this.fn=e}Oe.prototype=M(R(c.prototype),{push:function(e){this.fn(e)&&y(this[0],e)}});function Me(t,e){this.input=t,this.fn=e}Me.prototype=M(R(c.prototype),{push:function(e){let o=this.fn(e);if(o!==void 0)if(It(o))for(let r of o)y(this[0],r);else throw new Error("Stream: Cannot .flatMap() non-iterable values")}});function Fe(t,e){this.input=t,this.chunk=[],typeof n=="number"?this.n=e:this.fn=e}Fe.prototype=M(R(c.prototype),{fn:function(){return this.chunk.length===this.n},push:function(e){let i=this.chunk;this.fn(e)?(y(this[0],i),this.chunk=[]):i.push(e)}});function Ve(t,e){this.input=t,this.count=e}Ve.prototype=M(R(c.prototype),{push:function(e){this[0].push(e),--this.count||this.stop()}});var ci=0;function De(t,e){this.fn=t,this.value=e,this.i=0,this.n=++ci}De.prototype=M(R(c.prototype),{push:function(t){let e=this.fn;this.value=e(this.value,t,this.i++,this)}});function _e(t,e,i){this.input=t,this.fn=e,this.value=i}_e.prototype=M(R(c.prototype),{push:function(t){let e=this.fn;this.value=e(this.value,t),this[0].push(this.value)}});function Re(t){this.push=t}Re.prototype=M(R(c.prototype),{each:null,reduce:null,pipe:null});var fi=Object.assign,hi=Object.create;function mi(t,e){if(t[1]){let i=-1;for(;t[++i]&&t[i]!==e;);for(;t[i++];)t[i-1]=t[i]}else t.stop()}function Q(t,e){c.apply(this,arguments),this.memory=!!(e&&e.memory),e&&e.hot&&this.pipe(_)}Q.prototype=fi(hi(c.prototype),{push:function(t){if(t===void 0)return;this.memory&&(this.value=t);let e=-1;for(;this[++e];)this[e].push(t)},pipe:function(t){let e=-1;for(;this[++e];);return this.memory&&e===0&&this.input.pipe(this),this[e]=t,t.done(()=>mi(this,t)),this.value!==void 0&&t.push(this.value),!this.memory&&e===0&&this.input.pipe(this),t}});var di=Array.prototype,wi=Object.assign,gi=Object.create;function yi(t){return t!==void 0}function Z(t){this.buffer=t?t.filter?t.filter(yi):t:[]}Z.prototype=wi(gi(c.prototype),{push:function(t){t!==void 0&&y(this.buffer,t)},pipe:function(t){for(t.done(this),this[0]=t;this.buffer.length;)y(this[0],di.shift.apply(this.buffer));return this.buffer=t,t},stop:function(){return this.buffer=void 0,E(this),this}});var He=Object.assign,vi=Object.create,Ti=Promise.resolve(),bi={schedule:function(){Ti.then(this.fire)},unschedule:g},Ei={schedule:function(){this.timer=requestAnimationFrame(this.fire)},unschedule:function(){cancelAnimationFrame(this.timer),this.timer=void 0}},Si={schedule:function(){this.timer=setTimeout(this.fire,this.duration*1e3)},unschedule:function(){clearTimeout(this.timer),this.timer=void 0}};function W(t,e){c.apply(this,arguments),this.duration=e,this.timer=void 0,this.fire=()=>{this.timer=void 0,this.output.stop()},He(this,e==="tick"?bi:e==="frame"?Ei:Si)}W.prototype=He(vi(c.prototype),{push:function(t){this.timer?(this.unschedule(),this.schedule(),this.output.push(t)):(this.output=c.of(t),this[0].push(this.output),this.schedule())},stop:function(){return this.timer&&this.fire(),c.prototype.stop.apply(this,arguments)}});var jt=Object.assign,Ai=Object.create,Ge=Object.keys;function Wt(t,e,i,o,r){this.stream=t,this.names=e,this.values=i,this.name=o,this.input=r}jt(Wt.prototype,{push:function(t){let e=this.stream,i=this.values,o=this.name;i[o]=t,(e.active||(e.active=Ge(i).length===this.names.length))&&y(e[0],jt({},i))},stop:function(){--this.stream.count===0&&E(this.stream)},done:function(t){this.stream.done(t)}});function mt(t){this.inputs=t,this.active=!1}mt.prototype=jt(Ai(c.prototype),{push:null,pipe:function(t){let e=this.inputs,i=Ge(e),o={};this.count=i.length,this[0]=t,t.done(this);let r;for(r in e){let s=e[r];if(s.pipe){let a=new Wt(this,i,o,r,s);s.pipe(a)}else if(s.then){let a=new Wt(this,i,o,r,s);s.then(p=>a.push(p)),s.finally(()=>a.stop())}else o[r]=s,--this.count}return t}});var Ie=Object.assign,Pi=Object.create;function je(t){this.stream=t}Ie(je.prototype,{push:function(t){y(this.stream[0],t)},stop:function(){--this.stream.count===0&&E(this.stream)},done:function(t){this.stream.done(t)}});function dt(t){this.inputs=t}dt.prototype=Ie(Pi(c.prototype),{push:null,pipe:function(t){let e=this.inputs;this.count=e.length,this[0]=t,t.done(this);let i=new je(this),o=-1,r;for(;r=e[++o];)if(r.pipe)r.pipe(i);else if(r.then)r.then(s=>i.push(s)),r.finally(()=>i.stop());else{let s=-1;for(;++s<r.length;)i.push(r[s]);i.stop()}return t}});var ki=Object.assign,xi=Object.create;function wt(t){this.promise=t}wt.prototype=ki(xi(c.prototype),{push:null,pipe:function(t){let e=this.promise;return this[0]=t,t.done(this),e.then(i=>y(this,i)),e.finally(()=>E(this)),t}});var Bi=Array.prototype,We=Object.assign;function Li(t){throw new TypeError("Stream cannot be created from "+typeof object)}We(c,{of:function(){return new Z(Bi.slice.apply(arguments))},from:function(t){return t.pipe?new c(t):t.then?new wt(t):typeof t.length=="number"?new Z(t):Li(t)},batch:t=>new W(_,t),burst:t=>(console.warn("Stream.burst() is now Stream.batch()"),new W(_,t)),broadcast:t=>new Q(_,t),combine:t=>new mt(t),merge:function(){return new dt(arguments)}});We(c.prototype,{log:Gt,batch:function(t){return new W(this,t)},burst:function(t){return console.warn("stream.burst() is now stream.batch()"),new W(this,t)},broadcast:function(t){return new Q(this,t)}});function zt(t){if(typeof t!="object"||arguments.length>1)throw new Error("delegate() now takes an object of selector:fn pairs.");let e=Object.keys(t);return function(o){let r=o.target,s=-1;for(;e[++s];){let a=r.closest(e[s]);if(a)return t[e[s]](a,...arguments)}}}var Ci=Object.assign,Oi=/\s+/,ze={fullscreenchange:"fullscreenElement"in document?"fullscreenchange":"webkitFullscreenElement"in document?"webkitfullscreenchange":"fullscreenchange"};var Ue=0;window.addEventListener("click",t=>Ue=t.timeStamp);function Mi(t,e){return t.node.addEventListener(ze[e]||e,t,t.options),t}function Fi(t,e){return t.node.removeEventListener(ze[e]||e,t),t}function Ne(t,e,i){this.types=t.split(Oi),this.options=e,this.node=i,this.select=e&&e.select}Ci(Ne.prototype,{pipe:function(t){J(this,t),this.types.reduce(Mi,this)},handleEvent:function(t){if(!(t.type==="click"&&t.timeStamp<=Ue)){if(this.select){let e=t.target.closest(this.select);if(!e)return;t.selectedTarget=e}y(this[0],t)}},stop:function(){this.types.reduce(Fi,this),E(this[0])}});function Ut(t,e){let i;return typeof t=="object"&&(i=t,t=i.type),new c(new Ne(t,i,e))}var Vi=Object.assign,tt={bubbles:!0,cancelable:!0};function gt(t,e){var h;let i=tt,o,r,s,a,p,l;return typeof t=="object"?(h=t,{type:t,detail:r,bubbles:s,cancelable:a,composed:p}=h,o=ye(h,["type","detail","bubbles","cancelable","composed"]),l=Vi(new CustomEvent(t,{detail:r,bubbles:s||tt.bubbles,cancelable:a||tt.cancelable,composed:p||tt.composed}),o)):l=new CustomEvent(t,tt),e.dispatchEvent(l)}var $r=T(gt,!0);function Nt(t){return Math.pow(2,t/6)}function C(t){if(!t)return 0;let e=+t;if(e||e===0)return e;let i=/^(?:(-?[\d.]+)|(-?∞))(?:(db|bpm)|(m|k)?(\w+))$/.exec(t.toLowerCase());if(!i)return 0;let o=i[2]?i[2]==="-∞"?-1/0:1/0:parseFloat(i[1]);return i[3]==="db"?Nt(o):i[3]==="bpm"?o/60:i[4]==="m"?o/1e3:i[4]==="k"?o*1e3:o}function Di(t,e){let i=t[t.length-1];return i&&!/^-?\d/.test(e)?i.label=e:t.push({label:e,value:C(e)}),t}function H(t){let e=t.trim();return e?e.split(/\s*,\s*|\s+/).reduce(Di,[]):null}var Ye=w(t=>t.toLowerCase(),{db:(t,e,i)=>H("-∞dB -96dB -90dB -84dB -78dB -72dB -66dB -60dB -54dB -48dB -42dB -36dB -30dB -24dB -18dB -12dB -6dB 0dB 6dB 12dB 18dB 24dB"),default:(t,e,i)=>[{label:"0",value:0},{label:"1",value:1}]});function Xe(t,e,i,o){return t.normalValue=e.normalise(i,o,t.value),t}function Yt(t,e){let{scale:i,min:o,max:r,ticks:s,step:a,display:p}=e;return t.scale=i,t.min=o,t.max=r,t.ticks=(s||(p?Ye(p,o,r):_)).filter(l=>l.value>=t.min&&l.value<=t.max).map(l=>Xe(l,i,o,r)),t.step=a==="any"?void 0:a==="tick"?t.ticks:H(a).filter(l=>l.value>=t.min&&l.value<=t.max).map(l=>Xe(l,i,o,r)),t.display=p,t}var qe=.00390625;var $e=.0009765625,Ke=.00048828125,Je=.000244140625;var Qe=1525878906e-14,Xt=.25,Ze=.4,tn=Symbol("state");var en=Object.assign,vt={};function qt(t,e,i){let o=i/(e*t);return(o<=1?o:Math.log(o)+1)/vt[t]}function Gi(t,e,i){let o=i*vt[t];return e*t*(o<=1?o:Math.pow(Math.E,o-1))}function F(t){this.xover=t,vt[t]||(vt[t]=Math.log(1/t)+1)}en(F.prototype,{normalise:function(t,e,i){let o=qt(this.xover,e,t);return(qt(this.xover,e,i)-o)/(1-o)},denormalise:function(t,e,i){let o=qt(this.xover,e,t),r=i*(1-o)+o;return Gi(this.xover,e,r)}});function yt(t){this.power=t}en(yt.prototype,{normalise:function(t,e,i){return Math.pow((i-t)/(e-t),1/this.power)},denormalise:function(t,e,i){return Math.pow(i,this.power)*(e-t)+t}});var Ii={linear:{normalise:function(t,e,i){return(i-t)/(e-t)},denormalise:function(t,e,i){return t+i*(e-t)}},"pow-2":new yt(2),"pow-3":new yt(3),"pow-4":new yt(4),log:{normalise:function(t,e,i){return Math.log(i/t)/Math.log(e/t)},denormalise:function(t,e,i){return t*Math.pow(e/t,i)}},"log-24db":new F(.0625),"log-30db":new F(.03125),"log-36db":new F(.015625),"log-48db":new F(qe),"log-60db":new F($e),"log-66db":new F(Ke),"log-72db":new F(Je),"log-96db":new F(Qe)};function $t(t){return Ii[t&&t.toLowerCase()||"linear"]}var ji=.9965784284662086;function Kt(t){return 20*Math.log10(t)*ji}function nn(t,e){return{unit:e<1?"m"+t:e>=1e3?"k"+t:t,value:e<.001?(e*1e3).toFixed(2):e<1?(e*1e3).toPrecision(3):e>=1e3?(e/1e3).toPrecision(3):e.toPrecision(3)}}var vs=w(t=>t.toLowerCase(),{pan:(t,e)=>({unit:"",value:e===-1?"-1.00":e===0?"0.00":e===1?"1.00":e.toFixed(2)}),db:(t,e)=>{let i=Kt(e);return{unit:"dB",value:isFinite(i)?i<-1?i.toPrecision(3):i.toFixed(2):i<0?"-∞":"∞"}},hz:(t,e)=>({unit:e>=1e3?"kHz":"Hz",value:e<1?e.toFixed(2):e>=1e3?(e/1e3).toPrecision(3):e.toPrecision(3)}),semitone:(t,e)=>({unit:"",value:e===0?"0":e<0?"♭"+(-e/100).toFixed(2):"♯"+(e/100).toFixed(2)}),s:nn,bpm:(t,e)=>{let i=e*60;return{unit:"bpm",value:i<100?i.toFixed(1):i.toFixed(0)}},int:(t,e)=>({unit:"",value:Math.round(e)}),"":(t,e)=>({unit:"",value:e>-1&&e<1?e.toFixed(2):e.toPrecision(3)}),default:nn});function Wi(t,e){return e[t]}var V=T(Wi,!0);function z(t){if(typeof t.length=="number")return t[t.length-1]}var zi=Object.assign,Ui=Object.defineProperties,Ni=Object.isExtensible,Yi=Object.prototype,U=Symbol("observe");function Xi(t,e){let i=t.indexOf(e);return i>-1&&t.splice(i,1),t}var on={[U]:{}};function Tt(t,e){if(!t||!t.length)return 0;t=t.slice(0);for(var i=-1;t[++i];)t[i].push(e);return i}function rn(t){this.observables={},this.gets=[],this.sets=void 0,this.target=t,this.observer=new Proxy(t,this),on[U].value=this,Ui(t,on)}zi(rn.prototype,{notify:function(t){Tt(this.observables[t],this.target[t]),Tt(this.sets,this.target)},listen:function(t,e){(t===null?this.sets||(this.sets=[]):this.observables[t]||(this.observables[t]=[])).push(e)},unlisten:function(t,e){let i=t===null?this.sets:this.observables[t];i&&Xi(i,e)},get:function(e,i,o){let r=e[i];if(typeof i=="symbol"||i==="__proto__")return r;let s=Object.getOwnPropertyDescriptor(e,i);if((s?s.writable||s.set:r===void 0)&&Tt(this.gets,i),!Yi.hasOwnProperty.call(e,i))return r;let p=et(r);if(!p)return r;for(var l=-1;this.gets[++l];)this.gets[l].listen(i);return p},set:function(e,i,o,r){if(typeof i=="symbol"||i==="__proto__")return e[i]=o,!0;if(o=Jt(o),e[i]===o)return!0;let s=e.length;for(var a=-1;this.gets[++a];)this.gets[a].unlisten(i);return e[i]=o,i!=="length"&&e.length!==s&&Tt(this.observables.length,e.length),this.notify(i),!0},deleteProperty:function(t,e){return typeof e=="symbol"||e==="__proto__"?(delete t[e],!0):(t.hasOwnProperty(e)&&(delete t[e],this.notify(e)),!0)}});function qi(t){return t&&Ni(t)&&!Node.prototype.isPrototypeOf(t)&&(typeof BaseAudioContext>"u"||!BaseAudioContext.prototype.isPrototypeOf(t))&&!(t instanceof Date)&&!(t instanceof RegExp)&&!(t instanceof Map)&&!(t instanceof WeakMap)&&!(t instanceof Set)&&!(window.WeakSet&&t instanceof WeakSet)&&!ArrayBuffer.isView(t)}function et(t){return t?t[U]?t[U].observer:qi(t)?new rn(t).observer:void 0:void 0}function Jt(t){return t&&t[U]&&t[U].target||t}function sn(t,e){let i=e[U];i&&i.notify(t)}function Qt(t){return typeof t}var $i=/^\s*([+-]?\d*\.?\d+)([^\s\d]*)\s*$/;function Zt(t){return function(i){if(typeof i=="number")return i;var o=$i.exec(i);if(!o||!t[o[2]||""]){if(!t.catch)throw new Error('Cannot parse value "'+i+'" (accepted units '+Object.keys(t).join(", ")+")");return o?t.catch(parseFloat(o[1]),o[2]):t.catch(parseFloat(i))}return t[o[2]||""](parseFloat(o[1]))}}var Ki=/px$/,un={"transform:translateX":function(t){var e=nt("transform",t);if(!e||e==="none")return 0;var i=bt(e);return parseFloat(i[4])},"transform:translateY":function(t){var e=nt("transform",t);if(!e||e==="none")return 0;var i=bt(e);return parseFloat(i[5])},"transform:scale":function(t){var e=nt("transform",t);if(!e||e==="none")return 0;var i=bt(e),o=parseFloat(i[0]),r=parseFloat(i[1]);return Math.sqrt(o*o+r*r)},"transform:rotate":function(t){var e=nt("transform",t);if(!e||e==="none")return 0;var i=bt(e),o=parseFloat(i[0]),r=parseFloat(i[1]);return Math.atan2(r,o)}};function bt(t){return t.split("(")[1].split(")")[0].split(/\s*,\s*/)}function nt(t,e){return window.getComputedStyle?window.getComputedStyle(e,null).getPropertyValue(t):0}function Et(t,e){if(un[t])return un[t](e);var i=nt(t,e);return typeof i=="string"&&Ki.test(i)?parseFloat(i):i}var St,At;function Ji(){if(!St){let t=document.documentElement.style.fontSize;document.documentElement.style.fontSize="100%",St=Et("font-size",document.documentElement),document.documentElement.style.fontSize=t||""}return St}function Qi(){return At||(At=Et("font-size",document.documentElement)),At}window.addEventListener("resize",()=>{St=void 0,At=void 0});var O=w(Qt,{number:x,string:Zt({px:x,em:t=>Ji()*t,rem:t=>Qi()*t,vw:t=>window.innerWidth*t/100,vh:t=>window.innerHeight*t/100,vmin:t=>window.innerWidth<window.innerHeight?window.innerWidth*t/100:window.innerHeight*t/100,vmax:t=>window.innerWidth<window.innerHeight?window.innerHeight*t/100:window.innerWidth*t/100})}),an=O;var Zi=Array.prototype,ee=Object.assign,te="webkitUserSelect"in document.body.style?"webkitUserSelect":"userSelect",Pt={threshold:4,ignoreTags:{textarea:!0,input:!0,select:!0}};function to(t,e,i){return e*e+i*i>=t*t}function ln(t,e,i){if(this.stream=t,this.events=e,this.options=i,this.pointerId=e[0].pointerId,typeof i.threshold=="function")this.checkThreshold=i.threshold;else{let o=an(i.threshold);this.checkThreshold=(r,s)=>to(o,r,s)}document.addEventListener("pointermove",this),document.addEventListener("pointerup",this),document.addEventListener("pointercancel",this)}ee(ln.prototype,{handleEvent:w(V("type"),{pointermove:function(t){if(this.pointerId!==t.pointerId){console.log("Not the same pointer");return}if(this.events.push(t),!this.isGesture){let e=this.events[0],i=t.clientX-e.clientX,o=t.clientY-e.clientY,r=(t.timeStamp-e.timeStamp)/1e3;this.checkThreshold(i,o,r)&&this.createGesture()}},default:function(t){if(this.pointerId!==t.pointerId){console.log("Not the same pointer");return}this.events.push(t),this.stop()}}),createGesture:function(){this.isGesture=!0,this.userSelectState=document.body.style[te],document.body.style[te]="none",this.stream.push(new c(this))},pipe:function(t){for(J(this,t);this.events.length;)y(this[0],Zi.shift.apply(this.events));this.events=t},stop:function(){if(document.removeEventListener("pointermove",this),document.removeEventListener("pointerup",this),document.removeEventListener("pointercancel",this),this.isGesture&&(document.body.style[te]=this.userSelectState),this[0]){let t=this[0];Le(this,0),E(t)}}});function eo(t){var e=t.target.tagName;return e&&(!!Pt.ignoreTags[e.toLowerCase()]||t.target.draggable)}function pn(t,e){this.node=t,this.options=e}ee(pn.prototype,{pipe:function(t){return this[0]=t,this.node.addEventListener("pointerdown",this),t},handleEvent:function(t){if(t.button===0&&!(this.options.device&&!this.options.device.includes(t.pointerType))&&!eo(t)&&!(this.options.select&&!t.target.closest(this.options.select))){var e={type:t.type,target:t.target,currentTarget:t.currentTarget,clientX:t.clientX,clientY:t.clientY,timeStamp:t.timeStamp,pointerId:t.pointerId};new ln(this[0],[e],this.options)}},stop:function(){return this[0]&&(this.node.removeEventListener("pointerdown",this),E(this[0])),this}});function ne(t,e){return t=e&&t?ee({},Pt,t):Pt,e=e||t,new c(new pn(e,t))}function no(){return{x:0,y:0,left:0,top:0,right:window.innerWidth,bottom:window.innerHeight,width:window.innerWidth,height:window.innerHeight}}function kt(t){return t===window?no():t.getClientRects()[0]||t.getBoundingClientRect()}function cn(t,e,i,o){return e.delete(i),o.forEach(r=>e.append(i,r.x+","+r.y)),t.setFormValue(e),e}function fn(t,e){t.clearRect(e.x,e.y,e.width,e.height)}function hn(t,e,i,o){t.lineWidth="1",t.lineCap="round",t.strokeStyle=o,t.beginPath();let r=-1;for(;++r<i.length;)t.moveTo(e.x+i[r]*e.width,e.y),t.lineTo(e.x+i[r]*e.width,e.y+e.height);t.stroke(),t.closePath()}function mn(t,e,i,o){t.lineWidth="1",t.lineCap="round",t.strokeStyle=o,t.beginPath();let r=-1;for(;++r<i.length;)t.moveTo(e.x,e.y+(1-i[r])*e.height),t.lineTo(e.x+e.width,e.y+(1-i[r])*e.height);t.stroke(),t.closePath()}function io(t,e,i){let o=t(e),r=t(i);return r===o?0:o>r?1:-1}var ie=T(io,!0);var Y=function(){};function dn(t,e){return e.length<t?e:e.slice(0,t-3)+"..."}var oe=window.console?console.log.bind(console,"%cSoundstage %c%s","color: #e02053; font-weight: 600;","color: #8e9e9d; font-weight: 300;"):Y,Qs=window.console?console.groupCollapsed.bind(console,"%cSoundstage %c%s","color: #e02053; font-weight: 600;","color: #8e9e9d; font-weight: 300;"):Y,Zs=window.console?console.groupEnd.bind(console):Y,re=window.console?function(t,e,i="",...o){typeof i=="string"&&(i=dn(48,i)),console.log("%c"+t+" %c"+(e||""),"color: #b5002f; font-weight: 600;","color: #8e9e9d; font-weight: 300;",i,...o)}:Y,it=window.console?function(t,e,i="",...o){typeof i=="string"&&(i=dn(48,i)),console.groupCollapsed("%c"+t+" %c"+(e||""),"color: #b5002f; font-weight: 600;","color: #8e9e9d; font-weight: 300;",i,...o)}:Y,ot=window.console?console.groupEnd.bind(console):Y;var xt=!1,oo=Object.assign,wn=Object.defineProperties,ro={startTime:{writable:!0},stopTime:{writable:!0}};function D(){xt&&it("mixin ","PlayNode"),wn(this,ro),xt&&ot()}D.reset=function(t){return t.startTime=void 0,t.stopTime=void 0,t};oo(D.prototype,{start:function(t){if(xt&&this.startTime!==void 0)throw new Error("Attempt to start a node that is already started");return this.startTime=t||this.context.currentTime,this},stop:function(t){if(xt&&this.startTime===void 0)throw new Error("Attempt to stop a node that has not been started");return t=t||this.context.currentTime,this.stopTime=this.startTime===void 0||t>this.startTime?t:this.startTime,this}});wn(D.prototype,{playing:{get:function(){return this.startTime!==void 0&&this.startTime<=this.context.currentTime&&(this.stopTime===void 0||this.startTime>this.stopTime||this.context.currentTime<this.stopTime)}}});function se(t){return function(i,...o){var r=t[i]||t.default;return r&&r.apply(this,o)}}window.AudioContext=window.AudioContext||window.webkitAudioContext;AudioContext.prototype.getOutputTimestamp||(AudioContext.prototype.getOutputTimestamp=function(){return{contextTime:this.currentTime+this.outputLatency,performanceTime:window.performance.now()}});var G=new window.AudioContext;G.destination.channelInterpretation="discrete";G.destination.channelCount=G.destination.maxChannelCount;G.baseLatency===void 0&&(G.baseLatency=256/G.sampleRate);if(G.state==="suspended"){oe("Audio context suspended","User interaction required");let t=["mousedown","keydown","touchstart","contextmenu"],e=(o,r)=>(document.addEventListener(r,o),o),i=(o,r)=>(document.removeEventListener(r,o),o);t.reduce(e,function o(r){G.resume().then(function(){oe('Audio context resumed on "'+r.type+'"'),t.reduce(i,o)})})}function so(t,e){return t.contextTime+(e-t.performanceTime)/1e3}function ue(t,e){var i=t.getOutputTimestamp();return so(i,e)}var S={channelCountLimit:12,basePath:window.soundstageBasePath||"/soundstage/",automationEventsKey:"automationEvents",animationFrameKey:"animationFrame",minExponentialValue:14013e-49,targetDurationFactor:9};var Lt=!1,yn=1e3/60;function uo(t){return window.AudioParam&&window.AudioParam.prototype.isPrototypeOf(t)}function rt(t){if(Lt&&!uo(t))throw new Error("Not an AudioParam "+JSON.stringify(t));return t[S.automationEventsKey]||(t[S.automationEventsKey]=[])}var vn=w(V(1),{target:function(t){if(t[3]===void 0)throw new Error('Event "target" must have 2 parameters: [time, "target", value, duration]')},hold:function(t){if(t[2]!==void 0)throw new Error('Event "hold" takes 0 parameters: [time, "hold"]')},default:function(t){if(t[2]===void 0)throw new Error('Event "'+t[1]+'" must have 1 parameter: [time, "'+t[1]+'", value]')}});function gn(t,e){t.cancelScheduledValues(e.time),e.curve==="linear"?t.linearRampToValueAtTime(e.value,e.time):e.curve==="exponential"?t.exponentialRampToValueAtTime(e.value,e.time):e.curve==="step"&&t.setValueAtTime(e.value,e.time)}var ao={step:(t,e)=>t.setValueAtTime(e.value,e.time),linear:(t,e)=>t.linearRampToValueAtTime(e.value,e.time),exponential:(t,e)=>t.exponentialRampToValueAtTime(e.value,e.time),target:(t,e)=>t.setTargetAtTime(e.value,e.time,e.duration),curve:(t,e)=>t.setValueCurveAtTime(e.value,e.time,e.duration),hold:AudioParam.prototype.cancelAndHoldAtTime?function(e,i,o){if(o&&o.curve==="target")return gn(e,i);e.cancelAndHoldAtTime(i.time)}:gn},lo=w(x,{exponential:(t,e,i,o,r,s)=>{let a={time:r,value:Math.fround(s)};return a.value<=S.minExponentialValue?(a.time=i?i.time:0,a.curve="step"):i&&i.value<S.minExponentialValue?a.curve="step":a.curve="exponential",a},hold:function(t,e,i,o,r){return o&&o.curve==="linear"?{time:r,curve:"linear",value:Math.fround(ae(i,o,r))}:o&&o.curve==="exponential"?{time:r,curve:"exponential",value:Math.fround(ae(i,o,r))}:i&&i.curve==="target"?{time:r,curve:"step",value:st(e,r)}:{time:r}},target:(t,e,i,o,r,s,a)=>({time:r,curve:"target",value:Math.fround(s),duration:a}),default:(t,e,i,o,r,s,a)=>({time:r,curve:t,value:Math.fround(s)})}),po=se({hold:function(t,e,i,o){i.length=o+1,e.curve&&i.push(e)},default:function(t,e,i,o){if(!t){i.push(e);return}if(t.time===e.time){for(;i[++o]&&i[o].time===e.time;)if(i[o].curve===e.curve){i.splice(o,1,e);return}i.splice(o,0,e);return}i.splice(o+1,0,e)}});function Tn(t,e,i,o,r,s){for(var a=e.length;e[--a]&&e[a].time>=i;);let p=e[a],l=e[a+1],h=lo(o,t,p,l,i,r,s);ao[o](t,h,l),po(o,l,h,e,a)}function le(t,e,i,o,r,s,a){if(i==="target"&&r===void 0)throw new Error('Automation curve "target" must have a duration');let p=rt(t);if(Tn(t,p,e,i,o,r),!s){Lt&&console.warn("No notify for param change",o,i,t);return}if(!a){Lt&&console.warn("No context for param change",o,i,t);return}if(t[S.animationFrameId])return;var l=-1;function h(f){if(l=(l+1)%3,l===0){t[S.animationFrameId]=requestAnimationFrame(h);return}let m=f+yn,u=ue(a,m),d=st(t,u),A=p[p.length-1];t[S.animationFrameId]=A&&u<=A.time?requestAnimationFrame(h):void 0,s(t,"value",d)}t[S.animationFrameId]=requestAnimationFrame(h)}function bn(t,e,i,o,r,s,a){if(o==="target"&&s===void 0)throw new Error('Automation curve "target" must have a duration');let p=t[e],l=rt(p);if(Tn(p,l,i,o,r,s),!a){Lt&&console.warn("No notify for param change",r,o,p);return}if(p[S.animationFrameId])return;var h=-1;function f(m){if(h=(h+1)%3,h===0){p[S.animationFrameId]=requestAnimationFrame(f);return}let u=m+yn,d=ue(t.context,u),A=st(p,d),b=l[l.length-1];p[S.animationFrameId]=b&&d<=b.time?requestAnimationFrame(f):void 0,a(t,e,A)}p[S.animationFrameId]=requestAnimationFrame(f)}var En={step:function(e,i,o,r,s){return s<r?e:i},linear:function(e,i,o,r,s){return e+(i-e)*(s-o)/(r-o)},exponential:function(e,i,o,r,s){return e*Math.pow(i/e,(s-o)/(r-o))},target:function(e,i,o,r,s,a){return s<r?e:i+(e-i)*Math.pow(Math.E,(r-s)/a)},curve:function(t,e,i,o,r,s){}};function ae(t,e,i){return En[e.curve](t.value,e.value,t.time,e.time,i,t.duration)}function Bt(t,e,i){var o=t[e];return o.curve==="target"?En.target(Bt(t,e-1,o.time),o.value,0,o.time,i,o.duration):o.value}function co(t,e){for(var i=t.length;t[--i]&&t[i].time>=e;);var o=t[i],r=t[i+1];if(!o)return 0;if(!r)return Bt(t,i,e);if(r.time===e){for(;t[++i]&&t[i].time===e;);return Bt(t,i-1,e)}if(e<r.time)return r.curve==="linear"||r.curve==="exponential"?ae(o,r,e):Bt(t,i,e)}function st(t,e){var i=rt(t);return!i||i.length===0?t.value:Math.fround(co(i,e))}var X=!1;function pe(t,e,i,o){i&&i.setValueAtTime||(t[e]&&t[e].setValueAtTime?(X&&re("param",e+":",i),rt(t[e]).length=0,bn(t,e,t.context.currentTime,"step",i,null,o)):t[e]&&t[e].connect?fo(t[e],i):(X&&re("prop",e+" =",i),t[e]=i))}function fo(t,e,i,o){X&&it("assign",t.constructor.name,i?Object.keys(i).join(", "):"");let r={};if(i)for(let s in i)o&&o.indexOf(s)>-1||i[s]&&i[s].setValueAtTime||t.hasOwnProperty(s)&&i[s]!==void 0&&(pe(t,s,i[s]),r[s]=!0);for(let s in e)o&&o.indexOf(s)>-1||r[s]||pe(t,s,e[s]);X&&ot()}function Sn(t,e,i){X&&it("assign",t.constructor.name,e?Object.keys(e).join(", "):"");var o;for(o in e)i&&i.indexOf(o)>-1||e[o]&&e[o].setValueAtTime||(t[o]||t.hasOwnProperty(o))&&e[o]!==void 0&&pe(t,o,e[o]);return X&&ot(),t}var ho=Object.assign,kn=Object.defineProperties,mo=Object.getOwnPropertyDescriptor,An=S.targetDurationFactor,wo={attack:{writable:!0,enumerable:!0},release:{writable:!0,enumerable:!0},gain:{writable:!0,enumerable:!0},rate:{writable:!0,enumerable:!0}},go={attack:[[.008,"linear",1]],release:[[.008,"linear",0]],offset:0,gain:1,rate:1};function Pn(t,e,i,o,r){var s;le(t,i,"hold");for(s of e)vn(s),le(t,i+s[0]/r,s[1],s[2]*o,s[3])}var ut=class extends ConstantSourceNode{constructor(e,i){super(e);super.start.call(this,e.currentTime),D.call(this,e),kn(this,wo),Sn(this,ho({},go,i))}start(e){if(!this.attack||this.attack.length===0)return this;D.prototype.start.apply(this,arguments),Pn(this.offset,this.attack,this.startTime,this.gain,this.rate,"ConstantSource.offset");let i=z(this.attack);return i[2]===0&&(this.stopTime=e+(i[1]==="target"?i[0]+i[3]*An:i[0])),this}stop(e){if(!this.release||this.release.length===0)return this;D.prototype.stop.apply(this,arguments);let i=st(this.offset,this.stopTime);Pn(this.offset,this.release,this.stopTime,i,this.rate,"ConstantSource.offset");let o=z(this.release);return o[2]!==0?(console.warn("Envelope.release does not end with value 0. Envelope will never stop.",this),this.stopTime=1/0):this.stopTime+=o[1]==="target"?o[0]+o[3]*An:o[0],this}};kn(ut.prototype,{playing:mo(D.prototype,"playing")});var Ct=4;function xn(t,e,i,o,r){let s=-1;for(t.lineWidth="2",t.lineCap="round",t.beginPath(),t.moveTo(e.x,e.y+e.height);++s<o.length;)t.lineTo(e.x+s/i,e.y+(1-o[s])*e.height);t.strokeStyle=r,t.stroke(),t.lineTo(e.x+e.width,e.y+e.height),t.lineTo(e.x,e.y+e.height),t.fillStyle=r+"2b",t.fill(),t.closePath()}function Bn(t,e,i,o){let r=-1,s=18;for(t.lineWidth="2",t.lineCap="round",t.strokeStyle=o,t.setLineDash([2,6]),t.beginPath();++r<i.length;)i[r].type==="target"&&(t.moveTo(e.x+i[r].x*e.width,e.y+(1-(i[r-1]?i[r-1].y:0))*e.height),t.lineTo(e.x+i[r].x*e.width,e.y+(1-i[r].y)*e.height+((i[r-1]?i[r-1].y:0)>i[r].y?-s:s)),t.moveTo(e.x+i[r].x*e.width+s,e.y+(1-i[r].y)*e.height),t.lineTo(e.x+(i[r+1]?i[r+1].x:1)*e.width,e.y+(1-i[r].y)*e.height));t.stroke(),t.closePath()}function Ln(t,e,i,o,r){let s=Ct*e.width/i.width,a=new OfflineAudioContext(1,Ct*e.width,22050),p=new ut(a,{attack:o.map(l=>l.type==="target"?[l.x*s/22050,l.type,l.y,l.duration*s/22050]:[l.x*s/22050,l.type,l.y])});return p.connect(a.destination),p.start(i.x,"attack"),p.stop(i.width),t.activeRenders=t.activeRenders?t.activeRenders+1:1,t.cacheddata&&xn(t,e,Ct,t.cacheddata,r),t.cacheddata&&Bn(t,e,o.map(l=>({x:this.toRatioX(l.x),y:this.toRatioY(l.y),type:l.type,duration:l.duration})).sort(ie(V("x"))),r),a.startRendering().then(l=>{if(--t.activeRenders)return;let h=l.getChannelData(0).map(f=>this.toRatioY(f));!t.cacheddata&&xn(t,e,Ct,h,r),!t.cacheddata&&Bn(t,e,o.map(f=>({x:this.toRatioX(f.x),y:this.toRatioY(f.y),type:f.type,duration:f.duration})).sort(ie(V("x"))),r),t.cacheddata=h})}var ce="linear";var fe="0 0.2 0.4 0.6 0.8 1",he="any",me="";var vo=Object.assign;function Vn(t,e,i,o,r,s){let a=kt(t),p=O(e["font-size"]),l=O(e.borderLeftWidth)||0,h=O(e.borderTopWidth)||0,f=O(e.borderRightWidth)||0,m=O(e.borderBottomWidth)||0,u=O(e.paddingLeft)||0,d=O(e.paddingTop)||0,A=O(e.paddingRight)||0,b=O(e.paddingBottom)||0;return i.x=a.x+l+u,i.y=a.y+h+d,i.width=a.width-l-u-f-A,i.height=a.height-h-d-m-b,o.x=0,o.y=0,o.width=a.width-l-f,o.height=a.height-h-m,r.x=u,r.y=d,r.width=a.width-l-u-f-A,r.height=a.height-h-d-m-b,s[0]=0,s[2]=r.width/p,s[1]=0,s[3]=-r.height/p,a}function Mn(t,e,i,o,r){r.box=Vn(t,i,r.pxbox,r.paddingbox,r.contentbox,r.rangebox),o.width=r.paddingbox.width*2,o.height=r.paddingbox.height*2,e.setProperty("--range-x",r.rangebox[0]),e.setProperty("--range-y",r.rangebox[1]),e.setProperty("--range-width",r.rangebox[2]),e.setProperty("--range-height",r.rangebox[3])}function To(t,e){let i=e.data.pxbox,o=e.data.valuebox,r=t.clientX-i.x-e.offset.x,s=i.height-(t.clientY-i.y-e.offset.y);e.x=q(o.x,o.x+o.width,e.data.toValueX(r/i.width)),e.y=q(o.y,o.y+o.height,e.data.toValueY(s/i.height))}var bo=w((t,e)=>e.type,{pointerdown:(t,e)=>{t.target=e.target,t.time=e.timeStamp/1e3,t.previous&&t.previous.type==="tap"&&t.time-t.previous.time<Ze&&(t.type="double-tap",t.target=t.previous.target);let i=kt(e.target);return t.offset=e.target===e.currentTarget?{x:0,y:0}:{x:e.clientX-(i.x+i.width/2),y:e.clientY-(i.y+i.height/2)},t.events.length=0,t.events.push(e),t},pointermove:(t,e)=>{t.events.push(e);let i=t.events[0];return e.timeStamp-i.timeStamp<Xt&&e.clientX-i.clientX<4&&e.clientY-i.clientY<4||(t.type="move",To(e,t)),t},default:(t,e)=>(t.events.push(e),t.duration=e.timeStamp/1e3-t.time,!t.type&&t.duration<Xt&&(t.type="tap"),t)}),Eo=zt({".duration-handle":w((t,e)=>e.type,{pointermove:function(t,e){let i=denormalise[e.yTransform](e.yMin,e.yMax,-e.y);return scope[3]=e.x<=scope[0]?minExponential:e.x-scope[0],scope[2]=i,e},default:g}),".control-handle":w((t,e)=>e.type,{tap:function(t,e){return e.scope=scope,e},"double-tap":function(t,e){let i=e.previous.scope;return $(e.collection,i),e},move:function(t,e){let i=e.data,o=et(i.points);o[t.dataset.index].x=e.x,o[t.dataset.index].y=e.y;let r=e.host;return z(e.events).type!=="pointermove"?(cn(e.internal,e.formdata,r.name,i.points),gt("change",r)):gt("input",r),i},default:function(t,e){console.log("Untyped gesture",e)}}),"*":w((t,e)=>e.type,{"double-tap":function(t){let e=t.x,i=denormalise[t.yTransform](t.yMin,t.yMax,-t.y);return insert(getTime,t.collection,[e,"step",i]),sn(t.collection,".",t.collection),t},default:g})});function So(t,e,i,o,r,s,a,p){let l={x:o.x*2,y:o.y*2,width:o.width*2,height:o.height*2},h=i.getPropertyValue("--line-color-x").trim(),f=i.getPropertyValue("--line-color-y").trim(),m=i.getPropertyValue("--plot-color").trim();fn(e,{x:0,y:0,width:t.width,height:t.height}),hn(e,l,s.ticks.filter(u=>r.x+r.width>=u.value&&u.value>=r.x).map(u=>u.normalValue),h),mn(e,l,a.ticks.filter(u=>r.y+r.height>=u.value&&u.value>=r.y).map(u=>u.normalValue),f),p&&p.length&&Ln(e,l,r,p,m)}function Ao(t,e,i){return t.push(B("label",{part:i+"-tick tick",style:"--normal-"+i+": "+e.normalValue+";",html:"<span>"+e.label+"</span>"})),t}function Fn(t,e,i,o,r,s,a,p,l){e.setProperty("--"+t+"-normal-zero",i.normalise(o,r,0)),p.forEach(h=>h.remove()),p.length=0,p=s.reduce((h,f)=>Ao(h,f,t),p),l.after.apply(l,p)}var Dn={construct:function(t,e){let i=B("style",":host {} :host > * { visibility: hidden; }"),o=B("label",{for:"input",html:"<slot></slot>",part:"label"}),r=B("canvas"),s=B("svg"),a=B("text",""),p=B("text",""),l=[],h=[],f=[],m=[];t.append(i,o,r,s,a,p);let u=L(this),d={value:[]},A=getComputedStyle(this),b=i.sheet.cssRules[0].style,at=i.sheet.cssRules[1].style,lt=r.getContext("2d"),Mt=new FormData;u.host=this,u.hostStyle=b,u.childStyle=at,u.internals=e,u.data=d,u.ctx=lt,u.formdata=Mt,u.shadow=new Promise(v=>u.load=v),u.pxbox={},u.paddingbox={},u.contentbox={},u.rangebox=[0,6.75,6.75,-6.75],u.valuebox={x:0,y:0,width:1,height:1},u.xscale=c.of(ce),u.xmin=c.of(0),u.xmax=c.of(1),u.xstep=c.of(he),u.xticks=c.of(fe),u.xdisplay=c.of(me),u.yscale=c.of(ce),u.ymin=c.of(0),u.ymax=c.of(1),u.ystep=c.of(he),u.yticks=c.of(fe),u.ydisplay=c.of(me),u.value=c.of("0 0 step"),u.shadow.then(()=>{Mn(this,b,A,r,u)});let pt=c.combine({shadow:u.shadow,scale:u.xscale.map($t),min:u.xmin.map(C),max:u.xmax.map(C),ticks:u.xticks.map(H),step:u.xstep,display:u.xdisplay}).scan(Yt,{}).broadcast(),ct=c.combine({shadow:u.shadow,scale:u.yscale.map($t),min:u.ymin.map(C),max:u.ymax.map(C),ticks:u.yticks.map(H),step:u.ystep,display:u.ydisplay}).scan(Yt,{}).broadcast();c.combine({xattributes:pt,yattributes:ct}).each(v=>So(r,lt,A,u.contentbox,u.valuebox,v.xattributes,v.yattributes,d.value)),pt.each(v=>Fn("x",b,v.scale,v.min,v.max,v.ticks,l,f,a)),ct.each(v=>Fn("y",b,v.scale,v.min,v.max,v.ticks,h,m,p)),ne({threshold:1},t).reduce((v,Rn)=>{d.box=Vn(this,d.pxbox,d.paddingbox,d.contentbox,d.rangebox);let we=vo({previous:v,events:[]},this[tn]);return Rn.scan(bo,we).filter(V("type")).each(Eo),we}),Ut("resize",window).each(v=>Mn(this,b,A,r,u))},load:function(t){let e=L(this);e.childStyle.visibility="",e.load(t)}};function Po(t,e){let i=t[t.length-1];return i&&i.y===void 0?i.y=C(e):i&&!/^-?\d/.test(e)?i.type=e:t.push({x:C(e)}),t}function de(t){return t.split(/\s*,\s*|\s+/).reduce(Po,[])}function I(t,e){return{attribute:function(i){L(this)[t].push(i||e)}}}function Ot(t,e){return{attribute:function(i){this[t]=i},set:function(i){L(this)[t].push(i===void 0?e:i)},get:function(){return L(this).data[t]},enumerable:!0}}function ko(t){return{attribute:function(e){L(this)[t].push(!!e)}}}var _n={xmin:Ot("xmin",0),xmax:Ot("xmax",1),ymin:Ot("ymin",0),ymax:Ot("ymax",1),xscale:I("xscale","linear"),yscale:I("yscale","linear"),xticks:I("xticks"),yticks:I("yticks"),xstep:I("xstep"),ystep:I("ystep"),xdisplay:I("xdisplay"),ydisplay:I("ydisplay"),valuebox:{attribute:function(t){}},ordered:ko("ordered"),value:{attribute:function(t){this.value=t},get:function(){let t=L(this);return et(t.data.points)},set:function(t){L(this).value.push(typeof t=="string"?de(t):Jt(t))},enumerable:!0}};var xo=window.xyInputStylesheet||import.meta.url.replace(/\/[^\/]*([?#].*)?$/,"/")+"xy-input-shadow.css",ma=Rt("<xy-input>",Dn,_n,xo);export{ma as default};
