/* form-elements 
   0.0.4
   By Stephen Band
   Built 2023-03-22 18:03 */

var Ye=Object.getOwnPropertySymbols;var Lr=Object.prototype.hasOwnProperty,Or=Object.prototype.propertyIsEnumerable;var qe=(t,e)=>{var r={};for(var o in t)Lr.call(t,o)&&e.indexOf(o)<0&&(r[o]=t[o]);if(t!=null&&Ye)for(var o of Ye(t))e.indexOf(o)<0&&Or.call(t,o)&&(r[o]=t[o]);return r};function b(t){return t}function v(t,e){return function(){let o=t.apply(this,arguments),i=e[o]||e.default;if(!i)throw new Error('overload() no handler for "'+o+'"');return i.apply(this,arguments)}}function rt(t){var e=new Map;return function(o){if(e.has(o))return e.get(o);var i=t(o);return e.set(o,i),i}}var Br=Array.prototype;function Cr(t,e){return typeof t=="function"?t.apply(null,e):t}function Xe(t,e,r){r=r||t.length;var o=r===1?e?t:rt(t):rt(function(i){return Xe(function(){var s=[i];return s.push.apply(s,arguments),t.apply(null,s)},e,r-1)});return function i(s){return arguments.length===0?i:arguments.length===1?o(s):arguments.length>=r?t.apply(null,arguments):Cr(o(s),Br.slice.call(arguments,1))}}var T=Xe;function M(){}var Fr=v(b,{is:M,tag:M,data:function(t,e,r){Object.assign(e.dataset,r)},html:function(t,e,r){e.innerHTML=r},text:function(t,e,r){e.textContent=r},children:function(t,e,r){e.innerHTML="",e.append.apply(e,r)},points:J,cx:J,cy:J,r:J,transform:J,preserveAspectRatio:J,viewBox:J,default:function(t,e,r){t in e?e[t]=r:e.setAttribute(t,r)}});function J(t,e,r){e.setAttribute(t,r)}function Dr(t,e){for(var r=Object.keys(e),o=r.length;o--;)Fr(r[o],t,e[r[o]]);return t}var St=T(Dr,!0);var Zt="http://www.w3.org/2000/svg",$e=document.createElement("template"),te=(t,e)=>e&&typeof e;function Ke(t,e){let r=document.createRange();return r.selectNode(t),r.createContextualFragment(e)}var L=v(te,{string:function(t,e){let r=document.createElementNS(Zt,t);return r.innerHTML=e,r},object:function(t,e){let r=document.createElementNS(Zt,t);return typeof e.length=="number"?r.append.apply(r,e):St(r,e),r},default:t=>document.createElementNS(Zt,t)}),Vr=v(te,{string:function(t,e){let r=document.createElement(t);return r.innerHTML=e,r},object:function(t,e){let r=document.createElement(t);return typeof e.length=="number"?r.append.apply(r,e):St(r,e),r},default:t=>document.createElement(t)}),Ir=v(b,{comment:function(t,e){return document.createComment(e||"")},fragment:v(te,{string:function(t,e,r){return r?Ke(r,e):($e.innerHTML=e,$e.content.cloneNode(!0))},object:function(t,e,r){let o=r?Ke(r):document.createDocumentFragment();return typeof e.length=="number"?o.append.apply(o,e):St(o,e),o},default:()=>document.createDocumentFragment()}),text:function(t,e){return document.createTextNode(e||"")},circle:L,ellipse:L,g:L,glyph:L,image:L,line:L,rect:L,use:L,path:L,pattern:L,polygon:L,polyline:L,svg:L,default:Vr}),C=Ir;function ee(t,e,r){let o;typeof r!="string"&&r.input!==void 0&&r.index!==void 0&&(o=r,r=o.input.slice(r.index+r[0].length+(r.consumed||0)));let i=t.exec(r);if(!i)return;let s=e(i);return o&&(o.consumed=(o.consumed||0)+i.index+i[0].length+(i.consumed||0)),s}var ne=T(ee,!0);function Hr(t,e,r){throw r.input!==void 0&&r.index!==void 0&&(r=r.input),new Error('Cannot parse string "'+(r.length>128?r.length.slice(0,128)+"…":r)+'"')}function Gr(t,e,r){let o=-1;for(;++o<r.length;)e=r[o]!==void 0&&t[o]?t[o](e,r):e;return t.done?t.done(e,r):t.close?t.close(e,r):e}function jr(t,e,r,o){let i=ee(t,s=>Gr(e,r,s),o);return i===void 0?e.catch?e.catch(r,o):Hr(t,e,o):i}var Pt=T(jr,!0);var O=Symbol("internals"),Q=Symbol("shadow"),Je=Object.defineProperties,Rr={a:HTMLAnchorElement,article:HTMLElement,dl:HTMLDListElement,p:HTMLParagraphElement,br:HTMLBRElement,fieldset:HTMLFieldSetElement,hr:HTMLHRElement,img:HTMLImageElement,li:HTMLLIElement,ol:HTMLOListElement,optgroup:HTMLOptGroupElement,q:HTMLQuoteElement,section:HTMLElement,textarea:HTMLTextAreaElement,td:HTMLTableCellElement,th:HTMLTableCellElement,tr:HTMLTableRowElement,tbody:HTMLTableSectionElement,thead:HTMLTableSectionElement,tfoot:HTMLTableSectionElement,ul:HTMLUListElement},Wr={name:{set:function(t){return this.setAttribute("name",t)},get:function(){return this.getAttribute("name")||""}},form:{get:function(){return this[O].form}},labels:{get:function(){return this[O].labels}},validity:{get:function(){return this[O].validity}},validationMessage:{get:function(){return this[O].validationMessage}},willValidate:{get:function(){return this[O].willValidate}},checkValidity:{value:function(){return this[O].checkValidity()}},reportValidity:{value:function(){return this[O].reportValidity()}}},_r={},Qe={once:!0},Ze=0,tn=!1;function Ur(t){return Rr[t]||window["HTML"+t[0].toUpperCase()+t.slice(1)+"Element"]||(()=>{throw new Error('Constructor not found for tag "'+t+'"')})()}var zr=Pt(/^\s*<?([a-z][\w]*-[\w-]+)>?\s*$|^\s*<?([a-z][\w]*)\s+is[=\s]*["']?([a-z][\w]*-[\w]+)["']?>?\s*$/,{1:(t,e)=>({name:e[1]}),2:(t,e)=>({name:e[3],tag:e[2]}),catch:function(t,e){throw new SyntaxError(`dom element() – name must be of the form 'element-name' or 'tag is="element-name"' (`+e+")")}},null);function Nr(t,e){if(t.hasOwnProperty(e)){let r=t[e];delete t[e],t[e]=r}return t}function en(t,e,r){t._initialLoad=!0;let o=t.attachShadow({mode:e.mode||"closed",delegatesFocus:e.focusable||!1});if(r){let i=C("link",{rel:"stylesheet",href:r});o.append(i)}return t[Q]=o,o}function Yr(t){var e;if(t.attachInternals){if(e=t.attachInternals(),e.setFormValue)return e}else e={shadowRoot:t.shadowRoot};return e.input=C("input",{type:"hidden",name:t.name}),t.appendChild(e.input),e.setFormValue=function(r){this.input.value=r},e}function qr(t){return!!t.attribute}function Xr(t){return t.set||t.get||t.hasOwnProperty("value")}function $r(t,e){return qr(e[1])&&(t.attributes[e[0]]=e[1].attribute),Xr(e[1])&&(t.properties[e[0]]=e[1]),t}function re(t,e,r,o,i=""){let{name:s,tag:u}=zr(t),c=typeof u=="string"?Ur(u):HTMLElement,{attributes:l,properties:f}=r?Object.entries(r).reduce($r,{attributes:{},properties:{}}):_r;function h(){let d=Reflect.construct(c,arguments,h),y=e.construct&&e.construct.length>Ze?en(d,e,o||e.stylesheet):void 0,a=h.formAssociated?Yr(d):{};return u&&(tn=!0),e.construct&&e.construct.call(d,y,a),f&&Object.keys(f).reduce(Nr,d),d}return h.prototype=Object.create(c.prototype,f),f.value&&(h.formAssociated=!0,Je(h.prototype,Wr),(e.enable||e.disable)&&(h.prototype.formDisabledCallback=function(d){return d?e.disable&&e.disable.call(this,this[Q],this[O]):e.enable&&e.enable.call(this,this[Q],this[O])}),e.reset&&(h.prototype.formResetCallback=function(){return e.reset.call(this,this[Q],this[O])}),e.restore&&(h.prototype.formStateRestoreCallback=function(){return e.restore.call(this,this[Q],this[O])})),l&&(h.observedAttributes=Object.keys(l),h.prototype.attributeChangedCallback=function(d,y,a){return l[d].call(this,a)}),h.prototype.connectedCallback=function(){let d=this,y=d[Q],a=d[O];if(d._initialLoad){let m=y.querySelectorAll('link[rel="stylesheet"]');if(m.length){let w=0,V=m.length,I=function(Kt){++w>=m.length&&(delete d._initialLoad,e.load&&e.load.call(d,y))},ut=I;for(;V--;)m[V].addEventListener("load",I,Qe),m[V].addEventListener("error",ut,Qe)}else e.load&&Promise.resolve(1).then(()=>e.load.call(this,y,a))}e.connect&&e.connect.call(this,y,a)},e.disconnect&&(h.prototype.disconnectedCallback=function(){return e.disconnect.call(this,this[Q],this[O])}),window.console&&window.console.log("%c<"+(u?u+" is="+s:s)+">%c "+i,"color: #3a8ab0; font-weight: 600;","color: #888888; font-weight: 400;"),window.customElements.define(s,h,u&&{extends:u}),u&&!tn&&document.querySelectorAll('[is="'+s+'"]').forEach(d=>{f&&Je(d,f);let y=e.construct&&e.construct.length>Ze?en(d,e,o||e.stylesheet):void 0;e.construct&&e.construct.call(d,y);let a;for(a in l){let m=d.attributes[a];m&&l[a].call(d,m.value)}e.connect&&e.connect.apply(d)}),h}var oe=Symbol("privates");function k(t){return t[oe]||Object.defineProperty(t,oe,{value:{}})[oe]}function at(t,e,r){return r>e?e:r<t?t:r}var us=T(at);function ie(t){return function(){return arguments[t]}}function B(){return this}var Kr=Object.create,Jr=Object.freeze;function Qr(){return!0}function nn(){return-1}var j=Jr(Kr({shift:M,push:M,forEach:M,join:function(){return""},every:Qr,filter:B,find:M,findIndex:nn,flat:B,flatMap:B,includes:function(){return!1},indexOf:nn,map:B,reduce:ie(1),sort:B,each:B,pipe:b,start:B,stop:B,done:B,valueOf:function(){return null}},{length:{value:0}}));function ct(t,e){t.remove&&t.remove(e);let r;for(;(r=t.indexOf(e))!==-1;)t.splice(r,1);return t}var ws=T(ct,!0);function se(t){return t&&t[Symbol.iterator]}var Zr=Object.assign;function to(t){return t.stop?t.stop():t()}function lt(){}Zr(lt.prototype,{stop:function(){let t=this.stopables;return this.stopables=void 0,t&&t.forEach(to),this},done:function(t){return(this.stopables||(this.stopables=[])).push(t),this}});var R=Object.assign,N=Object.create;function pt(t,e){t[0]=e,e.done(t)}function rn(t,e){let r=t[e].stopables;r&&ct(r,t),t[e]=void 0}function E(t,e){t&&t.push(e)}function S(t){lt.prototype.stop.apply(t);let e=-1,r;for(;r=t[++e];)t[e]=void 0,r.stop()}function on(t){return p.prototype.isPrototypeOf(t)}function p(t){this.input=t}R(p.prototype,lt.prototype,{push:function(t){E(this[0],t)},pipe:function(t){if(this[0])throw new Error("Stream: Attempt to .pipe() a unicast stream multiple times. Create a multicast stream with .broadcast().");return this[0]=t,t.done(this),this.input.pipe(this),t},map:function(t){return new sn(this,t)},filter:function(t){return new un(this,t)},split:function(t){return new cn(this,t)},flatMap:function(t){return new an(this,t)},slice:function(t,e){return new ue(this,t,e)},take:function(t){return console.warn(".take(a) superseded by .slice(0, a)"),new ue(this,0,t)},each:function(t){return this.pipe(new fn(t))},reduce:function(t,e){return this.pipe(new ln(t,e)).value},scan:function(t,e){return new pn(this,t,e)},stop:function(){return S(this),this}});function sn(t,e){this.input=t,this.fn=e}sn.prototype=R(N(p.prototype),{push:function(e){let o=this.fn(e);o!==void 0&&E(this[0],o)}});function un(t,e){this.input=t,this.fn=e}un.prototype=R(N(p.prototype),{push:function(e){this.fn(e)&&E(this[0],e)}});function an(t,e){this.input=t,this.fn=e}an.prototype=R(N(p.prototype),{push:function(e){let o=this.fn(e);if(o!==void 0)if(se(o))for(let i of o)E(this[0],i);else o.pipe&&this.done(o.each(i=>E(this[0],i)))}});function cn(t,e){this.input=t,this.chunk=[],typeof n=="number"?this.n=e:this.fn=e}cn.prototype=R(N(p.prototype),{fn:function(){return this.chunk.length===this.n},push:function(e){let r=this.chunk;this.fn(e)?(E(this[0],r),this.chunk=[]):r.push(e)}});function ue(t,e,r=1/0){this.input=t,this.index=-e,this.indexEnd=e+r}ue.prototype=R(N(p.prototype),{push:function(e){++this.index>0&&this[0].push(e),this.index===this.indexEnd&&this.stop()}});function ln(t,e){this.fn=t,this.value=e,this.i=0}ln.prototype=R(N(p.prototype),{push:function(t){let e=this.fn;this.value=e(this.value,t,this.i++,this)}});function pn(t,e,r){this.input=t,this.fn=e,this.value=r}pn.prototype=R(N(p.prototype),{push:function(t){let e=this.fn;this.value=e(this.value,t),this[0].push(this.value)}});function fn(t){this.push=t}fn.prototype=R(N(p.prototype),{each:null,reduce:null,pipe:null});var eo=Object.assign,no=Object.create;function ro(t,e){if(t[1]){let r=-1;for(;t[++r]&&t[r]!==e;);for(;t[r++];)t[r-1]=t[r]}else t.stop()}function ft(t,e){p.apply(this,arguments),this.memory=!!(e&&e.memory),e&&e.hot&&this.pipe(j)}ft.prototype=eo(no(p.prototype),{push:function(t){if(t===void 0)return;this.memory&&(this.value=t);let e=-1;for(;this[++e];)this[e].push(t)},pipe:function(t){let e=-1;for(;this[++e];);return this.memory&&e===0&&this.input.pipe(this),this[e]=t,t.done(()=>ro(this,t)),this.value!==void 0&&t.push(this.value),!this.memory&&e===0&&this.input.pipe(this),t}});var oo=Array.prototype,io=Object.assign,so=Object.create;function uo(t){return t!==void 0}function ht(t){this.buffer=t?t.filter?t.filter(uo):t:[]}ht.prototype=io(so(p.prototype),{push:function(t){t!==void 0&&E(this.buffer,t)},pipe:function(t){for(t.done(this),this[0]=t;this.buffer.length;)E(this[0],oo.shift.apply(this.buffer));return this.buffer=t,t},stop:function(){return this.buffer=void 0,S(this),this}});var hn=Object.assign,ao=Object.create,co=Promise.resolve(),lo={schedule:function(){co.then(this.fire)},unschedule:M},po={schedule:function(){this.timer=requestAnimationFrame(this.fire)},unschedule:function(){cancelAnimationFrame(this.timer),this.timer=void 0}},fo={schedule:function(){this.timer=setTimeout(this.fire,this.duration*1e3)},unschedule:function(){clearTimeout(this.timer),this.timer=void 0}};function Z(t,e){p.apply(this,arguments),this.duration=e,this.timer=void 0,this.fire=()=>{this.timer=void 0,this.output.stop()},hn(this,e==="tick"?lo:e==="frame"?po:fo)}Z.prototype=hn(ao(p.prototype),{push:function(t){this.timer?(this.unschedule(),this.schedule(),this.output.push(t)):(this.output=p.of(t),this[0].push(this.output),this.schedule())},stop:function(){return this.timer&&this.fire(),p.prototype.stop.apply(this,arguments)}});var ae=Object.assign,ho=Object.create,dn=Object.keys;function ce(t,e,r,o,i){this.stream=t,this.names=e,this.values=r,this.name=o,this.input=i}ae(ce.prototype,{push:function(t){let e=this.stream,r=this.values,o=this.name;r[o]=t,(e.active||(e.active=dn(r).length===this.names.length))&&E(e[0],ae({},r))},stop:function(){--this.stream.count===0&&S(this.stream)},done:function(t){this.stream.done(t)}});function Mt(t){this.inputs=t,this.active=!1}Mt.prototype=ae(ho(p.prototype),{push:null,pipe:function(t){let e=this.inputs,r=dn(e),o={};this.count=r.length,this[0]=t,t.done(this);let i;for(i in e){let s=e[i];if(s.pipe){let u=new ce(this,r,o,i,s);s.pipe(u)}else if(s.then){let u=new ce(this,r,o,i,s);s.then(c=>u.push(c)),s.finally(()=>u.stop())}else o[i]=s,--this.count}return t}});var mo=Object.assign,go=Object.create;function kt(t){this.fn=t}kt.prototype=mo(go(p.prototype),{pipe:function(t){return t.done(this),this[0]=t,this.fn(e=>this.push(e),e=>this.stop(e)),t}});var mn=Object.assign,wo=Object.create;function gn(t){this.stream=t}mn(gn.prototype,{push:function(t){E(this.stream[0],t)},stop:function(){--this.stream.count===0&&S(this.stream)},done:function(t){this.stream.done(t)}});function At(t){this.inputs=t}At.prototype=mn(wo(p.prototype),{push:null,pipe:function(t){let e=this.inputs;this.count=e.length,this[0]=t,t.done(this);let r=new gn(this),o=-1,i;for(;i=e[++o];)if(i.pipe)i.pipe(r);else if(i.then)i.then(s=>r.push(s)),i.finally(()=>r.stop());else{let s=-1;for(;++s<i.length;)r.push(i[s]);r.stop()}return t}});var yo=Object.assign,vo=Object.create;function Lt(t){this.promise=t}Lt.prototype=yo(vo(p.prototype),{push:null,pipe:function(t){let e=this.promise;return this[0]=t,t.done(this),e.then(r=>E(this,r)),e.finally(()=>S(this)),t}});var To=Array.prototype,wn=Object.assign;function bo(t){throw new TypeError("Stream cannot be created from "+typeof object)}wn(p,{isStream:on,of:function(){return new ht(To.slice.apply(arguments))},from:function(t){return t.pipe?new p(t):t.then?new Lt(t):typeof t.length=="number"?typeof t=="function"?new kt(t):new ht(t):bo(t)},batch:t=>new Z(j,t),burst:t=>(console.warn("Stream.burst() is now Stream.batch()"),new Z(j,t)),broadcast:t=>new ft(j,t),combine:t=>new Mt(t),merge:function(){return new At(arguments)},writeable:function(t){let e=new p(j);return t(e),e}});wn(p.prototype,{log:B,batch:function(t){return new Z(this,t)},burst:function(t){return console.warn("stream.burst() is now stream.batch()"),new Z(this,t)},broadcast:function(t){return new ft(this,t)}});function Eo(t,e){return e[t]}var W=T(Eo,!0);function G(t){if(typeof t.length=="number")return t[t.length-1]}function le(t,e,r){return(r-t)/(e-t)}function F(t,e,r){return r*(e-t)+t}var xo=Object.assign,So=Object.defineProperties,Po=Object.isExtensible,Mo=Object.prototype,Y=Symbol("observe");function ko(t,e){let r=t.indexOf(e);return r>-1&&t.splice(r,1),t}var yn={[Y]:{}};function Ot(t,e){if(!t||!t.length)return 0;t=t.slice(0);for(var r=-1;t[++r];)t[r].status!=="stopped"&&t[r].push(e);return r}function vn(t){this.observables={},this.gets=[],this.sets=void 0,this.target=t,this.observer=new Proxy(t,this),yn[Y].value=this,So(t,yn)}xo(vn.prototype,{notify:function(t){Ot(this.observables[t],this.target[t]),Ot(this.sets,this.target)},listen:function(t,e){(t===null?this.sets||(this.sets=[]):this.observables[t]||(this.observables[t]=[])).push(e)},unlisten:function(t,e){let r=t===null?this.sets:this.observables[t];r&&ko(r,e)},get:function(e,r,o){let i=e[r];if(typeof r=="symbol"||r==="__proto__")return i;let s=Object.getOwnPropertyDescriptor(e,r);if((s?s.writable||s.set:i===void 0)&&Ot(this.gets,r),!Mo.hasOwnProperty.call(e,r))return i;let c=ot(i);if(!c)return i;for(var l=-1;this.gets[++l];)this.gets[l].listen(r);return c},set:function(e,r,o,i){if(typeof r=="symbol"||r==="__proto__")return e[r]=o,!0;let s=tt(o);if(e[r]===o||e[r]===s)return!0;let u=e.length;for(var c=-1;this.gets[++c];)this.gets[c].unlisten(r);return e[r]=s,r!=="length"&&e.length!==u&&Ot(this.observables.length,e.length),this.notify(r),!0},deleteProperty:function(t,e){return typeof e=="symbol"||e==="__proto__"?(delete t[e],!0):(t.hasOwnProperty(e)&&(delete t[e],this.notify(e)),!0)}});function Bt(t){return t&&Po(t)&&!Node.prototype.isPrototypeOf(t)&&(typeof BaseAudioContext>"u"||!BaseAudioContext.prototype.isPrototypeOf(t))&&!(t instanceof Date)&&!(t instanceof RegExp)&&!(t instanceof Map)&&!(t instanceof WeakMap)&&!(t instanceof Set)&&!(window.WeakSet&&t instanceof WeakSet)&&!ArrayBuffer.isView(t)}function ot(t,e){return t?t[Y]?t[Y].observer:e||Bt(t)?new vn(t).observer:void 0:void 0}function tt(t){return t&&t[Y]&&t[Y].target||t}function pe(t){return ot(t)&&t[Y]}function Tn(t,e){let r=e[Y];r&&r.notify(t)}var bn=Object.assign,Ao=Object.create,fe=/(^\.?|\.)\s*([\w-]*)\s*/g;function Lo(t){this.producer.push(t)}function he(t,e,r,o){fe.lastIndex=e;let i=fe.exec(t);this.path=t,this.object=r,this.producer=o,this.key=i[2]||i[1],this.index=fe.lastIndex,this.isMuteableObserver=this.path.slice(this.index)===".",this.index>=this.path.length&&(this.push=Lo),this.listen(),this.push(this.key==="."?this.object:tt(this.object)[this.key])}bn(he.prototype,{push:function(t){Bt(t)?this.child?this.child.relisten(t):this.child=new he(this.path,this.index,t,this.producer):(this.child&&(this.child.stop(),this.child=void 0),this.producer.push(this.isMuteableObserver?t:void 0))},listen:function(){let t=pe(this.object);t&&t.listen(this.key==="."?null:this.key,this)},unlisten:function(){pe(this.object).unlisten(this.key==="."?null:this.key,this)},relisten:function(t){this.unlisten(),this.object=t,this.listen(),this.push(tt(this.object)[this.key])},stop:function(){this.unlisten(),this.child&&this.child.stop(),this.child=void 0,this.status="stopped"}});function En(t,e,r){this.path=t,this.object=e,this.value=r}En.prototype=bn(Ao(p.prototype),{push:function(t){this.value===t&&(!this.isMutationProducer||!Bt(t))||(this.value=t,this[0].push(t))},pipe:function(t){return this[0]=t,t.done(this),this.pathObserver=new he(this.path,0,this.object,this),this.isMutationProducer=this.path[this.path.length-1]===".",t},stop:function(){return this.pathObserver.stop(),p.prototype.stop.apply(this,arguments)}});function Ct(t,e,r){return new p(new En(t,e,r))}function de(t){if(typeof t!="object"||arguments.length>1)throw new Error("delegate() now takes an object of selector:fn pairs.");return function(r){let o=r.target,i;for(i in t){let s=o.closest(i);if(s)return t[i](s,...arguments)}}}var Oo=Object.assign,Bo=/\s+/,Ft={fullscreenchange:rt(()=>"fullscreenElement"in document?"fullscreenchange":"webkitFullscreenElement"in document?"webkitfullscreenchange":"mozFullScreenElement"in document?"mozfullscreenchange":"msFullscreenElement"in document?"MSFullscreenChange":"fullscreenchange")},xn=0;window.addEventListener("click",t=>xn=t.timeStamp);function Co(t,e){return t.node.addEventListener(Ft[e]?Ft[e]():e,t,t.options),t}function Fo(t,e){return t.node.removeEventListener(Ft[e]?Ft[e]():e,t),t}function Sn(t,e,r){this.types=t.split(Bo),this.options=e,this.node=r,this.select=e&&e.select}Oo(Sn.prototype,{pipe:function(t){pt(this,t),this.types.reduce(Co,this)},handleEvent:function(t){if(!(t.type==="click"&&t.timeStamp<=xn)){if(this.select){let e=t.target.closest(this.select);if(!e)return;t.selectedTarget=e}E(this[0],t)}},stop:function(){this.types.reduce(Fo,this),S(this[0])}});function me(t,e){let r;return typeof t=="object"&&(r=t,t=r.type),new p(new Sn(t,r,e))}var Do=Object.assign,dt={bubbles:!0,cancelable:!0};function Dt(t,e){var f;let r=dt,o,i,s,u,c,l;return typeof t=="object"?(f=t,{type:t,detail:i,bubbles:s,cancelable:u,composed:c}=f,o=qe(f,["type","detail","bubbles","cancelable","composed"]),l=Do(new CustomEvent(t,{detail:i,bubbles:s||dt.bubbles,cancelable:u||dt.cancelable,composed:c||dt.composed}),o)):l=new CustomEvent(t,dt),e.dispatchEvent(l)}var gu=T(Dt,!0);function q(t){return typeof t}var Vo=/^\s*([+-]?\d*\.?\d+)([^\s\d]*)\s*$/;function ge(t){return function(r){if(typeof r=="number")return r;var o=Vo.exec(r);if(!o||!t[o[2]||""]){if(!t.catch)throw new Error('Cannot parse value "'+r+'" (accepted units '+Object.keys(t).join(", ")+")");return o?t.catch(parseFloat(o[1]),o[2]):t.catch(parseFloat(r))}return t[o[2]||""](parseFloat(o[1]))}}var Io=/px$/,Pn={"transform:translateX":function(t){var e=mt("transform",t);if(!e||e==="none")return 0;var r=Vt(e);return parseFloat(r[4])},"transform:translateY":function(t){var e=mt("transform",t);if(!e||e==="none")return 0;var r=Vt(e);return parseFloat(r[5])},"transform:scale":function(t){var e=mt("transform",t);if(!e||e==="none")return 0;var r=Vt(e),o=parseFloat(r[0]),i=parseFloat(r[1]);return Math.sqrt(o*o+i*i)},"transform:rotate":function(t){var e=mt("transform",t);if(!e||e==="none")return 0;var r=Vt(e),o=parseFloat(r[0]),i=parseFloat(r[1]);return Math.atan2(i,o)}};function Vt(t){return t.split("(")[1].split(")")[0].split(/\s*,\s*/)}function mt(t,e){return window.getComputedStyle?window.getComputedStyle(e,null).getPropertyValue(t):0}function It(t,e){if(Pn[t])return Pn[t](e);var r=mt(t,e);return typeof r=="string"&&Io.test(r)?parseFloat(r):r}var Ht,Gt;function Ho(){if(!Ht){let t=document.documentElement.style.fontSize;document.documentElement.style.fontSize="100%",Ht=It("font-size",document.documentElement),document.documentElement.style.fontSize=t||""}return Ht}function Go(){return Gt||(Gt=It("font-size",document.documentElement)),Gt}window.addEventListener("resize",()=>{Ht=void 0,Gt=void 0});var H=v(q,{number:b,string:ge({px:b,em:t=>Ho()*t,rem:t=>Go()*t,vw:t=>window.innerWidth*t/100,vh:t=>window.innerHeight*t/100,vmin:t=>window.innerWidth<window.innerHeight?window.innerWidth*t/100:window.innerHeight*t/100,vmax:t=>window.innerWidth<window.innerHeight?window.innerHeight*t/100:window.innerWidth*t/100})}),Mn=H;function we(t){t.stopPropagation(),t.preventDefault()}var jo=Array.prototype,ve=Object.assign,ye="webkitUserSelect"in document.body.style?"webkitUserSelect":"userSelect",jt={},Rt={threshold:4,ignoreTags:{textarea:!0,input:!0,select:!0}};function Ro(t,e,r){return e*e+r*r>=t*t}function kn(t,e,r){if(this.stream=t,this.events=[e],this.options=r,this.pointerId=e.pointerId,typeof r.threshold=="function")this.checkThreshold=r.threshold;else{let o=Mn(r.threshold);this.checkThreshold=(i,s,u)=>Ro(o,i,s,u)}document.addEventListener("pointermove",this),document.addEventListener("pointerup",this),document.addEventListener("pointercancel",this)}ve(kn.prototype,{handleEvent:v(W("type"),{pointermove:function(t){if(this.pointerId===t.pointerId){if(this.pointerId in jt&&this!==jt[this.pointerId]){this.stop();return}if(this.events.push(t),!this.isGesture){let e=this.events[0],r=t.clientX-e.clientX,o=t.clientY-e.clientY,i=(t.timeStamp-e.timeStamp)/1e3;this.checkThreshold(r,o,i)&&this.createGesture()}}},pointerup:function(t){this.pointerId===t.pointerId&&(this.events.push(t),this.stop(),this.isGesture&&document.addEventListener("click",we,{capture:!0,once:!0}))},default:function(t){this.pointerId===t.pointerId&&(this.events.push(t),this.stop())}}),createGesture:function(){this.isGesture=!0,this.userSelectState=document.body.style[ye],document.body.style[ye]="none",jt[this.pointerId]=this,this.stream.push(new p(this))},pipe:function(t){for(pt(this,t);this.events.length;)E(this[0],jo.shift.apply(this.events));this.events=t},stop:function(){if(document.removeEventListener("pointermove",this),document.removeEventListener("pointerup",this),document.removeEventListener("pointercancel",this),this.isGesture&&(document.body.style[ye]=this.userSelectState,delete jt[this.pointerId]),this[0]){let t=this[0];rn(this,0),S(t)}}});function Wo(t){var e=t.target.tagName;return e&&(!!Rt.ignoreTags[e.toLowerCase()]||t.target.draggable)}function An(t,e){this.node=t,this.options=e}ve(An.prototype,{pipe:function(t){return this[0]=t,this.node.addEventListener("pointerdown",this),t},handleEvent:function(t){if(t.button===0&&!(this.options.device&&!this.options.device.includes(t.pointerType))&&!Wo(t)&&!(this.options.select&&!t.target.closest(this.options.select))){var e={type:t.type,target:t.target,currentTarget:t.currentTarget,clientX:t.clientX,clientY:t.clientY,timeStamp:t.timeStamp,pointerId:t.pointerId};new kn(this[0],e,this.options)}},stop:function(){return this[0]&&(this.node.removeEventListener("pointerdown",this),S(this[0])),this}});function Te(t,e){return t=e&&t?ve({},Rt,t):Rt,e=e||t,new p(new An(e,t))}function _o(){return{x:0,y:0,left:0,top:0,right:window.innerWidth,bottom:window.innerHeight,width:window.innerWidth,height:window.innerHeight}}function Wt(t){return t===window?_o():t.getClientRects()[0]||t.getBoundingClientRect()}function x(t){return Math.pow(10,t/20)}function D(t){if(!t)return 0;let e=+t;if(e||e===0)return e;let r=/^(?:(-?[\d.]+)|(-?∞))(?:(db|bpm)|(m|k)?(\w+))$/.exec(t.toLowerCase());if(!r)return 0;let o=r[2]?r[2]==="-∞"?-1/0:1/0:parseFloat(r[1]);return r[3]==="db"?x(o):r[3]==="bpm"?o/60:r[4]==="m"?o/1e3:r[4]==="k"?o*1e3:o}var Ln=Pt(/^([+\-]?(?:0|[1-9]\d*)(?:\.\d+)?(?:[eE][+\-]?\d+)?\w*)\s*(?:\[([^\]]+)\]|([^\d\s]\S*))?\s*/,{1:(t,e)=>(t.push({value:D(e[1])}),t),2:(t,e)=>(G(t).label=e[2],t),3:(t,e)=>(G(t).label=e[3],t),done:(t,e)=>Ln(t,e),catch:(t,e)=>t}),et=v(q,{string:t=>Ln([],t.trim()),object:b});function A(t,e){return Math.ceil(e/t)*t}var On=v(t=>t.toLowerCase(),{db:(t,e,r)=>et("-∞dB -96dB -90dB -84dB -78dB -72dB -66dB -60dB -54dB -48dB -42dB -36dB -30dB -24dB -18dB -12dB -6dB 0dB 6dB 12dB 18dB 24dB"),default:(t,e,r)=>{let o=r-e,i=o<.8?A(.05,o/10):o<2?A(.2,o/10):o<8?A(.5,o/10):o<20?A(2,o/10):o<80?A(5,o/10):o<200?A(20,o/10):A(200,o),s=[],u=o<.8?A(.05,e):o<2?A(.2,e):o<8?A(.5,e):o<20?A(2,e):o<80?A(5,e):o<200?A(20,e):A(200,e);for(;u<=r;)s.push({label:o<2?u.toFixed(1):u,value:u}),u+=i;return s}});function Bn(t,e,r,o){return t.normalValue=e.normalise(r,o,t.value),t}function be(t,e){let{scale:r,min:o,max:i,ticks:s,step:u,display:c}=e;return t.scale=r,t.min=o,t.max=i,t.ticks=(s?s.length?s:On(c,o,i):j).filter(l=>l.value>=t.min&&l.value<=t.max).map(l=>Bn(l,r,o,i)),t.step=u==="any"?void 0:u==="tick"?t.ticks:et(u).filter(l=>l.value>=t.min&&l.value<=t.max).map(l=>Bn(l,r,o,i)),t.display=c,t}function Ee(t){return 20*Math.log10(t)}function X(t,e){var r=e%t;return r<0?r+t:r}var sa=T(X);function gt(t){return function(r,...o){var i=t[r]||t.default;return i&&i.apply(this,o)}}var In=9,Uo=/(`[^`]*`)|(ms|[YMwdhms]{1,3}|±)/g;function zo(t){return t*60}function No(t){return t*3600}function Yo(t){return t*1e3}function Cn(t){return t/60}function Fn(t){return t/3600}function xe(t){return t/86400}function qo(t){return t/604800}function Dn(t){return t/2629800}function Xo(t){return t/31557600}function $(t){return t>=10?"":"0"}var $o=/^([+-])?(\d{2,}):([0-5]\d)(?::((?:[0-5]\d|60)(?:.\d+)?))?$/,Ko=/^([+-])?(\d{2,}):(\d{2,})(?::(\d{2,}(?:.\d+)?))?$/,nt=v(q,{number:b,string:ne($o,Gn),default:function(t){throw new Error("parseTime() does not accept objects of type "+typeof t)}}),Hn=v(q,{number:b,string:ne(Ko,Gn),default:function(t){throw new Error("parseTime() does not accept objects of type "+typeof t)}});function Gn(t){let[e,r,o,i,s]=t;var u=No(parseInt(o,10))+(i?zo(parseInt(i,10))+(s?parseFloat(s,10):0):0);return r==="-"?-u:u}function Jo(t,e){return t.replace(Uo,(r,o,i)=>o?o.slice(1,-1):Vn[r]?Vn[r](e):r)}function Qo(t){var e=t<0?"-":"";t<0&&(t=-t);var r=Math.floor(t/3600),o=$(r)+r;if(t=t%3600,t===0)return e+o+":00";var i=Math.floor(t/60),s=$(i)+i;if(t=t%60,t===0)return e+o+":"+s;var u=$(t)+jn(In,t);return e+o+":"+s+":"+u}function jn(t,e){return e.toFixed(t).replace(/\.?0+$/,"")}var Vn={"±":function(e){return e<0?"-":""},Y:function(e){return e=e<0?-e:e,Math.floor(Xo(e))},M:function(e){return e=e<0?-e:e,Math.floor(Dn(e))},MM:function(e){return e=e<0?-e:e,Math.floor(Dn(e%31557600))},w:function(e){return e=e<0?-e:e,Math.floor(qo(e))},ww:function(e){return e=e<0?-e:e,Math.floor(xe(e%2629800))},d:function(e){return e=e<0?-e:e,Math.floor(xe(e))},dd:function(e){return e=e<0?-e:e,Math.floor(xe(e%604800))},h:function(e){return e=e<0?-e:e,Math.floor(Fn(e))},hh:function(e){e=e<0?-e:e;var r=Math.floor(Fn(e%86400));return $(r)+r},m:function(e){e=e<0?-e:e;var r=Math.floor(Cn(e));return $(r)+r},mm:function(e){e=e<0?-e:e;var r=Math.floor(Cn(e%3600));return $(r)+r},s:function(e){return e=e<0?-e:e,Math.floor(e)},ss:function(e){e=e<0?-e:e;var r=Math.floor(e%60);return $(r)+r},sss:function(e){e=e<0?-e:e;var r=e%60;return $(r)+jn(In,r)},ms:function(e){e=e<0?-e:e;var r=Math.floor(Yo(e%1));return r>=100?r:r>=10?"0"+r:"00"+r}},Rn=T(function(t,e){return t==="ISO"?Qo(nt(e)):Jo(t,nt(e))});var ga=T(function(t,e){return nt(e)+Hn(t)}),wa=T(function(t,e){return nt(e)-Hn(t)}),ya=T(function(t,e){return nt(t)-nt(e)}),Zo=gt({w:function(t){return t-X(604800,t)},d:function(t){return t-X(86400,t)},h:function(t){return t-X(3600,t)},m:function(t){return t-X(60,t)},s:function(t){return t-X(1,t)},ms:function(t){return t-X(.001,t)}}),va=T(function(t,e){return Zo(t,nt(e))});function ti(){return{unit:value<1?"m"+unit:unit,value:value<.001?(value*1e3).toFixed(2):value<1?(value*1e3).toPrecision(3):value.toPrecision(3)}}function ei(t,e){return{unit:e<1?"m"+t:e>=1e3?"k"+t:t,value:e<.001?(e*1e3).toFixed(2):e<1?(e*1e3).toPrecision(3):e>=1e3?(e/1e3).toPrecision(3):e.toPrecision(3)}}function ni(t,e){return{unit:e<.01?"m"+t:e<1?"c"+t:e>=1e3?"k"+t:t,value:e<.001?(e*1e3).toFixed(2):e<.01?(e*1e3).toPrecision(3):e<1?(e*100).toPrecision(3):e>=1e3?(e/1e3).toPrecision(3):e.toPrecision(3)}}var ri={pan:(t,e)=>({unit:"",value:e===-1?"-1.00":e===0?"0.00":e===1?"1.00":e.toFixed(2)}),db:(t,e)=>{let r=Ee(e);return{unit:"dB",value:isFinite(r)?r<-1?r.toPrecision(3):r.toFixed(2):r<0?"-∞":"∞"}},hz:(t,e)=>({unit:e>=1e3?"kHz":"Hz",value:e<1?e.toFixed(2):e>=1e3?(e/1e3).toPrecision(3):e.toPrecision(3)}),semitone:(t,e)=>({unit:"",value:e===0?"0":e<0?"♭"+(-e/100).toFixed(2):"♯"+(e/100).toFixed(2)}),s:ti,m:ni,bpm:(t,e)=>{let r=e*60;return{unit:"bpm",value:r<100?r.toFixed(1):r.toFixed(0)}},int:(t,e)=>({unit:"",value:Math.round(e)}),"":(t,e)=>({unit:"",value:e>-1&&e<1?e.toFixed(2):e.toPrecision(3)}),default:v(t=>/[YMWwdhms]/.test(t)?"time":"default",{time:(t,e)=>({unit:"",value:Rn(t,e)}),default:ei})},Sa=v(t=>t.toLowerCase(),ri);var ka=x(-6),Aa=x(-12),La=x(-18),Wn=x(-24),_n=x(-30),Un=x(-36),Oa=x(-42),zn=x(-48),Ba=x(-54),Nn=x(-60),Yn=x(-66),qn=x(-72),Ca=x(-78),Fa=x(-84),Da=x(-90),Xn=x(-96),Se=.25,$n=.4,Va=Symbol("state");var Kn=Object.assign,Ut={};function Pe(t,e,r){let o=r/(e*t);return(o<=1?o:Math.log(o)+1)/Ut[t]}function oi(t,e,r){let o=r*Ut[t];return e*t*(o<=1?o:Math.pow(Math.E,o-1))}function _(t){this.xover=t,Ut[t]||(Ut[t]=Math.log(1/t)+1)}Kn(_.prototype,{normalise:function(t,e,r){let o=Pe(this.xover,e,t);return(Pe(this.xover,e,r)-o)/(1-o)},denormalise:function(t,e,r){let o=Pe(this.xover,e,t),i=r*(1-o)+o;return oi(this.xover,e,i)}});function _t(t){this.power=t}Kn(_t.prototype,{normalise:function(t,e,r){return Math.pow((r-t)/(e-t),1/this.power)},denormalise:function(t,e,r){return Math.pow(r,this.power)*(e-t)+t}});var ii={linear:{normalise:le,denormalise:F},"pow-2":new _t(2),"pow-3":new _t(3),"pow-4":new _t(4),log:{normalise:function(t,e,r){return Math.log(r/t)/Math.log(e/t)},denormalise:function(t,e,r){return t*Math.pow(e/t,r)}},"log-24db":new _(Wn),"log-30db":new _(_n),"log-36db":new _(Un),"log-48db":new _(zn),"log-60db":new _(Nn),"log-66db":new _(Yn),"log-72db":new _(qn),"log-96db":new _(Xn)};function wt(t){return ii[t&&t.toLowerCase()||"linear"]}var Me=wt("linear"),ke=0,Ae=1;var Le="any",Oe="";function Jn(t,e,r,o){return e.delete(r),o.forEach(i=>e.append(r,i.x+","+i.y)),t.setFormValue(e),e}var Be=[];function Qn(t,e){t.clearRect(e.x,e.y,e.width,e.height)}function Zn(t,e,r,o){t.beginPath();let i=-1;for(;++i<r.length;)t.moveTo(e.x+r[i]*e.width,e.y),t.lineTo(e.x+r[i]*e.width,e.y+e.height);t.lineWidth="1",t.lineCap="round",t.strokeStyle=o,t.setLineDash(Be),t.stroke(),t.closePath()}function tr(t,e,r,o){t.beginPath();let i=-1;for(;++i<r.length;)t.moveTo(e.x,e.y+(1-r[i])*e.height),t.lineTo(e.x+e.width,e.y+(1-r[i])*e.height);t.lineWidth="1",t.lineCap="round",t.strokeStyle=o,t.setLineDash(Be),t.stroke(),t.closePath()}function er(t,e,r,o,i){t.beginPath(),t.moveTo(0,e.y+(1-o.y)*e.height),t.lineTo(e.x+o.x*e.width-r,e.y+(1-o.y)*e.height),t.moveTo(e.x+o.x*e.width+r,e.y+(1-o.y)*e.height),t.lineTo(e.x+e.width+100,e.y+(1-o.y)*e.height),t.moveTo(e.x+o.x*e.width,0),t.lineTo(e.x+o.x*e.width,e.y+(1-o.y)*e.height-r),t.moveTo(e.x+o.x*e.width,e.y+(1-o.y)*e.height+r),t.lineTo(e.x+o.x*e.width,e.y+e.height+100),t.lineWidth="1",t.lineCap="round",t.strokeStyle=i,t.setLineDash(Be),t.stroke(),t.closePath()}function ui(t,e,r){let o=t(e),i=t(r);return i===o?0:o>i?1:-1}var Ce=T(ui,!0);var it=function(){};function nr(t,e){return e.length<t?e:e.slice(0,t-3)+"..."}var Fe=window.console?console.log.bind(console,"%cSoundstage %c%s","color: #e02053; font-weight: 600;","color: #8e9e9d; font-weight: 300;"):it,Qa=window.console?console.groupCollapsed.bind(console,"%cSoundstage %c%s","color: #e02053; font-weight: 600;","color: #8e9e9d; font-weight: 300;"):it,Za=window.console?console.groupEnd.bind(console):it,De=window.console?function(t,e,r="",...o){typeof r=="string"&&(r=nr(48,r)),console.log("%c"+t+" %c"+(e||""),"color: #b5002f; font-weight: 600;","color: #8e9e9d; font-weight: 300;",r,...o)}:it,yt=window.console?function(t,e,r="",...o){typeof r=="string"&&(r=nr(48,r)),console.groupCollapsed("%c"+t+" %c"+(e||""),"color: #b5002f; font-weight: 600;","color: #8e9e9d; font-weight: 300;",r,...o)}:it,vt=window.console?console.groupEnd.bind(console):it;var Ve="idle",rr="cued",or="playing";var zt=!1,ai=Object.assign,ir=Object.defineProperties,ci={context:{writable:!0},startTime:{writable:!0},stopTime:{writable:!0}};function U(t){zt&&yt("mixin ","Playable"),ir(this,ci),this.context=t,zt&&vt()}U.reset=function(t){return t.startTime=void 0,t.stopTime=void 0,t};ai(U.prototype,{start:function(t=this.context.currentTime){if(zt&&this.startTime!==void 0&&(this.stopTime===void 0||t<this.stopTime))throw new Error("Attempt to start a node that is already started");return this.stopTime=void 0,this},stop:function(t=this.context.currentTime){if(zt&&this.startTime===void 0)throw new Error("Attempt to stop a node that has not been started");return this.stopTime=this.startTime===void 0||t>this.startTime?t:this.startTime,this}});ir(U.prototype,{status:{get:function(){return this.startTime!==void 0?this.startTime<=this.context.currentTime?this.stopTime===void 0||this.stopTime>this.context.currentTime?or:Ve:rr:Ve}}});window.AudioContext=window.AudioContext||window.webkitAudioContext;AudioContext.prototype.getOutputTimestamp||(AudioContext.prototype.getOutputTimestamp=function(){return{contextTime:this.currentTime+this.outputLatency,performanceTime:window.performance.now()}});var K=new window.AudioContext;K.destination.channelInterpretation="discrete";K.destination.channelCount=K.destination.maxChannelCount;K.baseLatency===void 0&&(K.baseLatency=256/K.sampleRate);if(K.state==="suspended"){Fe("Audio context suspended","User interaction required");let t=["mousedown","keydown","touchstart","contextmenu"],e=(o,i)=>(document.addEventListener(i,o),o),r=(o,i)=>(document.removeEventListener(i,o),o);t.reduce(e,function o(i){K.resume().then(function(){Fe('Audio context resumed on "'+i.type+'"'),t.reduce(r,o)})})}function li(t,e){return t.contextTime+(e-t.performanceTime)/1e3}function Ie(t,e){var r=t.getOutputTimestamp();return li(r,e)}var P={channelCountLimit:12,basePath:window.soundstageBasePath||"/soundstage/",automationEventsKey:"automationEvents",animationFrameKey:"animationFrame",minExponentialValue:14013e-49,targetDurationFactor:9};var Yt=!1,ur=1e3/60;function pi(t){return window.AudioParam&&window.AudioParam.prototype.isPrototypeOf(t)}function Tt(t){if(Yt&&!pi(t))throw new Error("Not an AudioParam "+JSON.stringify(t));return t[P.automationEventsKey]||(t[P.automationEventsKey]=[])}var ar=v(W(1),{target:function(t){if(t[3]===void 0)throw new Error('Event "target" must have 2 parameters: [time, "target", value, duration]')},hold:function(t){if(t[2]!==void 0)throw new Error('Event "hold" takes 0 parameters: [time, "hold"]')},default:function(t){if(t[2]===void 0)throw new Error('Event "'+t[1]+'" must have 1 parameter: [time, "'+t[1]+'", value]')}});function sr(t,e){t.cancelScheduledValues(e.time),e.curve==="linear"?t.linearRampToValueAtTime(e.value,e.time):e.curve==="exponential"?t.exponentialRampToValueAtTime(e.value,e.time):e.curve==="step"&&t.setValueAtTime(e.value,e.time)}var fi={step:(t,e)=>t.setValueAtTime(e.value,e.time),linear:(t,e)=>t.linearRampToValueAtTime(e.value,e.time),exponential:(t,e)=>t.exponentialRampToValueAtTime(e.value,e.time),target:(t,e)=>t.setTargetAtTime(e.value,e.time,e.duration),curve:(t,e)=>t.setValueCurveAtTime(e.value,e.time,e.duration),hold:AudioParam.prototype.cancelAndHoldAtTime?function(e,r,o){if(o&&o.curve==="target")return sr(e,r);e.cancelAndHoldAtTime(r.time)}:sr},hi=v(b,{exponential:(t,e,r,o,i,s)=>{let u={time:i,value:Math.fround(s)};return u.value<=P.minExponentialValue?(u.time=r?r.time:0,u.curve="step"):r&&r.value<P.minExponentialValue?u.curve="step":u.curve="exponential",u},hold:function(t,e,r,o,i){return o&&o.curve==="linear"?{time:i,curve:"linear",value:Math.fround(He(r,o,i))}:o&&o.curve==="exponential"?{time:i,curve:"exponential",value:Math.fround(He(r,o,i))}:r&&r.curve==="target"?{time:i,curve:"step",value:bt(e,i)}:{time:i}},target:(t,e,r,o,i,s,u)=>({time:i,curve:"target",value:Math.fround(s),duration:u}),default:(t,e,r,o,i,s,u)=>({time:i,curve:t,value:Math.fround(s)})}),di=gt({hold:function(t,e,r,o){r.length=o+1,e.curve&&r.push(e)},default:function(t,e,r,o){if(!t){r.push(e);return}if(t.time===e.time){for(;r[++o]&&r[o].time===e.time;)if(r[o].curve===e.curve){r.splice(o,1,e);return}r.splice(o,0,e);return}r.splice(o+1,0,e)}});function cr(t,e,r,o,i,s){for(var u=e.length;e[--u]&&e[u].time>=r;);let c=e[u],l=e[u+1],f=hi(o,t,c,l,r,i,s);fi[o](t,f,l),di(o,l,f,e,u)}function Ge(t,e,r,o,i,s,u){if(r==="target"&&i===void 0)throw new Error('Automation curve "target" must have a duration');let c=Tt(t);if(cr(t,c,e,r,o,i),!s){Yt&&console.warn("No notify for param change",o,r,t);return}if(!u){Yt&&console.warn("No context for param change",o,r,t);return}if(t[P.animationFrameId])return;var l=-1;function f(h){if(l=(l+1)%3,l===0){t[P.animationFrameId]=requestAnimationFrame(f);return}let d=h+ur,y=Ie(u,d),a=bt(t,y),m=c[c.length-1];t[P.animationFrameId]=m&&y<=m.time?requestAnimationFrame(f):void 0,s(t,"value",a)}t[P.animationFrameId]=requestAnimationFrame(f)}function lr(t,e,r,o,i,s,u){if(o==="target"&&s===void 0)throw new Error('Automation curve "target" must have a duration');let c=t[e],l=Tt(c);if(cr(c,l,r,o,i,s),!u){Yt&&console.warn("No notify for param change",i,o,c);return}if(c[P.animationFrameId])return;var f=-1;function h(d){if(f=(f+1)%3,f===0){c[P.animationFrameId]=requestAnimationFrame(h);return}let y=d+ur,a=Ie(t.context,y),m=bt(c,a),w=l[l.length-1];c[P.animationFrameId]=w&&a<=w.time?requestAnimationFrame(h):void 0,u(t,e,m)}c[P.animationFrameId]=requestAnimationFrame(h)}var pr={step:function(e,r,o,i,s){return s<i?e:r},linear:function(e,r,o,i,s){return e+(r-e)*(s-o)/(i-o)},exponential:function(e,r,o,i,s){return e*Math.pow(r/e,(s-o)/(i-o))},target:function(e,r,o,i,s,u){return s<i?e:r+(e-r)*Math.pow(Math.E,(i-s)/u)},curve:function(t,e,r,o,i,s){}};function He(t,e,r){return pr[e.curve](t.value,e.value,t.time,e.time,r,t.duration)}function Nt(t,e,r){var o=t[e];return o.curve==="target"?pr.target(Nt(t,e-1,o.time),o.value,0,o.time,r,o.duration):o.value}function mi(t,e){for(var r=t.length;t[--r]&&t[r].time>=e;);var o=t[r],i=t[r+1];if(!o)return 0;if(!i)return Nt(t,r,e);if(i.time===e){for(;t[++r]&&t[r].time===e;);return Nt(t,r-1,e)}if(e<i.time)return i.curve==="linear"||i.curve==="exponential"?He(o,i,e):Nt(t,r,e)}function bt(t,e){var r=Tt(t);return!r||r.length===0?t.value:Math.fround(mi(r,e))}var st=!1;function je(t,e,r,o){r&&r.setValueAtTime||(t[e]&&t[e].setValueAtTime?(st&&De("param",e+":",r),Tt(t[e]).length=0,lr(t,e,t.context.currentTime,"step",r,null,o)):t[e]&&t[e].connect?gi(t[e],r):(st&&De("prop",e+" =",r),t[e]=r))}function gi(t,e,r,o){st&&yt("assign",t.constructor.name,r?Object.keys(r).join(", "):"");let i={};if(r)for(let s in r)o&&o.indexOf(s)>-1||r[s]&&r[s].setValueAtTime||t.hasOwnProperty(s)&&r[s]!==void 0&&(je(t,s,r[s]),i[s]=!0);for(let s in e)o&&o.indexOf(s)>-1||i[s]||je(t,s,e[s]);st&&vt()}function fr(t,e,r){st&&yt("assign",t.constructor.name,e?Object.keys(e).join(", "):"");var o;for(o in e)r&&r.indexOf(o)>-1||e[o]&&e[o].setValueAtTime||(t[o]||t.hasOwnProperty(o))&&e[o]!==void 0&&je(t,o,e[o]);return st&&vt(),t}var wi=Object.assign,mr=Object.defineProperties,yi=Object.getOwnPropertyDescriptor,hr=P.targetDurationFactor,vi={attack:{writable:!0,enumerable:!0},release:{writable:!0,enumerable:!0},gain:{writable:!0,enumerable:!0},rate:{writable:!0,enumerable:!0}},Ti={attack:[[.008,"linear",1]],release:[[.008,"linear",0]],offset:0,gain:1,rate:1};function dr(t,e,r,o,i){var s;Ge(t,r,"hold");for(s of e)ar(s),Ge(t,r+s[0]/i,s[1],s[2]*o,s[3])}var Et=class extends ConstantSourceNode{constructor(e,r){super(e);super.start.call(this,e.currentTime),U.call(this,e),mr(this,vi),fr(this,wi({},Ti,r))}start(e){if(!this.attack||this.attack.length===0)return this;U.prototype.start.apply(this,arguments),dr(this.offset,this.attack,this.startTime,this.gain,this.rate,"ConstantSource.offset");let r=G(this.attack);return r[2]===0&&(this.stopTime=e+(r[1]==="target"?r[0]+r[3]*hr:r[0])),this}stop(e){if(!this.release||this.release.length===0)return this;U.prototype.stop.apply(this,arguments);let r=bt(this.offset,this.stopTime);dr(this.offset,this.release,this.stopTime,r,this.rate,"ConstantSource.offset");let o=G(this.release);return o[2]!==0?(console.warn("Envelope.release does not end with value 0. Envelope will never stop.",this),this.stopTime=1/0):this.stopTime+=o[1]==="target"?o[0]+o[3]*hr:o[0],this}};mr(Et.prototype,{playing:yi(U.prototype,"playing")});var qt=4,bi=[],Ei=[2,6];function gr(t,e,r,o,i){let s=0;for(t.beginPath(),t.moveTo(e.x+s/r,e.y+(1-o[0])*e.height);++s<o.length;)t.lineTo(e.x+s/r,e.y+(1-o[s])*e.height);t.strokeStyle=i,t.lineWidth="2",t.lineCap="round",t.setLineDash(bi),t.stroke(),t.lineTo(e.x+e.width,e.y+e.height),t.lineTo(e.x,e.y+e.height),t.fillStyle=i+"2b",t.fill(),t.closePath()}function wr(t,e,r,o){let i=-1,s=18;for(t.beginPath();++i<r.length;)r[i].type==="target"&&(t.moveTo(e.x+r[i].x*e.width,e.y+(1-(r[i-1]?r[i-1].y:0))*e.height),t.lineTo(e.x+r[i].x*e.width,e.y+(1-r[i].y)*e.height+((r[i-1]?r[i-1].y:0)>r[i].y?-s:s)),t.moveTo(e.x+r[i].x*e.width+s,e.y+(1-r[i].y)*e.height),t.lineTo(e.x+(r[i+1]?r[i+1].x:1)*e.width,e.y+(1-r[i].y)*e.height));t.lineWidth="2",t.lineCap="round",t.strokeStyle=o,t.setLineDash(Ei),t.stroke(),t.closePath()}function yr(t,e,r,o,i,s,u,c,l,f,h,d){let y=qt*e.width/r.width,a=new OfflineAudioContext(1,qt*e.width,22050),m=new Et(a,{attack:f.map(w=>w.type==="target"?[w.x*y/22050,w.type,w.y,w.duration*y/22050]:w.type?[w.x*y/22050,w.type,w.y]:[w.x*y/22050,"step",w.y])});return m.connect(a.destination),m.start(r.x,"attack"),m.stop(r.width),t.activeRenders=t.activeRenders?t.activeRenders+1:1,t.cacheddata&&gr(t,e,qt,t.cacheddata,h),t.cacheddata&&wr(t,e,f.map(w=>({x:o.normalise(i,s,w.x),y:u.normalise(c,l,w.y),type:w.type,duration:w.duration})).sort(Ce(W("x"))),h),a.startRendering().then(w=>{if(--t.activeRenders)return;d();let V=w.getChannelData(0).map(I=>u.normalise(c,l,I));gr(t,e,qt,V,h),wr(t,e,f.map(I=>({x:o.normalise(i,s,I.x),y:u.normalise(c,l,I.y),type:I.type,duration:I.duration})).sort(Ce(W("x"))),h),t.cacheddata=V})}function xi(t){t.stop()}function Si(t,e){return t&&t.stop(),Ct(".",e)}function Tr(t,e,r,o,i,s){let u=Wt(t),c=H(e["font-size"]),l=H(e.borderLeftWidth)||0,f=H(e.borderTopWidth)||0,h=H(e.borderRightWidth)||0,d=H(e.borderBottomWidth)||0,y=H(e.paddingLeft)||0,a=H(e.paddingTop)||0,m=H(e.paddingRight)||0,w=H(e.paddingBottom)||0;return r.x=u.x+l+y,r.y=u.y+f+a,r.width=u.width-l-y-h-m,r.height=u.height-f-a-d-w,o.x=0,o.y=0,o.width=u.width-l-h,o.height=u.height-f-d,i.x=y,i.y=a,i.width=u.width-l-y-h-m,i.height=u.height-f-a-d-w,s.x=0,s.width=i.width/c,s.y=0,s.height=-i.height/c,u}function Pi(t,e,r,o,i,s){s.box=Tr(t,r,s.pxbox,s.paddingbox,s.contentbox,s.rangebox),o.width=s.paddingbox.width*2,o.height=s.paddingbox.height*2,e.setProperty("--range-x",s.rangebox.x),e.setProperty("--range-y",s.rangebox.y),e.setProperty("--range-width",s.rangebox.width),e.setProperty("--range-height",s.rangebox.height),i.setAttribute("viewBox",s.rangebox.x+" "+(s.rangebox.y+s.rangebox.height)+" "+s.rangebox.width+" "+-s.rangebox.height)}function Mi(t,e){let r=e.pxbox,o=e.valuebox,i=t.clientX-r.x-e.offset.x,s=r.height-(t.clientY-r.y-e.offset.y);e.x=at(o.x,o.x+o.width,F(o.x,o.x+o.width,i/r.width)),e.y=at(o.y,o.y+o.height,F(o.y,o.y+o.height,s/r.height))}var ki=v((t,e)=>e.type,{pointerdown:(t,e)=>{t.target=e.target,t.time=e.timeStamp/1e3,t.previous&&t.previous.type==="tap"&&t.time-t.previous.time<$n&&(t.type="double-tap",t.target=t.previous.target);let r=Wt(e.target);return t.offset=e.target===e.currentTarget?{x:0,y:0}:{x:e.clientX-(r.x+r.width/2),y:e.clientY-(r.y+r.height/2)},t.events.length=0,t.events.push(e),t},pointermove:(t,e)=>{t.events.push(e);let r=t.events[0];return e.timeStamp-r.timeStamp<Se&&e.clientX-r.clientX<4&&e.clientY-r.clientY<4||(t.type="move",Mi(e,t)),t},default:(t,e)=>(t.events.push(e),t.duration=e.timeStamp/1e3-t.time,!t.type&&t.duration<Se&&(t.type="tap"),t)}),Ai=de({".duration-handle":v((t,e)=>e.type,{pointermove:function(t,e){let r=F[e.yTransform](e.yMin,e.yMax,-e.y);return scope[3]=e.x<=scope[0]?minExponential:e.x-scope[0],scope[2]=r,e},default:M}),".control-handle":v((t,e)=>e.type,{tap:function(t,e){return e.scope=scope,e},"double-tap":function(t,e){let r=e.previous.scope;return ct(e.collection,r),e},move:function(t,e){let{internals:r,formdata:o,events:i,host:s,value:u,x:c,y:l}=e,f=t.dataset.index,h=ot(u[f]);return h.x=c,h.y=l,G(i).type!=="pointermove"?(Jn(r,o,s.name,u),Dt("change",s)):Dt("input",s),e},default:function(t){console.log("Untyped gesture",t)}}),"*":v((t,e)=>e.type,{"double-tap":function(t){let e=t.x,r=F[t.yTransform](t.yMin,t.yMax,-t.y);return insert(getTime,t.collection,[e,"step",r]),Tn(t.collection,".",t.collection),t},default:M})});function Xt(t,e){let r=t.getPropertyValue(e).trim();return r==="none"?void 0:r}function Re(t,e,r,o,i,s,u,c,l=!0){let f={x:o.x*2,y:o.y*2,width:o.width*2,height:o.height*2},h=Xt(r,"--line-color-x"),d=Xt(r,"--line-color-y"),y=Xt(r,"--crosshair-color"),a=Xt(r,"--envelope-color");Qn(e,{x:0,y:0,width:t.width,height:t.height}),h&&Zn(e,f,s.ticks.filter(m=>i.x+i.width>=m.value&&m.value>=i.x).map(m=>m.normalValue),h),d&&tr(e,f,u.ticks.filter(m=>i.y+i.height>=m.value&&m.value>=i.y).map(m=>m.normalValue),d),y&&c&&c.length&&c.forEach(m=>er(e,f,28,{x:s.scale.normalise(s.min,s.max,m.x),y:u.scale.normalise(u.min,u.max,m.y)},y)),a&&l&&c&&c.length&&yr(e,f,i,s.scale,s.min,s.max,u.scale,u.min,u.max,c,a,()=>Re(t,e,r,o,i,s,u,c,!1))}function Li(t,e,r){return t.push(C("label",{part:r+"-tick tick",style:"--normal-"+r+": "+e.normalValue+";",html:"<span>"+e.label+"</span>"})),t}function br(t,e,r,o,i,s,u,c,l,f){t.setAttribute("transform","translate("+F(e.x,e.x+e.width,r.normalise(o,i,l.x))+" "+F(e.y,e.y+e.height,s.normalise(u,c,l.y))+")"),t.firstElementChild.innerHTML=(l.label?l.label+" ":"")+l.x+", "+l.y,t.dataset.index=f}function Oi(t,e,r,o,i,s,u,c,l){return C("path",{part:"handle",class:"control control-handle control-point",d:"M 0 0 m -0.5 0 a 0.5 0.5 0 1 0 1 0 a 0.5 0.5 0 1 0 -1 0",transform:"translate("+F(t.x,t.x+t.width,e.normalise(r,o,c.x))+" "+F(t.y,t.y+t.height,i.normalise(s,u,c.y))+")",html:"<title>"+(c.label?c.label+" ":"")+c.x+", "+c.y+"</title>",data:{index:l}})}function Bi(t,e,r,o,i,s){let u=-1,c,l;for(;c=s[++u];)t[u]?(l=t[u],br(l,r,o.scale,o.min,o.max,i.scale,i.min,i.max,c,u)):(l=Oi(r,o.scale,o.min,o.max,i.scale,i.min,i.max,c,u),t.push(l),e.append(l));for(--u;l=t[++u];)l.remove()}function vr(t,e,r,o,i,s,u,c,l){e.setProperty("--"+t+"-normal-zero",r.normalise(o,i,0)),c.forEach(f=>f.remove()),c.length=0,c=s.reduce((f,h)=>Li(f,h,t),c),l.after.apply(l,c)}var Er={construct:function(t,e){let r=C("style",":host {} :host > * { visibility: hidden; }"),o=C("label",{for:"input",html:"<slot></slot>",part:"label"}),i=C("canvas"),s=C("svg"),u=C("text",""),c=C("text",""),l=[],f=[],h=[],d=[],y=[];t.append(r,o,i,s,u,c);let a=k(this),m={value:[]},w=getComputedStyle(this),V=r.sheet.cssRules[0].style,I=r.sheet.cssRules[1].style,ut=i.getContext("2d"),$t=new FormData;a.host=this,a.hostStyle=V,a.childStyle=I,a.internals=e,a.data=m,a.ctx=ut,a.formdata=$t,a.shadow=new Promise(g=>a.load=g),a.pxbox={},a.paddingbox={},a.contentbox={},a.rangebox={x:0,y:6.75,width:6.75,height:-6.75},a.valuebox={x:0,y:0,width:1,height:1},a.xscale=p.of(Me),a.xmin=p.of(ke),a.xmax=p.of(Ae),a.xstep=p.of(Le),a.xticks=p.of(null),a.xdisplay=p.of(Oe),a.yscale=p.of(Me),a.ymin=p.of(ke),a.ymax=p.of(Ae),a.ystep=p.of(Le),a.yticks=p.of(null),a.ydisplay=p.of(Oe),a.value=p.of([{x:0,y:0,type:"step"}]);let Kt=p.merge(a.shadow,me("resize",window)).broadcast();Kt.each(()=>Pi(this,V,w,i,s,a));let Jt=p.combine({shadow:a.shadow,scale:a.xscale,min:a.xmin,max:a.xmax,ticks:a.xticks,step:a.xstep,display:a.xdisplay}).scan(be,{}).broadcast(),Qt=p.combine({shadow:a.shadow,scale:a.yscale,min:a.ymin,max:a.ymax,ticks:a.yticks,step:a.ystep,display:a.ydisplay}).scan(be,{}).broadcast();Jt.each(g=>{a.valuebox.x=g.min,a.valuebox.width=g.max-g.min}),Qt.each(g=>{a.valuebox.y=g.min,a.valuebox.height=g.max-g.min}),Jt.each(g=>vr("x",V,g.scale,g.min,g.max,g.ticks,l,h,u)),Qt.each(g=>vr("y",V,g.scale,g.min,g.max,g.ticks,f,d,c));let Ue=a.value.scan(Si,null).flatMap(b).broadcast();p.combine({xaxis:Jt,yaxis:Qt,resizes:Kt,value:Ue}).each(g=>{a.state=g,Re(i,ut,w,a.contentbox,a.valuebox,g.xaxis,g.yaxis,g.value),Bi(y,s,a.rangebox,g.xaxis,g.yaxis,g.value)}),a.valueObservers=Ue.reduce((g,Pr)=>(g.forEach(xi),g.push.apply(g,Pr.map((ze,Ne,Mr)=>Ct(".",ze,ze).each(kr=>{let Ar=s.querySelectorAll("[part=handle]")[Ne];Re(i,ut,w,a.contentbox,a.valuebox,a.state.xaxis,a.state.yaxis,Mr),br(Ar,a.rangebox,a.state.xaxis.scale,a.state.xaxis.min,a.state.xaxis.max,a.state.yaxis.scale,a.state.yaxis.min,a.state.yaxis.max,kr,Ne)}))),g),[]),Te({select:"[part=handle]",threshold:1},t).each(g=>{Tr(this,w,a.pxbox,a.paddingbox,a.contentbox,a.rangebox),g.scan(ki,{handles:y,internals:e,host:this,pxbox:a.pxbox,valuebox:a.valuebox,formdata:a.formdata,value:a.state.value,events:[]}).filter(W("type")).each(Ai)})},load:function(t){let e=k(this);e.childStyle.visibility="",e.load(t)}};function z(t,e,r=b){return{attribute:function(o){let i=k(this),s=r(o||e);i[t].push(s)}}}function xt(t,e,r=b){return{attribute:function(o){this[t]=o},set:function(o){let i=k(this),s=r(o===void 0?e:o);i[t].push(s)},get:function(){return k(this).data[t]},enumerable:!0}}function xr(t){return{attribute:function(e){k(this)[t].push(!!e)}}}function Ci(t,e){let r=t[t.length-1];return r&&r.y===void 0?r.y=D(e):r&&r.type==="target"&&r.duration===void 0?r.duration=D(e):r&&!/^-?\d/.test(e)?r.type=e:t.push({x:D(e)}),t}function We(t){return t.split(/\s*,\s*|\s+/).reduce(Ci,[])}function Fi(t){return t.x+" "+t.y+(t.label?" "+t.label:"")}function _e(t){return t.map(Fi).join(", ")}var Sr={xmin:xt("xmin",0,D),xmax:xt("xmax",1,D),ymin:xt("ymin",0,D),ymax:xt("ymax",1,D),xscale:z("xscale","linear",wt),yscale:z("yscale","linear",wt),xticks:z("xticks","",et),yticks:z("yticks","",et),xstep:z("xstep"),ystep:z("ystep"),xdisplay:z("xdisplay"),ydisplay:z("ydisplay"),valuebox:{attribute:function(t){}},ordered:xr("ordered"),value:{attribute:function(t){this.value=t},get:function(){let t=k(this);return _e(t.state.value)},set:function(t){k(this).value.push(typeof t=="string"?We(t):tt(t))},enumerable:!0},data:{get:function(){let t=k(this);return ot(t.state.value)},set:function(t){k(this).value.push(tt(t))},enumerable:!0}};var Di=window.xyInputStylesheet||import.meta.url.replace(/\/[^\/]*([?#].*)?$/,"/")+"shadow.css",Pl=re("<xy-input>",Er,Sr,Di);export{Pl as default};
