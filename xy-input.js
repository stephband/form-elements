/* form-elements 
   0.0.4
   By Stephen Band
   Built 2023-03-21 15:16 */

var Ue=Object.getOwnPropertySymbols;var Pr=Object.prototype.hasOwnProperty,Mr=Object.prototype.propertyIsEnumerable;var ze=(t,e)=>{var r={};for(var o in t)Pr.call(t,o)&&e.indexOf(o)<0&&(r[o]=t[o]);if(t!=null&&Ue)for(var o of Ue(t))e.indexOf(o)<0&&Mr.call(t,o)&&(r[o]=t[o]);return r};function b(t){return t}function v(t,e){return function(){let o=t.apply(this,arguments),i=e[o]||e.default;if(!i)throw new Error('overload() no handler for "'+o+'"');return i.apply(this,arguments)}}function nt(t){var e=new Map;return function(o){if(e.has(o))return e.get(o);var i=t(o);return e.set(o,i),i}}var kr=Array.prototype;function Ar(t,e){return typeof t=="function"?t.apply(null,e):t}function Ne(t,e,r){r=r||t.length;var o=r===1?e?t:nt(t):nt(function(i){return Ne(function(){var s=[i];return s.push.apply(s,arguments),t.apply(null,s)},e,r-1)});return function i(s){return arguments.length===0?i:arguments.length===1?o(s):arguments.length>=r?t.apply(null,arguments):Ar(o(s),kr.slice.call(arguments,1))}}var T=Ne;function P(){}var Lr=v(b,{is:P,tag:P,data:function(t,e,r){Object.assign(e.dataset,r)},html:function(t,e,r){e.innerHTML=r},text:function(t,e,r){e.textContent=r},children:function(t,e,r){e.innerHTML="",e.append.apply(e,r)},points:K,cx:K,cy:K,r:K,transform:K,preserveAspectRatio:K,viewBox:K,default:function(t,e,r){t in e?e[t]=r:e.setAttribute(t,r)}});function K(t,e,r){e.setAttribute(t,r)}function Or(t,e){for(var r=Object.keys(e),o=r.length;o--;)Lr(r[o],t,e[r[o]]);return t}var Et=T(Or,!0);var Jt="http://www.w3.org/2000/svg",Ye=document.createElement("template"),Qt=(t,e)=>e&&typeof e;function qe(t,e){let r=document.createRange();return r.selectNode(t),r.createContextualFragment(e)}var A=v(Qt,{string:function(t,e){let r=document.createElementNS(Jt,t);return r.innerHTML=e,r},object:function(t,e){let r=document.createElementNS(Jt,t);return typeof e.length=="number"?r.append.apply(r,e):Et(r,e),r},default:t=>document.createElementNS(Jt,t)}),Br=v(Qt,{string:function(t,e){let r=document.createElement(t);return r.innerHTML=e,r},object:function(t,e){let r=document.createElement(t);return typeof e.length=="number"?r.append.apply(r,e):Et(r,e),r},default:t=>document.createElement(t)}),Cr=v(b,{comment:function(t,e){return document.createComment(e||"")},fragment:v(Qt,{string:function(t,e,r){return r?qe(r,e):(Ye.innerHTML=e,Ye.content.cloneNode(!0))},object:function(t,e,r){let o=r?qe(r):document.createDocumentFragment();return typeof e.length=="number"?o.append.apply(o,e):Et(o,e),o},default:()=>document.createDocumentFragment()}),text:function(t,e){return document.createTextNode(e||"")},circle:A,ellipse:A,g:A,glyph:A,image:A,line:A,rect:A,use:A,path:A,pattern:A,polygon:A,polyline:A,svg:A,default:Br}),B=Cr;function Zt(t,e,r){let o;typeof r!="string"&&r.input!==void 0&&r.index!==void 0&&(o=r,r=o.input.slice(r.index+r[0].length+(r.consumed||0)));let i=t.exec(r);if(!i)return;let s=e(i);return o&&(o.consumed=(o.consumed||0)+i.index+i[0].length+(i.consumed||0)),s}var te=T(Zt,!0);function Fr(t,e,r){throw r.input!==void 0&&r.index!==void 0&&(r=r.input),new Error('Cannot parse string "'+(r.length>128?r.length.slice(0,128)+"…":r)+'"')}function Dr(t,e,r){let o=-1;for(;++o<r.length;)e=r[o]!==void 0&&t[o]?t[o](e,r):e;return t.done?t.done(e,r):t.close?t.close(e,r):e}function Vr(t,e,r,o){let i=Zt(t,s=>Dr(e,r,s),o);return i===void 0?e.catch?e.catch(r,o):Fr(t,e,o):i}var xt=T(Vr,!0);var L=Symbol("internals"),J=Symbol("shadow"),Xe=Object.defineProperties,Ir={a:HTMLAnchorElement,article:HTMLElement,dl:HTMLDListElement,p:HTMLParagraphElement,br:HTMLBRElement,fieldset:HTMLFieldSetElement,hr:HTMLHRElement,img:HTMLImageElement,li:HTMLLIElement,ol:HTMLOListElement,optgroup:HTMLOptGroupElement,q:HTMLQuoteElement,section:HTMLElement,textarea:HTMLTextAreaElement,td:HTMLTableCellElement,th:HTMLTableCellElement,tr:HTMLTableRowElement,tbody:HTMLTableSectionElement,thead:HTMLTableSectionElement,tfoot:HTMLTableSectionElement,ul:HTMLUListElement},Hr={name:{set:function(t){return this.setAttribute("name",t)},get:function(){return this.getAttribute("name")||""}},form:{get:function(){return this[L].form}},labels:{get:function(){return this[L].labels}},validity:{get:function(){return this[L].validity}},validationMessage:{get:function(){return this[L].validationMessage}},willValidate:{get:function(){return this[L].willValidate}},checkValidity:{value:function(){return this[L].checkValidity()}},reportValidity:{value:function(){return this[L].reportValidity()}}},jr={},$e={once:!0},Ke=0,Je=!1;function Gr(t){return Ir[t]||window["HTML"+t[0].toUpperCase()+t.slice(1)+"Element"]||(()=>{throw new Error('Constructor not found for tag "'+t+'"')})()}var Rr=xt(/^\s*<?([a-z][\w]*-[\w-]+)>?\s*$|^\s*<?([a-z][\w]*)\s+is[=\s]*["']?([a-z][\w]*-[\w]+)["']?>?\s*$/,{1:(t,e)=>({name:e[1]}),2:(t,e)=>({name:e[3],tag:e[2]}),catch:function(t,e){throw new SyntaxError(`dom element() – name must be of the form 'element-name' or 'tag is="element-name"' (`+e+")")}},null);function Wr(t,e){if(t.hasOwnProperty(e)){let r=t[e];delete t[e],t[e]=r}return t}function Qe(t,e,r){t._initialLoad=!0;let o=t.attachShadow({mode:e.mode||"closed",delegatesFocus:e.focusable||!1});if(r){let i=B("link",{rel:"stylesheet",href:r});o.append(i)}return t[J]=o,o}function _r(t){var e;if(t.attachInternals){if(e=t.attachInternals(),e.setFormValue)return e}else e={shadowRoot:t.shadowRoot};return e.input=B("input",{type:"hidden",name:t.name}),t.appendChild(e.input),e.setFormValue=function(r){this.input.value=r},e}function Ur(t){return!!t.attribute}function zr(t){return t.set||t.get||t.hasOwnProperty("value")}function Nr(t,e){return Ur(e[1])&&(t.attributes[e[0]]=e[1].attribute),zr(e[1])&&(t.properties[e[0]]=e[1]),t}function ee(t,e,r,o,i=""){let{name:s,tag:u}=Rr(t),c=typeof u=="string"?Gr(u):HTMLElement,{attributes:l,properties:f}=r?Object.entries(r).reduce(Nr,{attributes:{},properties:{}}):jr;function h(){let d=Reflect.construct(c,arguments,h),y=e.construct&&e.construct.length>Ke?Qe(d,e,o||e.stylesheet):void 0,a=h.formAssociated?_r(d):{};return u&&(Je=!0),e.construct&&e.construct.call(d,y,a),f&&Object.keys(f).reduce(Wr,d),d}return h.prototype=Object.create(c.prototype,f),f.value&&(h.formAssociated=!0,Xe(h.prototype,Hr),(e.enable||e.disable)&&(h.prototype.formDisabledCallback=function(d){return d?e.disable&&e.disable.call(this,this[J],this[L]):e.enable&&e.enable.call(this,this[J],this[L])}),e.reset&&(h.prototype.formResetCallback=function(){return e.reset.call(this,this[J],this[L])}),e.restore&&(h.prototype.formStateRestoreCallback=function(){return e.restore.call(this,this[J],this[L])})),l&&(h.observedAttributes=Object.keys(l),h.prototype.attributeChangedCallback=function(d,y,a){return l[d].call(this,a)}),h.prototype.connectedCallback=function(){let d=this,y=d[J],a=d[L];if(d._initialLoad){let m=y.querySelectorAll('link[rel="stylesheet"]');if(m.length){let w=0,F=m.length,D=function(Xt){++w>=m.length&&(delete d._initialLoad,e.load&&e.load.call(d,y))},st=D;for(;F--;)m[F].addEventListener("load",D,$e),m[F].addEventListener("error",st,$e)}else e.load&&Promise.resolve(1).then(()=>e.load.call(this,y,a))}e.connect&&e.connect.call(this,y,a)},e.disconnect&&(h.prototype.disconnectedCallback=function(){return e.disconnect.call(this,this[J],this[L])}),window.console&&window.console.log("%c<"+(u?u+" is="+s:s)+">%c "+i,"color: #3a8ab0; font-weight: 600;","color: #888888; font-weight: 400;"),window.customElements.define(s,h,u&&{extends:u}),u&&!Je&&document.querySelectorAll('[is="'+s+'"]').forEach(d=>{f&&Xe(d,f);let y=e.construct&&e.construct.length>Ke?Qe(d,e,o||e.stylesheet):void 0;e.construct&&e.construct.call(d,y);let a;for(a in l){let m=d.attributes[a];m&&l[a].call(d,m.value)}e.connect&&e.connect.apply(d)}),h}var ne=Symbol("privates");function M(t){return t[ne]||Object.defineProperty(t,ne,{value:{}})[ne]}function ut(t,e,r){return r>e?e:r<t?t:r}var us=T(ut);function re(t){return function(){return arguments[t]}}function O(){return this}var Yr=Object.create,qr=Object.freeze;function Xr(){return!0}function Ze(){return-1}var j=qr(Yr({shift:P,push:P,forEach:P,join:function(){return""},every:Xr,filter:O,find:P,findIndex:Ze,flat:O,flatMap:O,includes:function(){return!1},indexOf:Ze,map:O,reduce:re(1),sort:O,each:O,pipe:b,start:O,stop:O,done:O,valueOf:function(){return null}},{length:{value:0}}));function at(t,e){t.remove&&t.remove(e);let r;for(;(r=t.indexOf(e))!==-1;)t.splice(r,1);return t}var ws=T(at,!0);function oe(t){return t&&t[Symbol.iterator]}var $r=Object.assign;function Kr(t){return t.stop?t.stop():t()}function ct(){}$r(ct.prototype,{stop:function(){let t=this.stopables;return this.stopables=void 0,t&&t.forEach(Kr),this},done:function(t){return(this.stopables||(this.stopables=[])).push(t),this}});var G=Object.assign,z=Object.create;function lt(t,e){t[0]=e,e.done(t)}function tn(t,e){let r=t[e].stopables;r&&at(r,t),t[e]=void 0}function E(t,e){t&&t.push(e)}function x(t){ct.prototype.stop.apply(t);let e=-1,r;for(;r=t[++e];)t[e]=void 0,r.stop()}function en(t){return p.prototype.isPrototypeOf(t)}function p(t){this.input=t}G(p.prototype,ct.prototype,{push:function(t){E(this[0],t)},pipe:function(t){if(this[0])throw new Error("Stream: Attempt to .pipe() a unicast stream multiple times. Create a multicast stream with .broadcast().");return this[0]=t,t.done(this),this.input.pipe(this),t},map:function(t){return new nn(this,t)},filter:function(t){return new rn(this,t)},split:function(t){return new sn(this,t)},flatMap:function(t){return new on(this,t)},slice:function(t,e){return new ie(this,t,e)},take:function(t){return console.warn(".take(a) superseded by .slice(0, a)"),new ie(this,0,t)},each:function(t){return this.pipe(new cn(t))},reduce:function(t,e){return this.pipe(new un(t,e)).value},scan:function(t,e){return new an(this,t,e)},stop:function(){return x(this),this}});function nn(t,e){this.input=t,this.fn=e}nn.prototype=G(z(p.prototype),{push:function(e){let o=this.fn(e);o!==void 0&&E(this[0],o)}});function rn(t,e){this.input=t,this.fn=e}rn.prototype=G(z(p.prototype),{push:function(e){this.fn(e)&&E(this[0],e)}});function on(t,e){this.input=t,this.fn=e}on.prototype=G(z(p.prototype),{push:function(e){let o=this.fn(e);if(o!==void 0)if(oe(o))for(let i of o)E(this[0],i);else o.pipe&&this.done(o.each(i=>E(this[0],i)))}});function sn(t,e){this.input=t,this.chunk=[],typeof n=="number"?this.n=e:this.fn=e}sn.prototype=G(z(p.prototype),{fn:function(){return this.chunk.length===this.n},push:function(e){let r=this.chunk;this.fn(e)?(E(this[0],r),this.chunk=[]):r.push(e)}});function ie(t,e,r=1/0){this.input=t,this.index=-e,this.indexEnd=e+r}ie.prototype=G(z(p.prototype),{push:function(e){++this.index>0&&this[0].push(e),this.index===this.indexEnd&&this.stop()}});function un(t,e){this.fn=t,this.value=e,this.i=0}un.prototype=G(z(p.prototype),{push:function(t){let e=this.fn;this.value=e(this.value,t,this.i++,this)}});function an(t,e,r){this.input=t,this.fn=e,this.value=r}an.prototype=G(z(p.prototype),{push:function(t){let e=this.fn;this.value=e(this.value,t),this[0].push(this.value)}});function cn(t){this.push=t}cn.prototype=G(z(p.prototype),{each:null,reduce:null,pipe:null});var Jr=Object.assign,Qr=Object.create;function Zr(t,e){if(t[1]){let r=-1;for(;t[++r]&&t[r]!==e;);for(;t[r++];)t[r-1]=t[r]}else t.stop()}function pt(t,e){p.apply(this,arguments),this.memory=!!(e&&e.memory),e&&e.hot&&this.pipe(j)}pt.prototype=Jr(Qr(p.prototype),{push:function(t){if(t===void 0)return;this.memory&&(this.value=t);let e=-1;for(;this[++e];)this[e].push(t)},pipe:function(t){let e=-1;for(;this[++e];);return this.memory&&e===0&&this.input.pipe(this),this[e]=t,t.done(()=>Zr(this,t)),this.value!==void 0&&t.push(this.value),!this.memory&&e===0&&this.input.pipe(this),t}});var to=Array.prototype,eo=Object.assign,no=Object.create;function ro(t){return t!==void 0}function ft(t){this.buffer=t?t.filter?t.filter(ro):t:[]}ft.prototype=eo(no(p.prototype),{push:function(t){t!==void 0&&E(this.buffer,t)},pipe:function(t){for(t.done(this),this[0]=t;this.buffer.length;)E(this[0],to.shift.apply(this.buffer));return this.buffer=t,t},stop:function(){return this.buffer=void 0,x(this),this}});var ln=Object.assign,oo=Object.create,io=Promise.resolve(),so={schedule:function(){io.then(this.fire)},unschedule:P},uo={schedule:function(){this.timer=requestAnimationFrame(this.fire)},unschedule:function(){cancelAnimationFrame(this.timer),this.timer=void 0}},ao={schedule:function(){this.timer=setTimeout(this.fire,this.duration*1e3)},unschedule:function(){clearTimeout(this.timer),this.timer=void 0}};function Q(t,e){p.apply(this,arguments),this.duration=e,this.timer=void 0,this.fire=()=>{this.timer=void 0,this.output.stop()},ln(this,e==="tick"?so:e==="frame"?uo:ao)}Q.prototype=ln(oo(p.prototype),{push:function(t){this.timer?(this.unschedule(),this.schedule(),this.output.push(t)):(this.output=p.of(t),this[0].push(this.output),this.schedule())},stop:function(){return this.timer&&this.fire(),p.prototype.stop.apply(this,arguments)}});var se=Object.assign,co=Object.create,pn=Object.keys;function ue(t,e,r,o,i){this.stream=t,this.names=e,this.values=r,this.name=o,this.input=i}se(ue.prototype,{push:function(t){let e=this.stream,r=this.values,o=this.name;r[o]=t,(e.active||(e.active=pn(r).length===this.names.length))&&E(e[0],se({},r))},stop:function(){--this.stream.count===0&&x(this.stream)},done:function(t){this.stream.done(t)}});function St(t){this.inputs=t,this.active=!1}St.prototype=se(co(p.prototype),{push:null,pipe:function(t){let e=this.inputs,r=pn(e),o={};this.count=r.length,this[0]=t,t.done(this);let i;for(i in e){let s=e[i];if(s.pipe){let u=new ue(this,r,o,i,s);s.pipe(u)}else if(s.then){let u=new ue(this,r,o,i,s);s.then(c=>u.push(c)),s.finally(()=>u.stop())}else o[i]=s,--this.count}return t}});var lo=Object.assign,po=Object.create;function Pt(t){this.fn=t}Pt.prototype=lo(po(p.prototype),{pipe:function(t){return t.done(this),this[0]=t,this.fn(e=>this.push(e),e=>this.stop(e)),t}});var fn=Object.assign,fo=Object.create;function hn(t){this.stream=t}fn(hn.prototype,{push:function(t){E(this.stream[0],t)},stop:function(){--this.stream.count===0&&x(this.stream)},done:function(t){this.stream.done(t)}});function Mt(t){this.inputs=t}Mt.prototype=fn(fo(p.prototype),{push:null,pipe:function(t){let e=this.inputs;this.count=e.length,this[0]=t,t.done(this);let r=new hn(this),o=-1,i;for(;i=e[++o];)if(i.pipe)i.pipe(r);else if(i.then)i.then(s=>r.push(s)),i.finally(()=>r.stop());else{let s=-1;for(;++s<i.length;)r.push(i[s]);r.stop()}return t}});var ho=Object.assign,mo=Object.create;function kt(t){this.promise=t}kt.prototype=ho(mo(p.prototype),{push:null,pipe:function(t){let e=this.promise;return this[0]=t,t.done(this),e.then(r=>E(this,r)),e.finally(()=>x(this)),t}});var go=Array.prototype,dn=Object.assign;function wo(t){throw new TypeError("Stream cannot be created from "+typeof object)}dn(p,{isStream:en,of:function(){return new ft(go.slice.apply(arguments))},from:function(t){return t.pipe?new p(t):t.then?new kt(t):typeof t.length=="number"?typeof t=="function"?new Pt(t):new ft(t):wo(t)},batch:t=>new Q(j,t),burst:t=>(console.warn("Stream.burst() is now Stream.batch()"),new Q(j,t)),broadcast:t=>new pt(j,t),combine:t=>new St(t),merge:function(){return new Mt(arguments)},writeable:function(t){let e=new p(j);return t(e),e}});dn(p.prototype,{log:O,batch:function(t){return new Q(this,t)},burst:function(t){return console.warn("stream.burst() is now stream.batch()"),new Q(this,t)},broadcast:function(t){return new pt(this,t)}});function yo(t,e){return e[t]}var R=T(yo,!0);function I(t){if(typeof t.length=="number")return t[t.length-1]}var vo=Object.assign,To=Object.defineProperties,bo=Object.isExtensible,Eo=Object.prototype,N=Symbol("observe");function xo(t,e){let r=t.indexOf(e);return r>-1&&t.splice(r,1),t}var mn={[N]:{}};function At(t,e){if(!t||!t.length)return 0;t=t.slice(0);for(var r=-1;t[++r];)t[r].status!=="stopped"&&t[r].push(e);return r}function gn(t){this.observables={},this.gets=[],this.sets=void 0,this.target=t,this.observer=new Proxy(t,this),mn[N].value=this,To(t,mn)}vo(gn.prototype,{notify:function(t){At(this.observables[t],this.target[t]),At(this.sets,this.target)},listen:function(t,e){(t===null?this.sets||(this.sets=[]):this.observables[t]||(this.observables[t]=[])).push(e)},unlisten:function(t,e){let r=t===null?this.sets:this.observables[t];r&&xo(r,e)},get:function(e,r,o){let i=e[r];if(typeof r=="symbol"||r==="__proto__")return i;let s=Object.getOwnPropertyDescriptor(e,r);if((s?s.writable||s.set:i===void 0)&&At(this.gets,r),!Eo.hasOwnProperty.call(e,r))return i;let c=rt(i);if(!c)return i;for(var l=-1;this.gets[++l];)this.gets[l].listen(r);return c},set:function(e,r,o,i){if(typeof r=="symbol"||r==="__proto__")return e[r]=o,!0;let s=Z(o);if(e[r]===o||e[r]===s)return!0;let u=e.length;for(var c=-1;this.gets[++c];)this.gets[c].unlisten(r);return e[r]=s,r!=="length"&&e.length!==u&&At(this.observables.length,e.length),this.notify(r),!0},deleteProperty:function(t,e){return typeof e=="symbol"||e==="__proto__"?(delete t[e],!0):(t.hasOwnProperty(e)&&(delete t[e],this.notify(e)),!0)}});function Lt(t){return t&&bo(t)&&!Node.prototype.isPrototypeOf(t)&&(typeof BaseAudioContext>"u"||!BaseAudioContext.prototype.isPrototypeOf(t))&&!(t instanceof Date)&&!(t instanceof RegExp)&&!(t instanceof Map)&&!(t instanceof WeakMap)&&!(t instanceof Set)&&!(window.WeakSet&&t instanceof WeakSet)&&!ArrayBuffer.isView(t)}function rt(t,e){return t?t[N]?t[N].observer:e||Lt(t)?new gn(t).observer:void 0:void 0}function Z(t){return t&&t[N]&&t[N].target||t}function ae(t){return rt(t)&&t[N]}function wn(t,e){let r=e[N];r&&r.notify(t)}var yn=Object.assign,So=Object.create,ce=/(^\.?|\.)\s*([\w-]*)\s*/g;function Po(t){this.producer.push(t)}function le(t,e,r,o){ce.lastIndex=e;let i=ce.exec(t);this.path=t,this.object=r,this.producer=o,this.key=i[2]||i[1],this.index=ce.lastIndex,this.isMuteableObserver=this.path.slice(this.index)===".",this.index>=this.path.length&&(this.push=Po),this.listen(),this.push(this.key==="."?this.object:Z(this.object)[this.key])}yn(le.prototype,{push:function(t){Lt(t)?this.child?this.child.relisten(t):this.child=new le(this.path,this.index,t,this.producer):(this.child&&(this.child.stop(),this.child=void 0),this.producer.push(this.isMuteableObserver?t:void 0))},listen:function(){let t=ae(this.object);t&&t.listen(this.key==="."?null:this.key,this)},unlisten:function(){ae(this.object).unlisten(this.key==="."?null:this.key,this)},relisten:function(t){this.unlisten(),this.object=t,this.listen(),this.push(Z(this.object)[this.key])},stop:function(){this.unlisten(),this.child&&this.child.stop(),this.child=void 0,this.status="stopped"}});function vn(t,e,r){this.path=t,this.object=e,this.value=r}vn.prototype=yn(So(p.prototype),{push:function(t){this.value===t&&(!this.isMutationProducer||!Lt(t))||(this.value=t,this[0].push(t))},pipe:function(t){return this[0]=t,t.done(this),this.pathObserver=new le(this.path,0,this.object,this),this.isMutationProducer=this.path[this.path.length-1]===".",t},stop:function(){return this.pathObserver.stop(),p.prototype.stop.apply(this,arguments)}});function Ot(t,e,r){return new p(new vn(t,e,r))}function pe(t){if(typeof t!="object"||arguments.length>1)throw new Error("delegate() now takes an object of selector:fn pairs.");return function(r){let o=r.target,i;for(i in t){let s=o.closest(i);if(s)return t[i](s,...arguments)}}}var Mo=Object.assign,ko=/\s+/,Bt={fullscreenchange:nt(()=>"fullscreenElement"in document?"fullscreenchange":"webkitFullscreenElement"in document?"webkitfullscreenchange":"mozFullScreenElement"in document?"mozfullscreenchange":"msFullscreenElement"in document?"MSFullscreenChange":"fullscreenchange")},Tn=0;window.addEventListener("click",t=>Tn=t.timeStamp);function Ao(t,e){return t.node.addEventListener(Bt[e]?Bt[e]():e,t,t.options),t}function Lo(t,e){return t.node.removeEventListener(Bt[e]?Bt[e]():e,t),t}function bn(t,e,r){this.types=t.split(ko),this.options=e,this.node=r,this.select=e&&e.select}Mo(bn.prototype,{pipe:function(t){lt(this,t),this.types.reduce(Ao,this)},handleEvent:function(t){if(!(t.type==="click"&&t.timeStamp<=Tn)){if(this.select){let e=t.target.closest(this.select);if(!e)return;t.selectedTarget=e}E(this[0],t)}},stop:function(){this.types.reduce(Lo,this),x(this[0])}});function fe(t,e){let r;return typeof t=="object"&&(r=t,t=r.type),new p(new bn(t,r,e))}var Oo=Object.assign,ht={bubbles:!0,cancelable:!0};function Ct(t,e){var f;let r=ht,o,i,s,u,c,l;return typeof t=="object"?(f=t,{type:t,detail:i,bubbles:s,cancelable:u,composed:c}=f,o=ze(f,["type","detail","bubbles","cancelable","composed"]),l=Oo(new CustomEvent(t,{detail:i,bubbles:s||ht.bubbles,cancelable:u||ht.cancelable,composed:c||ht.composed}),o)):l=new CustomEvent(t,ht),e.dispatchEvent(l)}var du=T(Ct,!0);function Y(t){return typeof t}var Bo=/^\s*([+-]?\d*\.?\d+)([^\s\d]*)\s*$/;function he(t){return function(r){if(typeof r=="number")return r;var o=Bo.exec(r);if(!o||!t[o[2]||""]){if(!t.catch)throw new Error('Cannot parse value "'+r+'" (accepted units '+Object.keys(t).join(", ")+")");return o?t.catch(parseFloat(o[1]),o[2]):t.catch(parseFloat(r))}return t[o[2]||""](parseFloat(o[1]))}}var Co=/px$/,En={"transform:translateX":function(t){var e=dt("transform",t);if(!e||e==="none")return 0;var r=Ft(e);return parseFloat(r[4])},"transform:translateY":function(t){var e=dt("transform",t);if(!e||e==="none")return 0;var r=Ft(e);return parseFloat(r[5])},"transform:scale":function(t){var e=dt("transform",t);if(!e||e==="none")return 0;var r=Ft(e),o=parseFloat(r[0]),i=parseFloat(r[1]);return Math.sqrt(o*o+i*i)},"transform:rotate":function(t){var e=dt("transform",t);if(!e||e==="none")return 0;var r=Ft(e),o=parseFloat(r[0]),i=parseFloat(r[1]);return Math.atan2(i,o)}};function Ft(t){return t.split("(")[1].split(")")[0].split(/\s*,\s*/)}function dt(t,e){return window.getComputedStyle?window.getComputedStyle(e,null).getPropertyValue(t):0}function Dt(t,e){if(En[t])return En[t](e);var r=dt(t,e);return typeof r=="string"&&Co.test(r)?parseFloat(r):r}var Vt,It;function Fo(){if(!Vt){let t=document.documentElement.style.fontSize;document.documentElement.style.fontSize="100%",Vt=Dt("font-size",document.documentElement),document.documentElement.style.fontSize=t||""}return Vt}function Do(){return It||(It=Dt("font-size",document.documentElement)),It}window.addEventListener("resize",()=>{Vt=void 0,It=void 0});var V=v(Y,{number:b,string:he({px:b,em:t=>Fo()*t,rem:t=>Do()*t,vw:t=>window.innerWidth*t/100,vh:t=>window.innerHeight*t/100,vmin:t=>window.innerWidth<window.innerHeight?window.innerWidth*t/100:window.innerHeight*t/100,vmax:t=>window.innerWidth<window.innerHeight?window.innerHeight*t/100:window.innerWidth*t/100})}),xn=V;function de(t){t.stopPropagation(),t.preventDefault()}var Vo=Array.prototype,ge=Object.assign,me="webkitUserSelect"in document.body.style?"webkitUserSelect":"userSelect",Ht={},jt={threshold:4,ignoreTags:{textarea:!0,input:!0,select:!0}};function Io(t,e,r){return e*e+r*r>=t*t}function Sn(t,e,r){if(this.stream=t,this.events=[e],this.options=r,this.pointerId=e.pointerId,typeof r.threshold=="function")this.checkThreshold=r.threshold;else{let o=xn(r.threshold);this.checkThreshold=(i,s,u)=>Io(o,i,s,u)}document.addEventListener("pointermove",this),document.addEventListener("pointerup",this),document.addEventListener("pointercancel",this)}ge(Sn.prototype,{handleEvent:v(R("type"),{pointermove:function(t){if(this.pointerId===t.pointerId){if(this.pointerId in Ht&&this!==Ht[this.pointerId]){this.stop();return}if(this.events.push(t),!this.isGesture){let e=this.events[0],r=t.clientX-e.clientX,o=t.clientY-e.clientY,i=(t.timeStamp-e.timeStamp)/1e3;this.checkThreshold(r,o,i)&&this.createGesture()}}},pointerup:function(t){this.pointerId===t.pointerId&&(this.events.push(t),this.stop(),this.isGesture&&document.addEventListener("click",de,{capture:!0,once:!0}))},default:function(t){this.pointerId===t.pointerId&&(this.events.push(t),this.stop())}}),createGesture:function(){this.isGesture=!0,this.userSelectState=document.body.style[me],document.body.style[me]="none",Ht[this.pointerId]=this,this.stream.push(new p(this))},pipe:function(t){for(lt(this,t);this.events.length;)E(this[0],Vo.shift.apply(this.events));this.events=t},stop:function(){if(document.removeEventListener("pointermove",this),document.removeEventListener("pointerup",this),document.removeEventListener("pointercancel",this),this.isGesture&&(document.body.style[me]=this.userSelectState,delete Ht[this.pointerId]),this[0]){let t=this[0];tn(this,0),x(t)}}});function Ho(t){var e=t.target.tagName;return e&&(!!jt.ignoreTags[e.toLowerCase()]||t.target.draggable)}function Pn(t,e){this.node=t,this.options=e}ge(Pn.prototype,{pipe:function(t){return this[0]=t,this.node.addEventListener("pointerdown",this),t},handleEvent:function(t){if(t.button===0&&!(this.options.device&&!this.options.device.includes(t.pointerType))&&!Ho(t)&&!(this.options.select&&!t.target.closest(this.options.select))){var e={type:t.type,target:t.target,currentTarget:t.currentTarget,clientX:t.clientX,clientY:t.clientY,timeStamp:t.timeStamp,pointerId:t.pointerId};new Sn(this[0],e,this.options)}},stop:function(){return this[0]&&(this.node.removeEventListener("pointerdown",this),x(this[0])),this}});function we(t,e){return t=e&&t?ge({},jt,t):jt,e=e||t,new p(new Pn(e,t))}function jo(){return{x:0,y:0,left:0,top:0,right:window.innerWidth,bottom:window.innerHeight,width:window.innerWidth,height:window.innerHeight}}function Gt(t){return t===window?jo():t.getClientRects()[0]||t.getBoundingClientRect()}function ye(t){return Math.pow(10,t/20)}function C(t){if(!t)return 0;let e=+t;if(e||e===0)return e;let r=/^(?:(-?[\d.]+)|(-?∞))(?:(db|bpm)|(m|k)?(\w+))$/.exec(t.toLowerCase());if(!r)return 0;let o=r[2]?r[2]==="-∞"?-1/0:1/0:parseFloat(r[1]);return r[3]==="db"?ye(o):r[3]==="bpm"?o/60:r[4]==="m"?o/1e3:r[4]==="k"?o*1e3:o}var Mn=xt(/^([+\-]?(?:0|[1-9]\d*)(?:\.\d+)?(?:[eE][+\-]?\d+)?\w*)\s*(?:\[([^\]]+)\]|([^\d\s]\S*))?\s*/,{1:(t,e)=>(t.push({value:C(e[1])}),t),2:(t,e)=>(I(t).label=e[2],t),3:(t,e)=>(I(t).label=e[3],t),done:(t,e)=>Mn(t,e),catch:(t,e)=>t}),tt=v(Y,{string:t=>Mn([],t.trim()),object:b});function k(t,e){return Math.ceil(e/t)*t}var kn=v(t=>t.toLowerCase(),{db:(t,e,r)=>tt("-∞dB -96dB -90dB -84dB -78dB -72dB -66dB -60dB -54dB -48dB -42dB -36dB -30dB -24dB -18dB -12dB -6dB 0dB 6dB 12dB 18dB 24dB"),default:(t,e,r)=>{let o=r-e,i=o<.8?k(.05,o/10):o<2?k(.2,o/10):o<8?k(.5,o/10):o<20?k(2,o/10):o<80?k(5,o/10):o<200?k(20,o/10):k(200,o),s=[],u=o<.8?k(.05,e):o<2?k(.2,e):o<8?k(.5,e):o<20?k(2,e):o<80?k(5,e):o<200?k(20,e):k(200,e);for(;u<=r;)s.push({label:o<2?u.toFixed(1):u,value:u}),u+=i;return s}});function An(t,e,r,o){return t.normalValue=e.normalise(r,o,t.value),t}function ve(t,e){let{scale:r,min:o,max:i,ticks:s,step:u,display:c}=e;return t.scale=r,t.min=o,t.max=i,t.ticks=(s?s.length?s:kn(c,o,i):j).filter(l=>l.value>=t.min&&l.value<=t.max).map(l=>An(l,r,o,i)),t.step=u==="any"?void 0:u==="tick"?t.ticks:tt(u).filter(l=>l.value>=t.min&&l.value<=t.max).map(l=>An(l,r,o,i)),t.display=c,t}var Ln=.00390625;var On=.0009765625,Bn=.00048828125,Cn=.000244140625;var Fn=1525878906e-14,Te=.25,Dn=.4,na=Symbol("state");var Vn=Object.assign;function _o(t,e,r){return(r-t)/(e-t)}function H(t,e,r){return t+r*(e-t)}var Wt={};function be(t,e,r){let o=r/(e*t);return(o<=1?o:Math.log(o)+1)/Wt[t]}function Uo(t,e,r){let o=r*Wt[t];return e*t*(o<=1?o:Math.pow(Math.E,o-1))}function W(t){this.xover=t,Wt[t]||(Wt[t]=Math.log(1/t)+1)}Vn(W.prototype,{normalise:function(t,e,r){let o=be(this.xover,e,t);return(be(this.xover,e,r)-o)/(1-o)},denormalise:function(t,e,r){let o=be(this.xover,e,t),i=r*(1-o)+o;return Uo(this.xover,e,i)}});function Rt(t){this.power=t}Vn(Rt.prototype,{normalise:function(t,e,r){return Math.pow((r-t)/(e-t),1/this.power)},denormalise:function(t,e,r){return Math.pow(r,this.power)*(e-t)+t}});var zo={linear:{normalise:_o,denormalise:H},"pow-2":new Rt(2),"pow-3":new Rt(3),"pow-4":new Rt(4),log:{normalise:function(t,e,r){return Math.log(r/t)/Math.log(e/t)},denormalise:function(t,e,r){return t*Math.pow(e/t,r)}},"log-24db":new W(.0625),"log-30db":new W(.03125),"log-36db":new W(.015625),"log-48db":new W(Ln),"log-60db":new W(On),"log-66db":new W(Bn),"log-72db":new W(Cn),"log-96db":new W(Fn)};function Ee(t){return zo[t&&t.toLowerCase()||"linear"]}function xe(t){return 20*Math.log10(t)}function q(t,e){var r=e%t;return r<0?r+t:r}var aa=T(q);function mt(t){return function(r,...o){var i=t[r]||t.default;return i&&i.apply(this,o)}}var Rn=9,No=/(`[^`]*`)|(ms|[YMwdhms]{1,3}|±)/g;function Yo(t){return t*60}function qo(t){return t*3600}function Xo(t){return t*1e3}function In(t){return t/60}function Hn(t){return t/3600}function Se(t){return t/86400}function $o(t){return t/604800}function jn(t){return t/2629800}function Ko(t){return t/31557600}function X(t){return t>=10?"":"0"}var Jo=/^([+-])?(\d{2,}):([0-5]\d)(?::((?:[0-5]\d|60)(?:.\d+)?))?$/,Qo=/^([+-])?(\d{2,}):(\d{2,})(?::(\d{2,}(?:.\d+)?))?$/,et=v(Y,{number:b,string:te(Jo,_n),default:function(t){throw new Error("parseTime() does not accept objects of type "+typeof t)}}),Wn=v(Y,{number:b,string:te(Qo,_n),default:function(t){throw new Error("parseTime() does not accept objects of type "+typeof t)}});function _n(t){let[e,r,o,i,s]=t;var u=qo(parseInt(o,10))+(i?Yo(parseInt(i,10))+(s?parseFloat(s,10):0):0);return r==="-"?-u:u}function Zo(t,e){return t.replace(No,(r,o,i)=>o?o.slice(1,-1):Gn[r]?Gn[r](e):r)}function ti(t){var e=t<0?"-":"";t<0&&(t=-t);var r=Math.floor(t/3600),o=X(r)+r;if(t=t%3600,t===0)return e+o+":00";var i=Math.floor(t/60),s=X(i)+i;if(t=t%60,t===0)return e+o+":"+s;var u=X(t)+Un(Rn,t);return e+o+":"+s+":"+u}function Un(t,e){return e.toFixed(t).replace(/\.?0+$/,"")}var Gn={"±":function(e){return e<0?"-":""},Y:function(e){return e=e<0?-e:e,Math.floor(Ko(e))},M:function(e){return e=e<0?-e:e,Math.floor(jn(e))},MM:function(e){return e=e<0?-e:e,Math.floor(jn(e%31557600))},w:function(e){return e=e<0?-e:e,Math.floor($o(e))},ww:function(e){return e=e<0?-e:e,Math.floor(Se(e%2629800))},d:function(e){return e=e<0?-e:e,Math.floor(Se(e))},dd:function(e){return e=e<0?-e:e,Math.floor(Se(e%604800))},h:function(e){return e=e<0?-e:e,Math.floor(Hn(e))},hh:function(e){e=e<0?-e:e;var r=Math.floor(Hn(e%86400));return X(r)+r},m:function(e){e=e<0?-e:e;var r=Math.floor(In(e));return X(r)+r},mm:function(e){e=e<0?-e:e;var r=Math.floor(In(e%3600));return X(r)+r},s:function(e){return e=e<0?-e:e,Math.floor(e)},ss:function(e){e=e<0?-e:e;var r=Math.floor(e%60);return X(r)+r},sss:function(e){e=e<0?-e:e;var r=e%60;return X(r)+Un(Rn,r)},ms:function(e){e=e<0?-e:e;var r=Math.floor(Xo(e%1));return r>=100?r:r>=10?"0"+r:"00"+r}},zn=T(function(t,e){return t==="ISO"?ti(et(e)):Zo(t,et(e))});var ya=T(function(t,e){return et(e)+Wn(t)}),va=T(function(t,e){return et(e)-Wn(t)}),Ta=T(function(t,e){return et(t)-et(e)}),ei=mt({w:function(t){return t-q(604800,t)},d:function(t){return t-q(86400,t)},h:function(t){return t-q(3600,t)},m:function(t){return t-q(60,t)},s:function(t){return t-q(1,t)},ms:function(t){return t-q(.001,t)}}),ba=T(function(t,e){return ei(t,et(e))});function ni(){return{unit:value<1?"m"+unit:unit,value:value<.001?(value*1e3).toFixed(2):value<1?(value*1e3).toPrecision(3):value.toPrecision(3)}}function ri(t,e){return{unit:e<1?"m"+t:e>=1e3?"k"+t:t,value:e<.001?(e*1e3).toFixed(2):e<1?(e*1e3).toPrecision(3):e>=1e3?(e/1e3).toPrecision(3):e.toPrecision(3)}}function oi(t,e){return{unit:e<.01?"m"+t:e<1?"c"+t:e>=1e3?"k"+t:t,value:e<.001?(e*1e3).toFixed(2):e<.01?(e*1e3).toPrecision(3):e<1?(e*100).toPrecision(3):e>=1e3?(e/1e3).toPrecision(3):e.toPrecision(3)}}var ii={pan:(t,e)=>({unit:"",value:e===-1?"-1.00":e===0?"0.00":e===1?"1.00":e.toFixed(2)}),db:(t,e)=>{let r=xe(e);return{unit:"dB",value:isFinite(r)?r<-1?r.toPrecision(3):r.toFixed(2):r<0?"-∞":"∞"}},hz:(t,e)=>({unit:e>=1e3?"kHz":"Hz",value:e<1?e.toFixed(2):e>=1e3?(e/1e3).toPrecision(3):e.toPrecision(3)}),semitone:(t,e)=>({unit:"",value:e===0?"0":e<0?"♭"+(-e/100).toFixed(2):"♯"+(e/100).toFixed(2)}),s:ni,m:oi,bpm:(t,e)=>{let r=e*60;return{unit:"bpm",value:r<100?r.toFixed(1):r.toFixed(0)}},int:(t,e)=>({unit:"",value:Math.round(e)}),"":(t,e)=>({unit:"",value:e>-1&&e<1?e.toFixed(2):e.toPrecision(3)}),default:v(t=>/[YMWwdhms]/.test(t)?"time":"default",{time:(t,e)=>({unit:"",value:zn(t,e)}),default:ri})},Ma=v(t=>t.toLowerCase(),ii);var Pe="linear";var Me="any",ke="";function Nn(t,e,r,o){return e.delete(r),o.forEach(i=>e.append(r,i.x+","+i.y)),t.setFormValue(e),e}var Ae=[];function Yn(t,e){t.clearRect(e.x,e.y,e.width,e.height)}function qn(t,e,r,o){t.beginPath();let i=-1;for(;++i<r.length;)t.moveTo(e.x+r[i]*e.width,e.y),t.lineTo(e.x+r[i]*e.width,e.y+e.height);t.lineWidth="1",t.lineCap="round",t.strokeStyle=o,t.setLineDash(Ae),t.stroke(),t.closePath()}function Xn(t,e,r,o){t.beginPath();let i=-1;for(;++i<r.length;)t.moveTo(e.x,e.y+(1-r[i])*e.height),t.lineTo(e.x+e.width,e.y+(1-r[i])*e.height);t.lineWidth="1",t.lineCap="round",t.strokeStyle=o,t.setLineDash(Ae),t.stroke(),t.closePath()}function $n(t,e,r,o,i){t.beginPath(),t.moveTo(0,e.y+(1-o.y)*e.height),t.lineTo(e.x+o.x*e.width-r,e.y+(1-o.y)*e.height),t.moveTo(e.x+o.x*e.width+r,e.y+(1-o.y)*e.height),t.lineTo(e.x+e.width+100,e.y+(1-o.y)*e.height),t.moveTo(e.x+o.x*e.width,0),t.lineTo(e.x+o.x*e.width,e.y+(1-o.y)*e.height-r),t.moveTo(e.x+o.x*e.width,e.y+(1-o.y)*e.height+r),t.lineTo(e.x+o.x*e.width,e.y+e.height+100),t.lineWidth="1",t.lineCap="round",t.strokeStyle=i,t.setLineDash(Ae),t.stroke(),t.closePath()}function ui(t,e,r){let o=t(e),i=t(r);return i===o?0:o>i?1:-1}var Le=T(ui,!0);var ot=function(){};function Kn(t,e){return e.length<t?e:e.slice(0,t-3)+"..."}var Oe=window.console?console.log.bind(console,"%cSoundstage %c%s","color: #e02053; font-weight: 600;","color: #8e9e9d; font-weight: 300;"):ot,ja=window.console?console.groupCollapsed.bind(console,"%cSoundstage %c%s","color: #e02053; font-weight: 600;","color: #8e9e9d; font-weight: 300;"):ot,Ga=window.console?console.groupEnd.bind(console):ot,Be=window.console?function(t,e,r="",...o){typeof r=="string"&&(r=Kn(48,r)),console.log("%c"+t+" %c"+(e||""),"color: #b5002f; font-weight: 600;","color: #8e9e9d; font-weight: 300;",r,...o)}:ot,gt=window.console?function(t,e,r="",...o){typeof r=="string"&&(r=Kn(48,r)),console.groupCollapsed("%c"+t+" %c"+(e||""),"color: #b5002f; font-weight: 600;","color: #8e9e9d; font-weight: 300;",r,...o)}:ot,wt=window.console?console.groupEnd.bind(console):ot;var Ce="idle",Jn="cued",Qn="playing";var _t=!1,ai=Object.assign,Zn=Object.defineProperties,ci={context:{writable:!0},startTime:{writable:!0},stopTime:{writable:!0}};function _(t){_t&&gt("mixin ","Playable"),Zn(this,ci),this.context=t,_t&&wt()}_.reset=function(t){return t.startTime=void 0,t.stopTime=void 0,t};ai(_.prototype,{start:function(t=this.context.currentTime){if(_t&&this.startTime!==void 0&&(this.stopTime===void 0||t<this.stopTime))throw new Error("Attempt to start a node that is already started");return this.stopTime=void 0,this},stop:function(t=this.context.currentTime){if(_t&&this.startTime===void 0)throw new Error("Attempt to stop a node that has not been started");return this.stopTime=this.startTime===void 0||t>this.startTime?t:this.startTime,this}});Zn(_.prototype,{status:{get:function(){return this.startTime!==void 0?this.startTime<=this.context.currentTime?this.stopTime===void 0||this.stopTime>this.context.currentTime?Qn:Ce:Jn:Ce}}});window.AudioContext=window.AudioContext||window.webkitAudioContext;AudioContext.prototype.getOutputTimestamp||(AudioContext.prototype.getOutputTimestamp=function(){return{contextTime:this.currentTime+this.outputLatency,performanceTime:window.performance.now()}});var $=new window.AudioContext;$.destination.channelInterpretation="discrete";$.destination.channelCount=$.destination.maxChannelCount;$.baseLatency===void 0&&($.baseLatency=256/$.sampleRate);if($.state==="suspended"){Oe("Audio context suspended","User interaction required");let t=["mousedown","keydown","touchstart","contextmenu"],e=(o,i)=>(document.addEventListener(i,o),o),r=(o,i)=>(document.removeEventListener(i,o),o);t.reduce(e,function o(i){$.resume().then(function(){Oe('Audio context resumed on "'+i.type+'"'),t.reduce(r,o)})})}function li(t,e){return t.contextTime+(e-t.performanceTime)/1e3}function Fe(t,e){var r=t.getOutputTimestamp();return li(r,e)}var S={channelCountLimit:12,basePath:window.soundstageBasePath||"/soundstage/",automationEventsKey:"automationEvents",animationFrameKey:"animationFrame",minExponentialValue:14013e-49,targetDurationFactor:9};var zt=!1,er=1e3/60;function pi(t){return window.AudioParam&&window.AudioParam.prototype.isPrototypeOf(t)}function yt(t){if(zt&&!pi(t))throw new Error("Not an AudioParam "+JSON.stringify(t));return t[S.automationEventsKey]||(t[S.automationEventsKey]=[])}var nr=v(R(1),{target:function(t){if(t[3]===void 0)throw new Error('Event "target" must have 2 parameters: [time, "target", value, duration]')},hold:function(t){if(t[2]!==void 0)throw new Error('Event "hold" takes 0 parameters: [time, "hold"]')},default:function(t){if(t[2]===void 0)throw new Error('Event "'+t[1]+'" must have 1 parameter: [time, "'+t[1]+'", value]')}});function tr(t,e){t.cancelScheduledValues(e.time),e.curve==="linear"?t.linearRampToValueAtTime(e.value,e.time):e.curve==="exponential"?t.exponentialRampToValueAtTime(e.value,e.time):e.curve==="step"&&t.setValueAtTime(e.value,e.time)}var fi={step:(t,e)=>t.setValueAtTime(e.value,e.time),linear:(t,e)=>t.linearRampToValueAtTime(e.value,e.time),exponential:(t,e)=>t.exponentialRampToValueAtTime(e.value,e.time),target:(t,e)=>t.setTargetAtTime(e.value,e.time,e.duration),curve:(t,e)=>t.setValueCurveAtTime(e.value,e.time,e.duration),hold:AudioParam.prototype.cancelAndHoldAtTime?function(e,r,o){if(o&&o.curve==="target")return tr(e,r);e.cancelAndHoldAtTime(r.time)}:tr},hi=v(b,{exponential:(t,e,r,o,i,s)=>{let u={time:i,value:Math.fround(s)};return u.value<=S.minExponentialValue?(u.time=r?r.time:0,u.curve="step"):r&&r.value<S.minExponentialValue?u.curve="step":u.curve="exponential",u},hold:function(t,e,r,o,i){return o&&o.curve==="linear"?{time:i,curve:"linear",value:Math.fround(De(r,o,i))}:o&&o.curve==="exponential"?{time:i,curve:"exponential",value:Math.fround(De(r,o,i))}:r&&r.curve==="target"?{time:i,curve:"step",value:vt(e,i)}:{time:i}},target:(t,e,r,o,i,s,u)=>({time:i,curve:"target",value:Math.fround(s),duration:u}),default:(t,e,r,o,i,s,u)=>({time:i,curve:t,value:Math.fround(s)})}),di=mt({hold:function(t,e,r,o){r.length=o+1,e.curve&&r.push(e)},default:function(t,e,r,o){if(!t){r.push(e);return}if(t.time===e.time){for(;r[++o]&&r[o].time===e.time;)if(r[o].curve===e.curve){r.splice(o,1,e);return}r.splice(o,0,e);return}r.splice(o+1,0,e)}});function rr(t,e,r,o,i,s){for(var u=e.length;e[--u]&&e[u].time>=r;);let c=e[u],l=e[u+1],f=hi(o,t,c,l,r,i,s);fi[o](t,f,l),di(o,l,f,e,u)}function Ve(t,e,r,o,i,s,u){if(r==="target"&&i===void 0)throw new Error('Automation curve "target" must have a duration');let c=yt(t);if(rr(t,c,e,r,o,i),!s){zt&&console.warn("No notify for param change",o,r,t);return}if(!u){zt&&console.warn("No context for param change",o,r,t);return}if(t[S.animationFrameId])return;var l=-1;function f(h){if(l=(l+1)%3,l===0){t[S.animationFrameId]=requestAnimationFrame(f);return}let d=h+er,y=Fe(u,d),a=vt(t,y),m=c[c.length-1];t[S.animationFrameId]=m&&y<=m.time?requestAnimationFrame(f):void 0,s(t,"value",a)}t[S.animationFrameId]=requestAnimationFrame(f)}function or(t,e,r,o,i,s,u){if(o==="target"&&s===void 0)throw new Error('Automation curve "target" must have a duration');let c=t[e],l=yt(c);if(rr(c,l,r,o,i,s),!u){zt&&console.warn("No notify for param change",i,o,c);return}if(c[S.animationFrameId])return;var f=-1;function h(d){if(f=(f+1)%3,f===0){c[S.animationFrameId]=requestAnimationFrame(h);return}let y=d+er,a=Fe(t.context,y),m=vt(c,a),w=l[l.length-1];c[S.animationFrameId]=w&&a<=w.time?requestAnimationFrame(h):void 0,u(t,e,m)}c[S.animationFrameId]=requestAnimationFrame(h)}var ir={step:function(e,r,o,i,s){return s<i?e:r},linear:function(e,r,o,i,s){return e+(r-e)*(s-o)/(i-o)},exponential:function(e,r,o,i,s){return e*Math.pow(r/e,(s-o)/(i-o))},target:function(e,r,o,i,s,u){return s<i?e:r+(e-r)*Math.pow(Math.E,(i-s)/u)},curve:function(t,e,r,o,i,s){}};function De(t,e,r){return ir[e.curve](t.value,e.value,t.time,e.time,r,t.duration)}function Ut(t,e,r){var o=t[e];return o.curve==="target"?ir.target(Ut(t,e-1,o.time),o.value,0,o.time,r,o.duration):o.value}function mi(t,e){for(var r=t.length;t[--r]&&t[r].time>=e;);var o=t[r],i=t[r+1];if(!o)return 0;if(!i)return Ut(t,r,e);if(i.time===e){for(;t[++r]&&t[r].time===e;);return Ut(t,r-1,e)}if(e<i.time)return i.curve==="linear"||i.curve==="exponential"?De(o,i,e):Ut(t,r,e)}function vt(t,e){var r=yt(t);return!r||r.length===0?t.value:Math.fround(mi(r,e))}var it=!1;function Ie(t,e,r,o){r&&r.setValueAtTime||(t[e]&&t[e].setValueAtTime?(it&&Be("param",e+":",r),yt(t[e]).length=0,or(t,e,t.context.currentTime,"step",r,null,o)):t[e]&&t[e].connect?gi(t[e],r):(it&&Be("prop",e+" =",r),t[e]=r))}function gi(t,e,r,o){it&&gt("assign",t.constructor.name,r?Object.keys(r).join(", "):"");let i={};if(r)for(let s in r)o&&o.indexOf(s)>-1||r[s]&&r[s].setValueAtTime||t.hasOwnProperty(s)&&r[s]!==void 0&&(Ie(t,s,r[s]),i[s]=!0);for(let s in e)o&&o.indexOf(s)>-1||i[s]||Ie(t,s,e[s]);it&&wt()}function sr(t,e,r){it&&gt("assign",t.constructor.name,e?Object.keys(e).join(", "):"");var o;for(o in e)r&&r.indexOf(o)>-1||e[o]&&e[o].setValueAtTime||(t[o]||t.hasOwnProperty(o))&&e[o]!==void 0&&Ie(t,o,e[o]);return it&&wt(),t}var wi=Object.assign,cr=Object.defineProperties,yi=Object.getOwnPropertyDescriptor,ur=S.targetDurationFactor,vi={attack:{writable:!0,enumerable:!0},release:{writable:!0,enumerable:!0},gain:{writable:!0,enumerable:!0},rate:{writable:!0,enumerable:!0}},Ti={attack:[[.008,"linear",1]],release:[[.008,"linear",0]],offset:0,gain:1,rate:1};function ar(t,e,r,o,i){var s;Ve(t,r,"hold");for(s of e)nr(s),Ve(t,r+s[0]/i,s[1],s[2]*o,s[3])}var Tt=class extends ConstantSourceNode{constructor(e,r){super(e);super.start.call(this,e.currentTime),_.call(this,e),cr(this,vi),sr(this,wi({},Ti,r))}start(e){if(!this.attack||this.attack.length===0)return this;_.prototype.start.apply(this,arguments),ar(this.offset,this.attack,this.startTime,this.gain,this.rate,"ConstantSource.offset");let r=I(this.attack);return r[2]===0&&(this.stopTime=e+(r[1]==="target"?r[0]+r[3]*ur:r[0])),this}stop(e){if(!this.release||this.release.length===0)return this;_.prototype.stop.apply(this,arguments);let r=vt(this.offset,this.stopTime);ar(this.offset,this.release,this.stopTime,r,this.rate,"ConstantSource.offset");let o=I(this.release);return o[2]!==0?(console.warn("Envelope.release does not end with value 0. Envelope will never stop.",this),this.stopTime=1/0):this.stopTime+=o[1]==="target"?o[0]+o[3]*ur:o[0],this}};cr(Tt.prototype,{playing:yi(_.prototype,"playing")});var Nt=4,bi=[],Ei=[2,6];function lr(t,e,r,o,i){let s=0;for(t.beginPath(),t.moveTo(e.x+s/r,e.y+(1-o[0])*e.height);++s<o.length;)t.lineTo(e.x+s/r,e.y+(1-o[s])*e.height);t.strokeStyle=i,t.lineWidth="2",t.lineCap="round",t.setLineDash(bi),t.stroke(),t.lineTo(e.x+e.width,e.y+e.height),t.lineTo(e.x,e.y+e.height),t.fillStyle=i+"2b",t.fill(),t.closePath()}function pr(t,e,r,o){let i=-1,s=18;for(t.beginPath();++i<r.length;)r[i].type==="target"&&(t.moveTo(e.x+r[i].x*e.width,e.y+(1-(r[i-1]?r[i-1].y:0))*e.height),t.lineTo(e.x+r[i].x*e.width,e.y+(1-r[i].y)*e.height+((r[i-1]?r[i-1].y:0)>r[i].y?-s:s)),t.moveTo(e.x+r[i].x*e.width+s,e.y+(1-r[i].y)*e.height),t.lineTo(e.x+(r[i+1]?r[i+1].x:1)*e.width,e.y+(1-r[i].y)*e.height));t.lineWidth="2",t.lineCap="round",t.strokeStyle=o,t.setLineDash(Ei),t.stroke(),t.closePath()}function fr(t,e,r,o,i,s,u,c,l,f,h,d){let y=Nt*e.width/r.width,a=new OfflineAudioContext(1,Nt*e.width,22050),m=new Tt(a,{attack:f.map(w=>w.type==="target"?[w.x*y/22050,w.type,w.y,w.duration*y/22050]:w.type?[w.x*y/22050,w.type,w.y]:[w.x*y/22050,"step",w.y])});return m.connect(a.destination),m.start(r.x,"attack"),m.stop(r.width),t.activeRenders=t.activeRenders?t.activeRenders+1:1,t.cacheddata&&lr(t,e,Nt,t.cacheddata,h),t.cacheddata&&pr(t,e,f.map(w=>({x:o.normalise(i,s,w.x),y:u.normalise(c,l,w.y),type:w.type,duration:w.duration})).sort(Le(R("x"))),h),a.startRendering().then(w=>{if(--t.activeRenders)return;d();let F=w.getChannelData(0).map(D=>u.normalise(c,l,D));lr(t,e,Nt,F,h),pr(t,e,f.map(D=>({x:o.normalise(i,s,D.x),y:u.normalise(c,l,D.y),type:D.type,duration:D.duration})).sort(Le(R("x"))),h),t.cacheddata=F})}function xi(t){t.stop()}function Si(t,e){return t&&t.stop(),Ot(".",e)}function gr(t,e,r,o,i,s){let u=Gt(t),c=V(e["font-size"]),l=V(e.borderLeftWidth)||0,f=V(e.borderTopWidth)||0,h=V(e.borderRightWidth)||0,d=V(e.borderBottomWidth)||0,y=V(e.paddingLeft)||0,a=V(e.paddingTop)||0,m=V(e.paddingRight)||0,w=V(e.paddingBottom)||0;return r.x=u.x+l+y,r.y=u.y+f+a,r.width=u.width-l-y-h-m,r.height=u.height-f-a-d-w,o.x=0,o.y=0,o.width=u.width-l-h,o.height=u.height-f-d,i.x=y,i.y=a,i.width=u.width-l-y-h-m,i.height=u.height-f-a-d-w,s.x=0,s.width=i.width/c,s.y=0,s.height=-i.height/c,u}function Pi(t,e,r,o,i,s){s.box=gr(t,r,s.pxbox,s.paddingbox,s.contentbox,s.rangebox),o.width=s.paddingbox.width*2,o.height=s.paddingbox.height*2,e.setProperty("--range-x",s.rangebox.x),e.setProperty("--range-y",s.rangebox.y),e.setProperty("--range-width",s.rangebox.width),e.setProperty("--range-height",s.rangebox.height),i.setAttribute("viewBox",s.rangebox.x+" "+(s.rangebox.y+s.rangebox.height)+" "+s.rangebox.width+" "+-s.rangebox.height)}function Mi(t,e){let r=e.pxbox,o=e.valuebox,i=t.clientX-r.x-e.offset.x,s=r.height-(t.clientY-r.y-e.offset.y);e.x=ut(o.x,o.x+o.width,H(o.x,o.x+o.width,i/r.width)),e.y=ut(o.y,o.y+o.height,H(o.y,o.y+o.height,s/r.height))}var ki=v((t,e)=>e.type,{pointerdown:(t,e)=>{t.target=e.target,t.time=e.timeStamp/1e3,t.previous&&t.previous.type==="tap"&&t.time-t.previous.time<Dn&&(t.type="double-tap",t.target=t.previous.target);let r=Gt(e.target);return t.offset=e.target===e.currentTarget?{x:0,y:0}:{x:e.clientX-(r.x+r.width/2),y:e.clientY-(r.y+r.height/2)},t.events.length=0,t.events.push(e),t},pointermove:(t,e)=>{t.events.push(e);let r=t.events[0];return e.timeStamp-r.timeStamp<Te&&e.clientX-r.clientX<4&&e.clientY-r.clientY<4||(t.type="move",Mi(e,t)),t},default:(t,e)=>(t.events.push(e),t.duration=e.timeStamp/1e3-t.time,!t.type&&t.duration<Te&&(t.type="tap"),t)}),Ai=pe({".duration-handle":v((t,e)=>e.type,{pointermove:function(t,e){let r=H[e.yTransform](e.yMin,e.yMax,-e.y);return scope[3]=e.x<=scope[0]?minExponential:e.x-scope[0],scope[2]=r,e},default:P}),".control-handle":v((t,e)=>e.type,{tap:function(t,e){return e.scope=scope,e},"double-tap":function(t,e){let r=e.previous.scope;return at(e.collection,r),e},move:function(t,e){let{internals:r,formdata:o,events:i,host:s,value:u,x:c,y:l}=e,f=t.dataset.index,h=rt(u[f]);return h.x=c,h.y=l,I(i).type!=="pointermove"?(Nn(r,o,s.name,u),Ct("change",s)):Ct("input",s),e},default:function(t){console.log("Untyped gesture",t)}}),"*":v((t,e)=>e.type,{"double-tap":function(t){let e=t.x,r=H[t.yTransform](t.yMin,t.yMax,-t.y);return insert(getTime,t.collection,[e,"step",r]),wn(t.collection,".",t.collection),t},default:P})});function Yt(t,e){let r=t.getPropertyValue(e).trim();return r==="none"?void 0:r}function He(t,e,r,o,i,s,u,c,l=!0){let f={x:o.x*2,y:o.y*2,width:o.width*2,height:o.height*2},h=Yt(r,"--line-color-x"),d=Yt(r,"--line-color-y"),y=Yt(r,"--crosshair-color"),a=Yt(r,"--envelope-color");Yn(e,{x:0,y:0,width:t.width,height:t.height}),h&&qn(e,f,s.ticks.filter(m=>i.x+i.width>=m.value&&m.value>=i.x).map(m=>m.normalValue),h),d&&Xn(e,f,u.ticks.filter(m=>i.y+i.height>=m.value&&m.value>=i.y).map(m=>m.normalValue),d),y&&c&&c.length&&c.forEach(m=>$n(e,f,28,{x:s.scale.normalise(s.min,s.max,m.x),y:u.scale.normalise(u.min,u.max,m.y)},y)),a&&l&&c&&c.length&&fr(e,f,i,s.scale,s.min,s.max,u.scale,u.min,u.max,c,a,()=>He(t,e,r,o,i,s,u,c,!1))}function Li(t,e,r){return t.push(B("label",{part:r+"-tick tick",style:"--normal-"+r+": "+e.normalValue+";",html:"<span>"+e.label+"</span>"})),t}function wr(t,e,r,o,i,s,u,c,l,f){t.setAttribute("transform","translate("+H(e.x,e.x+e.width,r.normalise(o,i,l.x))+" "+H(e.y,e.y+e.height,s.normalise(u,c,l.y))+")"),t.firstElementChild.innerHTML=(l.label?l.label+" ":"")+l.x+", "+l.y,t.dataset.index=f}function Oi(t,e,r,o,i,s,u,c,l){return B("path",{part:"handle",class:"control control-handle control-point",d:"M 0 0 m -0.5 0 a 0.5 0.5 0 1 0 1 0 a 0.5 0.5 0 1 0 -1 0",transform:"translate("+H(t.x,t.x+t.width,e.normalise(r,o,c.x))+" "+H(t.y,t.y+t.height,i.normalise(s,u,c.y))+")",html:"<title>"+(c.label?c.label+" ":"")+c.x+", "+c.y+"</title>",data:{index:l}})}function Bi(t,e,r,o,i,s){let u=-1,c,l;for(;c=s[++u];)t[u]?(l=t[u],wr(l,r,o.scale,o.min,o.max,i.scale,i.min,i.max,c,u)):(l=Oi(r,o.scale,o.min,o.max,i.scale,i.min,i.max,c,u),t.push(l),e.append(l));for(--u;l=t[++u];)l.remove()}function mr(t,e,r,o,i,s,u,c,l){e.setProperty("--"+t+"-normal-zero",r.normalise(o,i,0)),c.forEach(f=>f.remove()),c.length=0,c=s.reduce((f,h)=>Li(f,h,t),c),l.after.apply(l,c)}var yr={construct:function(t,e){let r=B("style",":host {} :host > * { visibility: hidden; }"),o=B("label",{for:"input",html:"<slot></slot>",part:"label"}),i=B("canvas"),s=B("svg"),u=B("text",""),c=B("text",""),l=[],f=[],h=[],d=[],y=[];t.append(r,o,i,s,u,c);let a=M(this),m={value:[]},w=getComputedStyle(this),F=r.sheet.cssRules[0].style,D=r.sheet.cssRules[1].style,st=i.getContext("2d"),qt=new FormData;a.host=this,a.hostStyle=F,a.childStyle=D,a.internals=e,a.data=m,a.ctx=st,a.formdata=qt,a.shadow=new Promise(g=>a.load=g),a.pxbox={},a.paddingbox={},a.contentbox={},a.rangebox={x:0,y:6.75,width:6.75,height:-6.75},a.valuebox={x:0,y:0,width:1,height:1},a.xscale=p.of(Pe),a.xmin=p.of(0),a.xmax=p.of(1),a.xstep=p.of(Me),a.xticks=p.of(null),a.xdisplay=p.of(ke),a.yscale=p.of(Pe),a.ymin=p.of(0),a.ymax=p.of(1),a.ystep=p.of(Me),a.yticks=p.of(null),a.ydisplay=p.of(ke),a.value=p.of([{x:0,y:0,type:"step"}]);let Xt=p.merge(a.shadow,fe("resize",window)).broadcast();Xt.each(()=>Pi(this,F,w,i,s,a));let $t=p.combine({shadow:a.shadow,scale:a.xscale,min:a.xmin,max:a.xmax,ticks:a.xticks,step:a.xstep,display:a.xdisplay}).scan(ve,{}).broadcast(),Kt=p.combine({shadow:a.shadow,scale:a.yscale,min:a.ymin,max:a.ymax,ticks:a.yticks,step:a.ystep,display:a.ydisplay}).scan(ve,{}).broadcast();$t.each(g=>{a.valuebox.x=g.min,a.valuebox.width=g.max-g.min}),Kt.each(g=>{a.valuebox.y=g.min,a.valuebox.height=g.max-g.min}),$t.each(g=>mr("x",F,g.scale,g.min,g.max,g.ticks,l,h,u)),Kt.each(g=>mr("y",F,g.scale,g.min,g.max,g.ticks,f,d,c));let Re=a.value.scan(Si,null).flatMap(b).broadcast();p.combine({xaxis:$t,yaxis:Kt,resizes:Xt,value:Re}).each(g=>{a.state=g,He(i,st,w,a.contentbox,a.valuebox,g.xaxis,g.yaxis,g.value),Bi(y,s,a.rangebox,g.xaxis,g.yaxis,g.value)}),a.valueObservers=Re.reduce((g,br)=>(g.forEach(xi),g.push.apply(g,br.map((We,_e,Er)=>Ot(".",We,We).each(xr=>{let Sr=s.querySelectorAll("[part=handle]")[_e];He(i,st,w,a.contentbox,a.valuebox,a.state.xaxis,a.state.yaxis,Er),wr(Sr,a.rangebox,a.state.xaxis.scale,a.state.xaxis.min,a.state.xaxis.max,a.state.yaxis.scale,a.state.yaxis.min,a.state.yaxis.max,xr,_e)}))),g),[]),we({select:"[part=handle]",threshold:1},t).each(g=>{gr(this,w,a.pxbox,a.paddingbox,a.contentbox,a.rangebox),g.scan(ki,{handles:y,internals:e,host:this,pxbox:a.pxbox,valuebox:a.valuebox,formdata:a.formdata,value:a.state.value,events:[]}).filter(R("type")).each(Ai)})},load:function(t){let e=M(this);e.childStyle.visibility="",e.load(t)}};function U(t,e,r=b){return{attribute:function(o){let i=M(this),s=r(o||e);i[t].push(s)}}}function bt(t,e,r=b){return{attribute:function(o){this[t]=o},set:function(o){let i=M(this),s=r(o===void 0?e:o);i[t].push(s)},get:function(){return M(this).data[t]},enumerable:!0}}function vr(t){return{attribute:function(e){M(this)[t].push(!!e)}}}function Ci(t,e){let r=t[t.length-1];return r&&r.y===void 0?r.y=C(e):r&&r.type==="target"&&r.duration===void 0?r.duration=C(e):r&&!/^-?\d/.test(e)?r.type=e:t.push({x:C(e)}),t}function je(t){return t.split(/\s*,\s*|\s+/).reduce(Ci,[])}function Fi(t){return t.x+" "+t.y+(t.label?" "+t.label:"")}function Ge(t){return t.map(Fi).join(", ")}var Tr={xmin:bt("xmin",0,C),xmax:bt("xmax",1,C),ymin:bt("ymin",0,C),ymax:bt("ymax",1,C),xscale:U("xscale","linear",Ee),yscale:U("yscale","linear",Ee),xticks:U("xticks","",tt),yticks:U("yticks","",tt),xstep:U("xstep"),ystep:U("ystep"),xdisplay:U("xdisplay"),ydisplay:U("ydisplay"),valuebox:{attribute:function(t){}},ordered:vr("ordered"),value:{attribute:function(t){this.value=t},get:function(){let t=M(this);return Ge(t.state.value)},set:function(t){M(this).value.push(typeof t=="string"?je(t):Z(t))},enumerable:!0},data:{get:function(){let t=M(this);return rt(t.state.value)},set:function(t){M(this).value.push(Z(t))},enumerable:!0}};var Di=window.xyInputStylesheet||import.meta.url.replace(/\/[^\/]*([?#].*)?$/,"/")+"shadow.css",ll=ee("<xy-input>",yr,Tr,Di);export{ll as default};
